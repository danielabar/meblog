{"componentChunkName":"component---src-templates-post-js","path":"/blog/they-dont-all-have-to-be-activerecord-models/","result":{"data":{"markdownRemark":{"html":"<p class=\"markdown-para\">Rails makes it relatively easy to go from an idea to a working web application. If you follow along with the <a href=\"https://guides.rubyonrails.org/getting_started.html\" class=\"markdown-link\">Getting Started with Rails</a> guide, you can see how straightforward it is to go from an idea of a blog application with articles that have that have a title and body text, to creating a database table that stores articles, a model to represent the articles and validation rules, views that render HTML to display articles, and a controller to handle http request/responses, and delegate to the model to perform the <a href=\"https://en.wikipedia.org/wiki/Create,_read,_update_and_delete\" class=\"markdown-link\">CRUD</a> operations.</p>\n<p class=\"markdown-para\">There's also plenty of online tutorials and courses that cover creating a Rails application from start to finish for other domains besides a blogging application. Going through any of these will give you a sense of how Rails can be used to represent just about any domain where you want to build a web app to expose CRUD operations on a relational data model.</p>\n<p class=\"markdown-para\">However, all of the learning materials that I have seen make an assumption that there is always a one to one relationship between each form field that will be displayed in the web view, and the underlying database table that will be persisted. For example a Pluralsight course I took on <a href=\"https://www.pluralsight.com/courses/adding-user-resource-rails-application\" class=\"markdown-link\">Adding Resources to a Rails Application</a> covered building a cryptocurrency tracking application. Here's the new cryptocurrency creation form from the course, notice that the fields shown in the form map neatly to the underlying table:</p>\n<p class=\"markdown-para\"><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 25.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA30lEQVR42k1Qy4qEMBDM/3/V7E3w4GnHQdDdjCAqiCaal68aKpBlG4qEoru6usR5nrA+QOsVSi1YlgUhBBzH8QcW+9L/vu/Yp7XGPM9QSkVs2wYRvIc2Dt+vClL+YhxHGGOiKGGtRV3XWNcVzrkovO87qqpC13VomgZt20JKib7vITjk9wPPnzeKooibOUSeL11kWRYdTNOEYRjiy8XkKH5dF1IJ7z2M83g2b3w9HijLMoqRZzOHKJjnefyzyNM1QZfsZQzkBXNxPsA6H8/jWenc/2czBg6kPJM7IuVLfAAzKn5YXfL5RwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"not all ar cryptocurrency table vs form\"\n        title=\"not all ar cryptocurrency table vs form\"\n        src=\"/static/acad850593b0427e9ec84bdc6c969414/5a190/not-all-ar-cryptocurrency-table-vs-form.png\"\n        srcset=\"/static/acad850593b0427e9ec84bdc6c969414/772e8/not-all-ar-cryptocurrency-table-vs-form.png 200w,\n/static/acad850593b0427e9ec84bdc6c969414/e17e5/not-all-ar-cryptocurrency-table-vs-form.png 400w,\n/static/acad850593b0427e9ec84bdc6c969414/5a190/not-all-ar-cryptocurrency-table-vs-form.png 800w,\n/static/acad850593b0427e9ec84bdc6c969414/1843f/not-all-ar-cryptocurrency-table-vs-form.png 1186w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p class=\"markdown-para\">This symmetry between the UI form and the underlying table is very nice for learning. But what I've found in the \"real world\" is that often, the interface presented in the web view does not exactly match the database table, due to complex business requirements. Then it's not obvious how to make use of all the Rails niceties around form binding to the model, validations and saving. This post will show a technique that can be used when there's a mismatch between a form presented to a user, and what needs to be persisted in the database.</p>\n<aside class=\"markdown-aside\">\nA quick note before moving on - this post assumes you already have a basic understanding of Rails fundamentals including how to build a simple web application with models, views, and controllers. If you don't, checkout the <a class=\"markdown-link\" href=\"https://guides.rubyonrails.org/getting_started.html\">Getting Started with Rails Guides</a>.\n</aside>\n<h2 class=\"markdown-subtitle\" id=\"example\" style=\"position:relative;\"><a href=\"#example\" aria-label=\"example permalink\" class=\"markdown-header-link before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Example</h2>\n<p class=\"markdown-para\">Consider an example of a back office for some application where administrators will fill out a form to create new customers. The <code>customers</code> table will persist email, first and last names. However, the form also has a field for the customers age. It's used for validation where customer must be greater than a certain age, but it will not be persisted to table, therefore its not part of customer model. A more complex case might be that the form asks for SIN/SSN to validate against an external service, but this value is not required to be persisted.</p>\n<p class=\"markdown-para\">Here's a visual, notice that most of the fields in the new customer creation form map to the <code>customers</code> table, but the \"age\" field does not, because the requirements are that it should not be persisted in the database:</p>\n<p class=\"markdown-para\"><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 41.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABNklEQVR42pVSyU7DQAztt/MjnPgJDj1UHJAAoSi0kFWhIkoTaJbJOkvzkB1NRW/F0hvP2J7n50lWWmu0/YimaRhKKVDsr5/nmUFnstPphKIoGHmeI01T1HXNuZWSEj91i8enZyRJwpeklIxpmmCMQRAE2O/3HLOknuchjmPO7XY7ZFm2EGql0I0SjhcjCnyUZXlWRgSkxnVdvtj3PasiPwwjZlwa1TJh0w14ixK4joOvNGVVViXtoyhiNVVV4XA4QAiB47GEaDtIpaG1YRFnwnaY8Pru42GzQRiGF2NTkeM4WK/XPDa9JSkUooHRihtSjfUrWpYR9cXHoAILipFtt1tWSuesqPBdjegHyU3OhPiH2YaYDe7ufdzcvuDjs+KcVGohtL/ENbBGe9GNKJsBk1zGpmYU/wVm9meWBt66TQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"not all ar customer table vs form\"\n        title=\"not all ar customer table vs form\"\n        src=\"/static/cca5818d4489d34eb0b7b098cebce4e0/5a190/not-all-ar-customer-table-vs-form.png\"\n        srcset=\"/static/cca5818d4489d34eb0b7b098cebce4e0/772e8/not-all-ar-customer-table-vs-form.png 200w,\n/static/cca5818d4489d34eb0b7b098cebce4e0/e17e5/not-all-ar-customer-table-vs-form.png 400w,\n/static/cca5818d4489d34eb0b7b098cebce4e0/5a190/not-all-ar-customer-table-vs-form.png 800w,\n/static/cca5818d4489d34eb0b7b098cebce4e0/1843f/not-all-ar-customer-table-vs-form.png 1186w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p class=\"markdown-para\">If we ignore the complexity of the \"age\" field for the moment, the majority of this requirement could be implemented with the <a href=\"https://www.rubyguides.com/2020/03/rails-scaffolding/\" class=\"markdown-link\">scaffold</a> generator. This will create a migration, model, controller, and all the CRUD views for the Customer model, specifying the fields that should be persisted for each customer:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"\" data-index=\"0\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">bin/rails generate scaffold customer email:string first_name:string last_name:string</span></span></code></pre>\n<p class=\"markdown-para\">Here is the migration that creates the <code>customers</code> table. Notice there is no <code>:age</code> column because the requirements are that it should not be persisted. I've added not null constraints on all the fields, and a unique constraint on the <code>:email</code> field:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"ruby\" data-index=\"1\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">class</span><span class=\"mtk1\"> </span><span class=\"mtk5 mtku\">CreateCustomers</span><span class=\"mtk5 mtki mtku\"> &lt; ActiveRecord::Migration</span><span class=\"mtk1\">[</span><span class=\"mtk4\">7.0</span><span class=\"mtk1\">]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">def</span><span class=\"mtk1\"> </span><span class=\"mtk5\">change</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    create_table </span><span class=\"mtk4\">:customers</span><span class=\"mtk1\"> </span><span class=\"mtk7\">do</span><span class=\"mtk1\"> |t|</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      t.</span><span class=\"mtk5\">string</span><span class=\"mtk1\"> </span><span class=\"mtk4\">:email</span><span class=\"mtk1\">, </span><span class=\"mtk4\">null:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">false</span><span class=\"mtk1\">, </span><span class=\"mtk4\">index:</span><span class=\"mtk1\"> { </span><span class=\"mtk4\">unique:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">true</span><span class=\"mtk1\"> }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      t.</span><span class=\"mtk5\">string</span><span class=\"mtk1\"> </span><span class=\"mtk4\">:first_name</span><span class=\"mtk1\">, </span><span class=\"mtk4\">null:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">false</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      t.</span><span class=\"mtk5\">string</span><span class=\"mtk1\"> </span><span class=\"mtk4\">:last_name</span><span class=\"mtk1\">, </span><span class=\"mtk4\">null:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">false</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      t.</span><span class=\"mtk5\">timestamps</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">end</span></span></span></code></pre>\n<p class=\"markdown-para\">Here is the corresponding <code>Customer</code> model. I've added some validations for the email, first, and last name fields. I'm also using the <a href=\"https://github.com/ctran/annotate_models\" class=\"markdown-link\">annotate</a> gem to get schema information outputted as comments at the top of the model class:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"ruby\" data-index=\"2\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># == Schema Information</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">#</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># Table name: customers</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">#</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">#  id         :integer          not null, primary key</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">#  email      :string           not null</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">#  first_name :string           not null</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">#  last_name  :string           not null</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">#  created_at :datetime         not null</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">#  updated_at :datetime         not null</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">#</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># Indexes</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">#</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">#  index_customers_on_email  (email) UNIQUE</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">#</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">class</span><span class=\"mtk1\"> </span><span class=\"mtk5 mtku\">Customer</span><span class=\"mtk5 mtki mtku\"> &lt; ApplicationRecord</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  validates </span><span class=\"mtk4\">:email</span><span class=\"mtk1\">, </span><span class=\"mtk4\">presence:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">true</span><span class=\"mtk1\">, </span><span class=\"mtk4\">uniqueness:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">true</span><span class=\"mtk1\">, </span><span class=\"mtk4\">format:</span><span class=\"mtk1\"> { </span><span class=\"mtk4\">with:</span><span class=\"mtk1\"> </span><span class=\"mtk9 mtki\">URI</span><span class=\"mtk1\">::</span><span class=\"mtk9 mtki\">MailTo</span><span class=\"mtk1\">::EMAIL_REGEXP }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  validates </span><span class=\"mtk4\">:first_name</span><span class=\"mtk1\">, </span><span class=\"mtk4\">presence:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">true</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  validates </span><span class=\"mtk4\">:last_name</span><span class=\"mtk1\">, </span><span class=\"mtk4\">presence:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">true</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">end</span></span></span></code></pre>\n<h2 class=\"markdown-subtitle\" id=\"first-attempt\" style=\"position:relative;\"><a href=\"#first-attempt\" aria-label=\"first attempt permalink\" class=\"markdown-header-link before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>First Attempt</h2>\n<p class=\"markdown-para\">Suppose in this hypothetical app, that the customer's age must be greater than 18. If you were to attempt to implement the age requirement in the standard Rails way as per the getting started guide and common tutorials, you might add the validation rule to the <code>Customer</code> model such as:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"ruby\" data-index=\"3\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">class</span><span class=\"mtk1\"> </span><span class=\"mtk5 mtku\">Customer</span><span class=\"mtk5 mtki mtku\"> &lt; ApplicationRecord</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk3\"># validation rules based on fields in the `customers` table</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  validates </span><span class=\"mtk4\">:email</span><span class=\"mtk1\">, </span><span class=\"mtk4\">presence:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">true</span><span class=\"mtk1\">, </span><span class=\"mtk4\">uniqueness:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">true</span><span class=\"mtk1\">, </span><span class=\"mtk4\">format:</span><span class=\"mtk1\"> { </span><span class=\"mtk4\">with:</span><span class=\"mtk1\"> </span><span class=\"mtk9 mtki\">URI</span><span class=\"mtk1\">::</span><span class=\"mtk9 mtki\">MailTo</span><span class=\"mtk1\">::EMAIL_REGEXP }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  validates </span><span class=\"mtk4\">:first_name</span><span class=\"mtk1\">, </span><span class=\"mtk4\">presence:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">true</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  validates </span><span class=\"mtk4\">:last_name</span><span class=\"mtk1\">, </span><span class=\"mtk4\">presence:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">true</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk3\"># this won&#39;t work as we&#39;ll see because `age` is not a column on the `customers` table</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  validates </span><span class=\"mtk4\">:age</span><span class=\"mtk1\">, </span><span class=\"mtk4\">presence:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">true</span><span class=\"mtk1\">, </span><span class=\"mtk4\">numericality:</span><span class=\"mtk1\"> { </span><span class=\"mtk4\">only_integer:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">true</span><span class=\"mtk1\">, </span><span class=\"mtk4\">greater_than:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">18</span><span class=\"mtk1\"> }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">end</span></span></span></code></pre>\n<p class=\"markdown-para\">Add the <code>age</code> field to the customer creation form in the view:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"html\" data-index=\"4\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">&lt;</span><span class=\"mtk1\">%= form_with(model: customer) do |form| %&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk3\">&lt;!-- other customer fields --&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk3\">&lt;!-- try to bind the `age` field even though it does not exist on customer model --&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  &lt;</span><span class=\"mtk7\">div</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk8\">&lt;</span><span class=\"mtk1\">%= form.label :age, style: &quot;display: block&quot; %&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk8\">&lt;</span><span class=\"mtk1\">%= form.number_field :age %&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  &lt;/</span><span class=\"mtk7\">div</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  &lt;</span><span class=\"mtk7\">div</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk8\">&lt;</span><span class=\"mtk1\">%= form.submit %&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  &lt;/</span><span class=\"mtk7\">div</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">&lt;</span><span class=\"mtk1\">% end %&gt;</span></span></span></code></pre>\n<p class=\"markdown-para\">Update the <code>CustomersController</code> to permit <code>:age</code> as a parameter for creation:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"ruby\" data-index=\"5\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">class</span><span class=\"mtk1\"> </span><span class=\"mtk5 mtku\">CustomersController</span><span class=\"mtk5 mtki mtku\"> &lt; ApplicationController</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk3\"># standard CRUD methods...</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk3\"># POST /customers or /customers.json</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">def</span><span class=\"mtk1\"> </span><span class=\"mtk5\">create</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @customer </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> </span><span class=\"mtk9 mtki\">Customer</span><span class=\"mtk1\">.</span><span class=\"mtk7\">new</span><span class=\"mtk1\">(customer_params)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    respond_to </span><span class=\"mtk7\">do</span><span class=\"mtk1\"> |format|</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk7\">if</span><span class=\"mtk1\"> @customer.</span><span class=\"mtk5\">save</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk9\">format</span><span class=\"mtk1\">.</span><span class=\"mtk5\">html</span><span class=\"mtk1\"> { redirect_to </span><span class=\"mtk5\">customer_url</span><span class=\"mtk1\">(@customer), </span><span class=\"mtk4\">notice:</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;Customer was successfully created.&quot;</span><span class=\"mtk1\"> }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk9\">format</span><span class=\"mtk1\">.</span><span class=\"mtk5\">json</span><span class=\"mtk1\"> { render </span><span class=\"mtk4\">:show</span><span class=\"mtk1\">, </span><span class=\"mtk4\">status:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">:created</span><span class=\"mtk1\">, </span><span class=\"mtk4\">location:</span><span class=\"mtk1\"> @customer }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk7\">else</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk9\">format</span><span class=\"mtk1\">.</span><span class=\"mtk5\">html</span><span class=\"mtk1\"> { render </span><span class=\"mtk4\">:new</span><span class=\"mtk1\">, </span><span class=\"mtk4\">status:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">:unprocessable_entity</span><span class=\"mtk1\"> }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk9\">format</span><span class=\"mtk1\">.</span><span class=\"mtk5\">json</span><span class=\"mtk1\"> { render </span><span class=\"mtk4\">json:</span><span class=\"mtk1\"> @customer, </span><span class=\"mtk4\">status:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">:unprocessable_entity</span><span class=\"mtk1\"> }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">private</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">def</span><span class=\"mtk1\"> </span><span class=\"mtk5\">customer_params</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3\"># try to let `age` field through from the UI form</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    params.</span><span class=\"mtk5\">require</span><span class=\"mtk1\">(</span><span class=\"mtk4\">:customer</span><span class=\"mtk1\">).</span><span class=\"mtk5\">permit</span><span class=\"mtk1\">(</span><span class=\"mtk4\">:email</span><span class=\"mtk1\">, </span><span class=\"mtk4\">:first_name</span><span class=\"mtk1\">, </span><span class=\"mtk4\">:last_name</span><span class=\"mtk1\">, </span><span class=\"mtk4\">:age</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">end</span></span></span></code></pre>\n<p class=\"markdown-para\">When attempting to save a new customer, the following error will result, indicating that the record could not be saved due to unknown attribute <code>age</code>:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"\" data-index=\"6\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">ActiveModel::UnknownAttributeError (unknown attribute &#39;age&#39; for Customer.</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  raise UnknownAttributeError.new(self, k.to_s)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">^^^^^):</span></span></code></pre>\n<h2 class=\"markdown-subtitle\" id=\"solution\" style=\"position:relative;\"><a href=\"#solution\" aria-label=\"solution permalink\" class=\"markdown-header-link before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Solution</h2>\n<p class=\"markdown-para\">This type of problem can be solved with <a href=\"https://guides.rubyonrails.org/active_model_basics.html\" class=\"markdown-link\">ActiveModel</a>. This is a module in Rails that provides a way to create model-like objects that have many of the same features as traditional Rails models, but are not necessarily backed by a database table. This is useful when modeling data that is not directly related to the application's database, which is exactly what we need to solve this example.</p>\n<p class=\"markdown-para\">The steps in this section will explain what needs to be changed from the scaffolded code to implement the requirement of having a field in the create form that is used for validation, but not persisted. You can also check out this <a href=\"https://github.com/danielabar/not_all_activerecord\" class=\"markdown-link\">project</a> that demonstrates the complete solution.</p>\n<h3 class=\"markdown-sub-subtitle\" id=\"customerform\" style=\"position:relative;\"><a href=\"#customerform\" aria-label=\"customerform permalink\" class=\"markdown-header-link before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CustomerForm</h3>\n<p class=\"markdown-para\">Start by introducing a <code>CustomerForm</code> model. This will be used instead of the <code>Customer</code> model to bind to the form that admin users fill out to create a customer. This class lives in the same <code>models</code> directory as all the other Rails models, but rather than inheriting from <code>ApplicationRecord</code> as the other models that are backed by a database table, it includes the <code>ActiveModel::Model</code> module:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"ruby\" data-index=\"7\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># app/models/customer_form.rb</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">class</span><span class=\"mtk1\"> </span><span class=\"mtk5 mtku\">CustomerForm</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">include</span><span class=\"mtk1\"> </span><span class=\"mtk9 mtki\">ActiveModel</span><span class=\"mtk1\">::Model</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">end</span></span></span></code></pre>\n<p class=\"markdown-para\">Next, define attributes for all the fields that are needed for the customer form. Unlike with an ActiveRecord model, Rails doesn't create these automatically because there is no backing database table. Notice the attributes don't necessarily have to match columns in the <code>customers</code> table because this model is not attached to any table:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"ruby\" data-index=\"8\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># app/models/customer_form.rb</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">class</span><span class=\"mtk1\"> </span><span class=\"mtk5 mtku\">CustomerForm</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">include</span><span class=\"mtk1\"> </span><span class=\"mtk9 mtki\">ActiveModel</span><span class=\"mtk1\">::Model</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">attr_accessor</span><span class=\"mtk1\"> </span><span class=\"mtk4\">:email</span><span class=\"mtk1\">, </span><span class=\"mtk4\">:first_name</span><span class=\"mtk1\">, </span><span class=\"mtk4\">:last_name</span><span class=\"mtk1\">, </span><span class=\"mtk4\">:age</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">end</span></span></span></code></pre>\n<p class=\"markdown-para\">Including <code>ActiveModel::Model</code>, provides access to the validation methods that are available with ActiveRecord. Let's specify that all the fields are required, email must be a valid (according to the format defined in the RFC 6068 standard for the \"mailto\" URI scheme), and that age must be numeric and greater than 18:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"ruby\" data-index=\"9\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># app/models/customer_form.rb</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">class</span><span class=\"mtk1\"> </span><span class=\"mtk5 mtku\">CustomerForm</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">include</span><span class=\"mtk1\"> </span><span class=\"mtk9 mtki\">ActiveModel</span><span class=\"mtk1\">::Model</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">attr_accessor</span><span class=\"mtk1\"> </span><span class=\"mtk4\">:email</span><span class=\"mtk1\">, </span><span class=\"mtk4\">:first_name</span><span class=\"mtk1\">, </span><span class=\"mtk4\">:last_name</span><span class=\"mtk1\">, </span><span class=\"mtk4\">:age</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  validates </span><span class=\"mtk4\">:email</span><span class=\"mtk1\">, </span><span class=\"mtk4\">presence:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">true</span><span class=\"mtk1\">, </span><span class=\"mtk4\">format:</span><span class=\"mtk1\"> { </span><span class=\"mtk4\">with:</span><span class=\"mtk1\"> </span><span class=\"mtk9 mtki\">URI</span><span class=\"mtk1\">::</span><span class=\"mtk9 mtki\">MailTo</span><span class=\"mtk1\">::EMAIL_REGEXP }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  validates </span><span class=\"mtk4\">:first_name</span><span class=\"mtk1\">, </span><span class=\"mtk4\">presence:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">true</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  validates </span><span class=\"mtk4\">:last_name</span><span class=\"mtk1\">, </span><span class=\"mtk4\">presence:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">true</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  validates </span><span class=\"mtk4\">:age</span><span class=\"mtk1\">, </span><span class=\"mtk4\">presence:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">true</span><span class=\"mtk1\">, </span><span class=\"mtk4\">numericality:</span><span class=\"mtk1\"> { </span><span class=\"mtk4\">only_integer:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">true</span><span class=\"mtk1\">, </span><span class=\"mtk4\">greater_than:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">18</span><span class=\"mtk1\"> }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">end</span></span></span></code></pre>\n<p class=\"markdown-para\">This is a good place to pause, launch a Rails console (<code>bin/rails c</code>), and play around with this model to see some of the behaviour that's now available to the <code>CustomerForm</code> model, as a result of including <code>ActiveModel::Model</code>. Note that <code>CustomerForm</code> can be initialized with a hash of attributes, just like an Active Record object, and the same validation methods are available as with Active Record:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"ruby\" data-index=\"10\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">customer_form </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> </span><span class=\"mtk9 mtki\">CustomerForm</span><span class=\"mtk1\">.</span><span class=\"mtk7\">new</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># =&gt; #&lt;CustomerForm:0x0000000112e41408&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">customer_form.</span><span class=\"mtk5\">valid?</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># =&gt; false</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">customer_form.</span><span class=\"mtk5\">errors</span><span class=\"mtk1\">.</span><span class=\"mtk5\">full_messages</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># =&gt; [</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">#       &quot;Email can&#39;t be blank&quot;,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">#       &quot;Email is invalid&quot;,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">#       &quot;First name can&#39;t be blank&quot;,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">#       &quot;Last name can&#39;t be blank&quot;,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">#       &quot;Age can&#39;t be blank&quot;,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">#       &quot;Age is not a number&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">#     ]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">customer_form </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> </span><span class=\"mtk9 mtki\">CustomerForm</span><span class=\"mtk1\">.</span><span class=\"mtk7\">new</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">email:</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;sarah@example.com&quot;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">first_name:</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;Sarah&quot;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">last_name:</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;Smith&quot;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">age:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">46</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># =&gt; #&lt;CustomerForm:0x000000011496b878 @age=46, @email=&quot;sarah@example.com&quot;, @first_name=&quot;Sarah&quot;, @last_name=&quot;Smith&quot;&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">customer_form.</span><span class=\"mtk5\">valid?</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># =&gt; true</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">customer_form.</span><span class=\"mtk5\">age</span><span class=\"mtk1\"> </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> </span><span class=\"mtk4\">6</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">customer_form.</span><span class=\"mtk5\">valid?</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># =&gt; false</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">customer_form.</span><span class=\"mtk5\">errors</span><span class=\"mtk1\">.</span><span class=\"mtk5\">full_messages</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># =&gt; [&quot;Age must be greater than 18&quot;]</span></span></span></code></pre>\n<p class=\"markdown-para\">Nice, so we can have (nearly) all the validations that are on the <code>Customer</code> model, plus some additional ones that aren't backed by a table column. The <code>uniqueness: true</code> validation isn't available on ActiveModel because that requires access to a database table to verify a unique value among all the existing records. Since email should be unique across all customers, this can be implemented  with a custom <code>validate</code> method. The API is the same as adding custom validation methods to an ActiveRecord object:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"ruby\" data-index=\"11\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">class</span><span class=\"mtk1\"> </span><span class=\"mtk5 mtku\">CustomerForm</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">include</span><span class=\"mtk1\"> </span><span class=\"mtk9 mtki\">ActiveModel</span><span class=\"mtk1\">::Model</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">attr_accessor</span><span class=\"mtk1\"> </span><span class=\"mtk4\">:email</span><span class=\"mtk1\">, </span><span class=\"mtk4\">:first_name</span><span class=\"mtk1\">, </span><span class=\"mtk4\">:last_name</span><span class=\"mtk1\">, </span><span class=\"mtk4\">:age</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  validates </span><span class=\"mtk4\">:email</span><span class=\"mtk1\">, </span><span class=\"mtk4\">presence:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">true</span><span class=\"mtk1\">, </span><span class=\"mtk4\">format:</span><span class=\"mtk1\"> { </span><span class=\"mtk4\">with:</span><span class=\"mtk1\"> </span><span class=\"mtk9 mtki\">URI</span><span class=\"mtk1\">::</span><span class=\"mtk9 mtki\">MailTo</span><span class=\"mtk1\">::EMAIL_REGEXP }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  validates </span><span class=\"mtk4\">:first_name</span><span class=\"mtk1\">, </span><span class=\"mtk4\">presence:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">true</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  validates </span><span class=\"mtk4\">:last_name</span><span class=\"mtk1\">, </span><span class=\"mtk4\">presence:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">true</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  validates </span><span class=\"mtk4\">:age</span><span class=\"mtk1\">, </span><span class=\"mtk4\">presence:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">true</span><span class=\"mtk1\">, </span><span class=\"mtk4\">numericality:</span><span class=\"mtk1\"> { </span><span class=\"mtk4\">only_integer:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">true</span><span class=\"mtk1\">, </span><span class=\"mtk4\">greater_than:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">18</span><span class=\"mtk1\"> }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  validate </span><span class=\"mtk4\">:email_available?</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">def</span><span class=\"mtk1\"> </span><span class=\"mtk5\">email_available?</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    errors.</span><span class=\"mtk5\">add</span><span class=\"mtk1\">(</span><span class=\"mtk4\">:email</span><span class=\"mtk1\">, </span><span class=\"mtk6\">&quot;already taken&quot;</span><span class=\"mtk1\">) </span><span class=\"mtk7\">if</span><span class=\"mtk1\"> </span><span class=\"mtk9 mtki\">Customer</span><span class=\"mtk1\">.</span><span class=\"mtk5\">find_by</span><span class=\"mtk1\">(</span><span class=\"mtk4\">email:</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">end</span></span></span></code></pre>\n<p class=\"markdown-para\">Let's try this version of <code>CustomerForm</code> in a Rails console to see how the custom uniqueness validation works:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"ruby\" data-index=\"12\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># First save a customer to the database</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">customer </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> </span><span class=\"mtk9 mtki\">Customer</span><span class=\"mtk1\">.</span><span class=\"mtk5\">create</span><span class=\"mtk1\">(</span><span class=\"mtk4\">email:</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;alice@example.com&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk4\">first_name:</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;Alice&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk4\">last_name:</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;Jones&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># ... TRANSACTION (1.7ms)  commit transaction</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># Create a CustomerForm object with an email that has already been taken</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">customer_form </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> </span><span class=\"mtk9 mtki\">CustomerForm</span><span class=\"mtk1\">.</span><span class=\"mtk7\">new</span><span class=\"mtk1\">(</span><span class=\"mtk4\">email:</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;alice@example.com&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk4\">first_name:</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;Alice&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk4\">last_name:</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;Parker&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk4\">age:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">41</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># Checking if its valid queries the customer table by email</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">customer_form.</span><span class=\"mtk5\">valid?</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># Customer Load (0.2ms)  SELECT &quot;customers&quot;.* FROM &quot;customers&quot; WHERE &quot;customers&quot;.&quot;email&quot; = ? LIMIT ?  [[&quot;email&quot;, &quot;alice@example.com&quot;], [&quot;LIMIT&quot;, 1]]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># =&gt; false</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># Error message indicates email is already taken</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">customer_form.</span><span class=\"mtk5\">errors</span><span class=\"mtk1\">.</span><span class=\"mtk5\">full_messages</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># =&gt; [&quot;Email already taken&quot;]</span></span></span></code></pre>\n<p class=\"markdown-para\">The last thing we'll need on the <code>CustomerForm</code> model is the ability to save a customer to the database. The <code>save</code> method should return false if the model is invalid, otherwise create and save an instance of the <code>Customer</code> model. Let's also make the saved <code>Customer</code> model an instance variable so that it can be accessed by the controller to populate the <code>show</code> view.</p>\n<p class=\"markdown-para\">The final <code>CustomerForm</code> class:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"ruby\" data-index=\"13\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># app/models/customer_form.rb</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">class</span><span class=\"mtk1\"> </span><span class=\"mtk5 mtku\">CustomerForm</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">include</span><span class=\"mtk1\"> </span><span class=\"mtk9 mtki\">ActiveModel</span><span class=\"mtk1\">::Model</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">attr_accessor</span><span class=\"mtk1\"> </span><span class=\"mtk4\">:email</span><span class=\"mtk1\">, </span><span class=\"mtk4\">:first_name</span><span class=\"mtk1\">, </span><span class=\"mtk4\">:last_name</span><span class=\"mtk1\">, </span><span class=\"mtk4\">:age</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">attr_reader</span><span class=\"mtk1\"> </span><span class=\"mtk4\">:customer</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  validates </span><span class=\"mtk4\">:email</span><span class=\"mtk1\">, </span><span class=\"mtk4\">presence:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">true</span><span class=\"mtk1\">, </span><span class=\"mtk4\">format:</span><span class=\"mtk1\"> { </span><span class=\"mtk4\">with:</span><span class=\"mtk1\"> </span><span class=\"mtk9 mtki\">URI</span><span class=\"mtk1\">::</span><span class=\"mtk9 mtki\">MailTo</span><span class=\"mtk1\">::EMAIL_REGEXP }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  validates </span><span class=\"mtk4\">:first_name</span><span class=\"mtk1\">, </span><span class=\"mtk4\">presence:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">true</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  validates </span><span class=\"mtk4\">:last_name</span><span class=\"mtk1\">, </span><span class=\"mtk4\">presence:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">true</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  validates </span><span class=\"mtk4\">:age</span><span class=\"mtk1\">, </span><span class=\"mtk4\">presence:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">true</span><span class=\"mtk1\">, </span><span class=\"mtk4\">numericality:</span><span class=\"mtk1\"> { </span><span class=\"mtk4\">only_integer:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">true</span><span class=\"mtk1\">, </span><span class=\"mtk4\">greater_than:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">18</span><span class=\"mtk1\"> }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  validate </span><span class=\"mtk4\">:email_available?</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">def</span><span class=\"mtk1\"> </span><span class=\"mtk5\">email_available?</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    errors.</span><span class=\"mtk5\">add</span><span class=\"mtk1\">(</span><span class=\"mtk4\">:email</span><span class=\"mtk1\">, </span><span class=\"mtk6\">&quot;already taken&quot;</span><span class=\"mtk1\">) </span><span class=\"mtk7\">if</span><span class=\"mtk1\"> </span><span class=\"mtk9 mtki\">Customer</span><span class=\"mtk1\">.</span><span class=\"mtk5\">find_by</span><span class=\"mtk1\">(</span><span class=\"mtk4\">email:</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">def</span><span class=\"mtk1\"> </span><span class=\"mtk5\">save</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">return</span><span class=\"mtk1\"> </span><span class=\"mtk4\">false</span><span class=\"mtk1\"> </span><span class=\"mtk7\">unless</span><span class=\"mtk1\"> valid?</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @customer </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> </span><span class=\"mtk9 mtki\">Customer</span><span class=\"mtk1\">.</span><span class=\"mtk7\">new</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @customer.</span><span class=\"mtk5\">email</span><span class=\"mtk1\"> </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> email</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @customer.</span><span class=\"mtk5\">first_name</span><span class=\"mtk1\"> </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> first_name</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @customer.</span><span class=\"mtk5\">last_name</span><span class=\"mtk1\"> </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> last_name</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @customer.</span><span class=\"mtk5\">save</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">end</span></span></span></code></pre>\n<h3 class=\"markdown-sub-subtitle\" id=\"customerscontroller-new\" style=\"position:relative;\"><a href=\"#customerscontroller-new\" aria-label=\"customerscontroller new permalink\" class=\"markdown-header-link before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CustomersController New</h3>\n<p class=\"markdown-para\">Now that we have the <code>CustomerForm</code> class that implements all the required validations and the ability to save a <code>Customer</code> record, it needs to be integrated into the customer creation workflow. The first step is to modify the <code>CustomersController#new</code> method to make a <code>CustomerForm</code> instance variable available to the new view instead of a <code>Customer</code> instance variable:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"ruby\" data-index=\"14\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">class</span><span class=\"mtk1\"> </span><span class=\"mtk5 mtku\">CustomersController</span><span class=\"mtk5 mtki mtku\"> &lt; ApplicationController</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk3\"># GET /customers/new</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">def</span><span class=\"mtk1\"> </span><span class=\"mtk5\">new</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3\"># This line is the standard Rails way to make the Active Record model instance available to the view:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3\"># @customer = Customer.new</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3\"># Instead, let&#39;s make our ActiveModel model available:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @customer_form </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> </span><span class=\"mtk9 mtki\">CustomerForm</span><span class=\"mtk1\">.</span><span class=\"mtk7\">new</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">end</span></span></span></code></pre>\n<h3 class=\"markdown-sub-subtitle\" id=\"new-view-and-form\" style=\"position:relative;\"><a href=\"#new-view-and-form\" aria-label=\"new view and form permalink\" class=\"markdown-header-link before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>New View and Form</h3>\n<p class=\"markdown-para\">The next step is to modify the <code>new</code> view to use the <code>CustomerForm</code> object instead of a <code>Customer</code> object, and pass it to a new form partial that will render the customer creation form. Note that the scaffold command used earlier generated a <code>_form.html.erb</code> partial to be used for both creating and editing customer instances. We're changing this to introduce a <code>_form_new.html.erb</code> partial since the customer creation requirements are different from editing:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"html\" data-index=\"15\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">&lt;!-- app/views/customers/new.html.erb --&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">&lt;</span><span class=\"mtk7\">h1</span><span class=\"mtk1\">&gt;New customer&lt;/</span><span class=\"mtk7\">h1</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">&lt;</span><span class=\"mtk1\">%= render &quot;form_new&quot;, customer_form: @customer_form %&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">&lt;</span><span class=\"mtk7\">br</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">&lt;</span><span class=\"mtk7\">div</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk8\">&lt;</span><span class=\"mtk1\">%= link_to &quot;Back to customers&quot;, customers_path %&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">&lt;/</span><span class=\"mtk7\">div</span><span class=\"mtk1\">&gt;</span></span></span></code></pre>\n<p class=\"markdown-para\">Here is the form that binds the form fields to the <code>@customer_form</code> instance variable passed to it by the <code>new</code> view. Notice the <code>url: customers_path</code> is specified for the <code>form_with</code> helper, otherwise the view will attempt to render a url <code>customer_forms_path</code> by convention of the model name, but this does not exist. Note also we pass the label \"Create Customer\" to the <code>form.submit</code> helper, otherwise by convention of the model name, it would render a label \"Create Customer form\".</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"html\" data-index=\"16\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">&lt;!-- app/views/customers/_form_new.html.erb --&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">&lt;</span><span class=\"mtk1\">%= form_with(model: customer_form, url: customers_path) do |form| %&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk8\">&lt;</span><span class=\"mtk1\">% if customer_form.errors.any? %&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    &lt;</span><span class=\"mtk7\">div</span><span class=\"mtk1\"> </span><span class=\"mtk5\">style</span><span class=\"mtk1\">=</span><span class=\"mtk6\">&quot;color: red&quot;</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      &lt;</span><span class=\"mtk7\">h2</span><span class=\"mtk1\">&gt;</span><span class=\"mtk8\">&lt;</span><span class=\"mtk1\">%= pluralize(customer_form.errors.count, &quot;error&quot;) %&gt; prohibited this customer from being saved:&lt;/</span><span class=\"mtk7\">h2</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      &lt;</span><span class=\"mtk7\">ul</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk8\">&lt;</span><span class=\"mtk1\">% customer_form.errors.each do |error| %&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">          &lt;</span><span class=\"mtk7\">li</span><span class=\"mtk1\">&gt;</span><span class=\"mtk8\">&lt;</span><span class=\"mtk1\">%= error.full_message %&gt;&lt;/</span><span class=\"mtk7\">li</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk8\">&lt;</span><span class=\"mtk1\">% end %&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      &lt;/</span><span class=\"mtk7\">ul</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    &lt;/</span><span class=\"mtk7\">div</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk8\">&lt;</span><span class=\"mtk1\">% end %&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  &lt;</span><span class=\"mtk7\">div</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk8\">&lt;</span><span class=\"mtk1\">%= form.label :email, style: &quot;display: block&quot; %&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk8\">&lt;</span><span class=\"mtk1\">%= form.text_field :email %&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  &lt;/</span><span class=\"mtk7\">div</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  &lt;</span><span class=\"mtk7\">div</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk8\">&lt;</span><span class=\"mtk1\">%= form.label :first_name, style: &quot;display: block&quot; %&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk8\">&lt;</span><span class=\"mtk1\">%= form.text_field :first_name %&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  &lt;/</span><span class=\"mtk7\">div</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  &lt;</span><span class=\"mtk7\">div</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk8\">&lt;</span><span class=\"mtk1\">%= form.label :last_name, style: &quot;display: block&quot; %&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk8\">&lt;</span><span class=\"mtk1\">%= form.text_field :last_name %&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  &lt;/</span><span class=\"mtk7\">div</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  &lt;</span><span class=\"mtk7\">div</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk8\">&lt;</span><span class=\"mtk1\">%= form.label :age, style: &quot;display: block&quot; %&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk8\">&lt;</span><span class=\"mtk1\">%= form.number_field :age %&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  &lt;/</span><span class=\"mtk7\">div</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  &lt;</span><span class=\"mtk7\">div</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk8\">&lt;</span><span class=\"mtk1\">%= form.submit &quot;Create Customer&quot; %&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  &lt;/</span><span class=\"mtk7\">div</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">&lt;</span><span class=\"mtk1\">% end %&gt;</span></span></span></code></pre>\n<h3 class=\"markdown-sub-subtitle\" id=\"customerscontroller-create\" style=\"position:relative;\"><a href=\"#customerscontroller-create\" aria-label=\"customerscontroller create permalink\" class=\"markdown-header-link before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CustomersController Create</h3>\n<p class=\"markdown-para\">When the \"Create Customer\" button is clicked from the new form, it will submit a POST request to the <code>CustomersController#create</code> method. This method must be modified to use the <code>CustomerForm</code> model instead of <code>Customer</code>. We also need to define a <code>customer_form_params</code> method to specify the allowed fields for customer creation.</p>\n<p class=\"markdown-para\">If the customer is saved successfully, the <code>create</code> method should redirect to the show view, providing the <code>customer</code> instance variable of the <code>customer_form</code> object. Otherwise, render the <code>new</code> view with a 422 Unprocessable Entity HTTP response code. Since the <code>@customer_form</code> instance variable has been set, the <code>new</code> view will be able to iterate over its <code>errors</code> property and display them:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"ruby\" data-index=\"17\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># app/controllers/customers_controller.rb</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">class</span><span class=\"mtk1\"> </span><span class=\"mtk5 mtku\">CustomersController</span><span class=\"mtk5 mtki mtku\"> &lt; ApplicationController</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk3\"># POST /customers or /customers.json</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">def</span><span class=\"mtk1\"> </span><span class=\"mtk5\">create</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3\"># Initialize the ActiveModel with form parameters from the view</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @customer_form </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> </span><span class=\"mtk9 mtki\">CustomerForm</span><span class=\"mtk1\">.</span><span class=\"mtk7\">new</span><span class=\"mtk1\">(customer_form_params)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    respond_to </span><span class=\"mtk7\">do</span><span class=\"mtk1\"> |format|</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk3\"># `save` is a custom method defined in `CustomerForm` that first calls `valid?`</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk7\">if</span><span class=\"mtk1\"> @customer_form.</span><span class=\"mtk5\">save</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk3\"># If `save` returns true, redirect to `show` view passing in the saved customer</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk9\">format</span><span class=\"mtk1\">.</span><span class=\"mtk5\">html</span><span class=\"mtk1\"> { redirect_to </span><span class=\"mtk5\">customer_url</span><span class=\"mtk1\">(@customer_form.</span><span class=\"mtk5\">customer</span><span class=\"mtk1\">), </span><span class=\"mtk4\">notice:</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;Customer successfully created.&quot;</span><span class=\"mtk1\"> }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk9\">format</span><span class=\"mtk1\">.</span><span class=\"mtk5\">json</span><span class=\"mtk1\"> { render </span><span class=\"mtk4\">:show</span><span class=\"mtk1\">, </span><span class=\"mtk4\">status:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">:created</span><span class=\"mtk1\">, </span><span class=\"mtk4\">location:</span><span class=\"mtk1\"> @customer }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk7\">else</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk3\"># If `save` returns false, render the `new` view to display the errors in `customer_form`:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk9\">format</span><span class=\"mtk1\">.</span><span class=\"mtk5\">html</span><span class=\"mtk1\"> { render </span><span class=\"mtk4\">:new</span><span class=\"mtk1\">, </span><span class=\"mtk4\">status:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">:unprocessable_entity</span><span class=\"mtk1\"> }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk9\">format</span><span class=\"mtk1\">.</span><span class=\"mtk5\">json</span><span class=\"mtk1\"> { render </span><span class=\"mtk4\">json:</span><span class=\"mtk1\"> @customer_form.</span><span class=\"mtk5\">errors</span><span class=\"mtk1\">, </span><span class=\"mtk4\">status:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">:unprocessable_entity</span><span class=\"mtk1\"> }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">private</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk3\"># Specify allowed fields for the CustomerForm model</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">def</span><span class=\"mtk1\"> </span><span class=\"mtk5\">customer_form_params</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    params.</span><span class=\"mtk5\">require</span><span class=\"mtk1\">(</span><span class=\"mtk4\">:customer_form</span><span class=\"mtk1\">).</span><span class=\"mtk5\">permit</span><span class=\"mtk1\">(</span><span class=\"mtk4\">:email</span><span class=\"mtk1\">, </span><span class=\"mtk4\">:first_name</span><span class=\"mtk1\">, </span><span class=\"mtk4\">:last_name</span><span class=\"mtk1\">, </span><span class=\"mtk4\">:age</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">end</span></span></span></code></pre>\n<h3 class=\"markdown-sub-subtitle\" id=\"try-it\" style=\"position:relative;\"><a href=\"#try-it\" aria-label=\"try it permalink\" class=\"markdown-header-link before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Try It</h3>\n<p class=\"markdown-para\">Putting all of these code changes together, we can now navigate to the new customer create form at <code>http://localhost:3000/customers/new</code>, and fill it in with an age that is invalid:</p>\n<p class=\"markdown-para\"><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 300px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 136.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAbCAYAAAB836/YAAAACXBIWXMAAAsTAAALEwEAmpwYAAADjElEQVR42p1VXW8TRxTNMw995YmXqgIJtUKtiiqh9g2pb61Eq1IqQRGiVQtCfUagwkt/QH9BValVwUogfKhSXGfjRAnBiaFKUBLbJCaOs/5Y7653s+udnd1ZH3QnJPZCbAxXOpqPnb1zz5x7Z4bwkrXb7bfCzr9DW1tbSCbHkM1mkUwm4bru7seubXr044GQDXHOUa3WoRsmypsqoog+AiJqI2oDUdSW4zAUECKSczwI4fsBOA/g+xxBEHYipI+2vYVKpQrDMJHPF7CxUUatVpetqlZQKm3ANE3U65rse4xJ57QJoeWxjsNQRMjl8lAUBfPz8xgbG8PMzDSmp6cxOzuLubk5TE6msbKygoWFBTx6lIXjODG6jPkdyts7RZKWpPtiEfVpM6JEUTDG4fNArqU5ckJzHvPluEOZcxSLRei6Adu20Ww2oRsGDMNAGIYvnL9e4V2HjDFkMnOYmEhjcfEJFGUC4+OKbA3TlM54EMiD74VY2siJl1KAlKQ1QRj2dUSgzYh+TGVSkEQhESoVdY887G8xUSiXLMtGqVSSKdK0LERRJKMjwQaB53VFKA/2lazfbil5SUnm9wHjEELEVV5eXsLU1BTW19dlLlKuZTIZBEEwMO1Y6RWeriKXL0DTdCwv51AorCKffwrXbckoPJlze4PoxkovCATogrAs65UKGPT2iZ0hVQOVVTqdxszMA/j+tmIkzKBXV9xhKGTekZHznXIaBDuUWXfp0cHregMt10EUCbytxUQZvXsff99IoKbpYFzA9Xy4jPdEi1qPy7VctBF2p41hOVjb1FGumVAbNlTNgqrZfbGpWajqDvJFFQ8fL6FUMToOtaaLZ6UyLLPxxjSVVBKXLv6MusWkiJJyTbewtLqJclVHw2qhbjrQTLcnGk2CA8vl+P9JDiN3/kVR7YpQiBCMc/j0TlDLt0vK8/nueAekrGm3oFsEF7bL4TABp9X1BNRND9//Nolvryk4cSUlcfJXBaeuT8j+11dT+OpqCl9e/g+//D4rheir8uKagX3H/8CRsyP49MI9fHbxHt4/M4zDp4dx9IdRfPLjHRz76S4+ODOC/V/8harekj+KqMe7vLLexDuf/4l3v7khHXx8fhTvnbyJQ98l8NG52zhy9hY+PHcLB08lcODEP9CabPdZ2MuGPD/E/QclDKeLuDm+JkH9kfQzJJQ1JJSiBM2nsiqCMOp7AT8HPLrtF6W+gJ4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"not all ar invalid form\"\n        title=\"not all ar invalid form\"\n        src=\"/static/321c7f2c05c8c5bcc44f7495aa83307a/5a46d/not-all-ar-invalid-form.png\"\n        srcset=\"/static/321c7f2c05c8c5bcc44f7495aa83307a/772e8/not-all-ar-invalid-form.png 200w,\n/static/321c7f2c05c8c5bcc44f7495aa83307a/5a46d/not-all-ar-invalid-form.png 300w\"\n        sizes=\"(max-width: 300px) 100vw, 300px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p class=\"markdown-para\">Here is the rendered HTML form, notice the <code>name</code> attributes of the input fields are like <code>customer_form[field]</code> rather than <code>customer[field]</code>. This is because we're binding to the <code>CustomerForm</code> ActiveModel rather than the  <code>Customer</code> Active Record model:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"html\" data-index=\"18\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">&lt;</span><span class=\"mtk7\">form</span><span class=\"mtk1\"> </span><span class=\"mtk5\">action</span><span class=\"mtk1\">=</span><span class=\"mtk6\">&quot;/customers&quot;</span><span class=\"mtk1\"> </span><span class=\"mtk5\">method</span><span class=\"mtk1\">=</span><span class=\"mtk6\">&quot;post&quot;</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  &lt;</span><span class=\"mtk7\">input</span><span class=\"mtk1\"> </span><span class=\"mtk5\">type</span><span class=\"mtk1\">=</span><span class=\"mtk6\">&quot;hidden&quot;</span><span class=\"mtk1\"> </span><span class=\"mtk5\">name</span><span class=\"mtk1\">=</span><span class=\"mtk6\">&quot;authenticity_token&quot;</span><span class=\"mtk1\"> </span><span class=\"mtk5\">value</span><span class=\"mtk1\">=</span><span class=\"mtk6\">&quot;Lda1K...&quot;</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  &lt;</span><span class=\"mtk7\">div</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    &lt;</span><span class=\"mtk7\">label</span><span class=\"mtk1\"> </span><span class=\"mtk5\">for</span><span class=\"mtk1\">=</span><span class=\"mtk6\">&quot;customer_form_email&quot;</span><span class=\"mtk1\">&gt;Email&lt;/</span><span class=\"mtk7\">label</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    &lt;</span><span class=\"mtk7\">input</span><span class=\"mtk1\"> </span><span class=\"mtk5\">type</span><span class=\"mtk1\">=</span><span class=\"mtk6\">&quot;text&quot;</span><span class=\"mtk1\"> </span><span class=\"mtk5\">name</span><span class=\"mtk1\">=</span><span class=\"mtk6\">&quot;customer_form[email]&quot;</span><span class=\"mtk1\"> </span><span class=\"mtk5\">id</span><span class=\"mtk1\">=</span><span class=\"mtk6\">&quot;customer_form_email&quot;</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  &lt;/</span><span class=\"mtk7\">div</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  &lt;</span><span class=\"mtk7\">div</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    &lt;</span><span class=\"mtk7\">label</span><span class=\"mtk1\"> </span><span class=\"mtk5\">for</span><span class=\"mtk1\">=</span><span class=\"mtk6\">&quot;customer_form_first_name&quot;</span><span class=\"mtk1\">&gt;First name&lt;/</span><span class=\"mtk7\">label</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    &lt;</span><span class=\"mtk7\">input</span><span class=\"mtk1\"> </span><span class=\"mtk5\">type</span><span class=\"mtk1\">=</span><span class=\"mtk6\">&quot;text&quot;</span><span class=\"mtk1\"> </span><span class=\"mtk5\">name</span><span class=\"mtk1\">=</span><span class=\"mtk6\">&quot;customer_form[first_name]&quot;</span><span class=\"mtk1\"> </span><span class=\"mtk5\">id</span><span class=\"mtk1\">=</span><span class=\"mtk6\">&quot;customer_form_first_name&quot;</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  &lt;/</span><span class=\"mtk7\">div</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  &lt;</span><span class=\"mtk7\">div</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    &lt;</span><span class=\"mtk7\">label</span><span class=\"mtk1\"> </span><span class=\"mtk5\">for</span><span class=\"mtk1\">=</span><span class=\"mtk6\">&quot;customer_form_last_name&quot;</span><span class=\"mtk1\">&gt;Last name&lt;/</span><span class=\"mtk7\">label</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    &lt;</span><span class=\"mtk7\">input</span><span class=\"mtk1\"> </span><span class=\"mtk5\">type</span><span class=\"mtk1\">=</span><span class=\"mtk6\">&quot;text&quot;</span><span class=\"mtk1\"> </span><span class=\"mtk5\">name</span><span class=\"mtk1\">=</span><span class=\"mtk6\">&quot;customer_form[last_name]&quot;</span><span class=\"mtk1\"> </span><span class=\"mtk5\">id</span><span class=\"mtk1\">=</span><span class=\"mtk6\">&quot;customer_form_last_name&quot;</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  &lt;/</span><span class=\"mtk7\">div</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  &lt;</span><span class=\"mtk7\">div</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    &lt;</span><span class=\"mtk7\">label</span><span class=\"mtk1\"> </span><span class=\"mtk5\">for</span><span class=\"mtk1\">=</span><span class=\"mtk6\">&quot;customer_form_age&quot;</span><span class=\"mtk1\">&gt;Age&lt;/</span><span class=\"mtk7\">label</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    &lt;</span><span class=\"mtk7\">input</span><span class=\"mtk1\"> </span><span class=\"mtk5\">type</span><span class=\"mtk1\">=</span><span class=\"mtk6\">&quot;number&quot;</span><span class=\"mtk1\"> </span><span class=\"mtk5\">name</span><span class=\"mtk1\">=</span><span class=\"mtk6\">&quot;customer_form[age]&quot;</span><span class=\"mtk1\"> </span><span class=\"mtk5\">id</span><span class=\"mtk1\">=</span><span class=\"mtk6\">&quot;customer_form_age&quot;</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  &lt;/</span><span class=\"mtk7\">div</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  &lt;</span><span class=\"mtk7\">div</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    &lt;</span><span class=\"mtk7\">input</span><span class=\"mtk1\"> </span><span class=\"mtk5\">type</span><span class=\"mtk1\">=</span><span class=\"mtk6\">&quot;submit&quot;</span><span class=\"mtk1\"> </span><span class=\"mtk5\">name</span><span class=\"mtk1\">=</span><span class=\"mtk6\">&quot;commit&quot;</span><span class=\"mtk1\"> </span><span class=\"mtk5\">value</span><span class=\"mtk1\">=</span><span class=\"mtk6\">&quot;Create Customer&quot;</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  &lt;/</span><span class=\"mtk7\">div</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">&lt;/</span><span class=\"mtk7\">form</span><span class=\"mtk1\">&gt;</span></span></span></code></pre>\n<p class=\"markdown-para\">After clicking the \"Create Customer\" button, the request and response is logged to the Rails server output. Notice the <code>customer_form</code> parameter rather than <code>customer</code> due to the use of the <code>CustomerForm</code> ActiveModel.</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"\" data-index=\"19\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">Started POST &quot;/customers&quot;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Processing by CustomersController#create as TURBO_STREAM</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  Parameters: {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    &quot;authenticity_token&quot;=&gt;&quot;[FILTERED]&quot;,</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    &quot;customer_form&quot;=&gt;{</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      &quot;email&quot;=&gt;&quot;jane@example.com&quot;,</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      &quot;first_name&quot;=&gt;&quot;Jane&quot;,</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      &quot;last_name&quot;=&gt;&quot;Doe&quot;,</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      &quot;age&quot;=&gt;&quot;3&quot;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    },</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    &quot;commit&quot;=&gt;&quot;Create Customer&quot;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  }</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  Customer Load (0.5ms)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    SELECT &quot;customers&quot;.* FROM &quot;customers&quot; WHERE &quot;customers&quot;.&quot;email&quot; = ? LIMIT ?</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    [[&quot;email&quot;, &quot;jane@example.com&quot;], [&quot;LIMIT&quot;, 1]]</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  ↳ app/models/customer_form.rb:15:in `email_available?&#39;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  Rendering customers/new.html.erb within layouts/application</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  Rendered customers/_form_new.html.erb</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Completed 422 Unprocessable Entity</span></span></code></pre>\n<p class=\"markdown-para\">Since there is an error with the <code>age</code> attribute in the <code>customer_form</code> instance variable set by the <code>CustomersController</code>, it will be displayed in the new form:</p>\n<p class=\"markdown-para\"><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 677px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 77.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsTAAALEwEAmpwYAAABsElEQVR42p2Ty27TQBSG/VCs2CPxICzYoi7YsIQ3QGLRFX2CigXwCJRGcZO2cS5EvsWpgmpTmjoXz8z5qhmnFqAiJbH068yM5nzznzNjj/EYpzCEfgDdDlxcQK8HgwFMJjAa1eMoguGw3m/X7NjGOIJ+H4oCT3o9xE6CAAkC8H04O4PLy3rTjxG02+C34fy8BtsDu11oteD0FDodODmB62s8tHYuZDpFsgkymyFxjFxdIVkGeY6w/efd3dwg8zmsVrBaQllCeQfLJSwWiF03ZjuJ4AX9AfNywapSrKrKxUoblBHM5lTnUP7j8591L8syxuMxURQRhiFpmlKWJcYISqlNjjya/GjJSTohThLyvEBpzbqqqKzLSjUgke276MVxTFH8Yr1eO1fGGCettdPOwDSd8Pv2FqW0c2ijbqLZHZgkCWEUkRdF0zcHV9rN9wCmrm82yTqysiU/QHcGzmY/NzDdAB+016VM7R8i/NVDGyul9rsUoxVijJNxr70u1z6bvYBPXhzz/OALz1595unLTxy8/9ZALGcXmAO+/vCdd0c+bz/6vDlscfR1+Adw9x7eA/nY10ouK1b2AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"not all ar form error\"\n        title=\"not all ar form error\"\n        src=\"/static/afc538f24f2e194dc20f42e212cd036f/68de2/not-all-ar-form-error.png\"\n        srcset=\"/static/afc538f24f2e194dc20f42e212cd036f/772e8/not-all-ar-form-error.png 200w,\n/static/afc538f24f2e194dc20f42e212cd036f/e17e5/not-all-ar-form-error.png 400w,\n/static/afc538f24f2e194dc20f42e212cd036f/68de2/not-all-ar-form-error.png 677w\"\n        sizes=\"(max-width: 677px) 100vw, 677px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p class=\"markdown-para\">Let's correct the error by setting an age greater than 18 and submitting the form again:</p>\n<p class=\"markdown-para\"><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 292px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 137%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAbCAYAAAB836/YAAAACXBIWXMAAAsTAAALEwEAmpwYAAADA0lEQVR42p1VS08TURRm48L4M3SlwY2auDEx0f+gC4GgJi70X/ggEg1LV4YVCgaCBhZUqyl9GBIepcMjFmzLtEA7bWlDH/Oe+cw5baedWqB0ki/3ns703HO+851z+wqFAkRRRD6fRyqVgmEY6OWxbZvXvsPDQywvr8Dj+Y4f3p+oVKrQdAOqqkHTdIZah9aytsI0LcdpH/3ZfVJzb9lNm1bLsnk1DBO6bjioVpWmQ9OyIQgCfD4fgsEgFhYWEAgEEAqFsLS0hFAoyO+i0T9YD4fh9/tRLBZcQSiK1kxZ0wwkkykkk0mIYhKxWIztRCKBdDqNPVFkW5KyyGQkEEWKorIDy7IY7ghNi1Pp9FD0hmnBNO1amobJtqrqkBWVI6OVeHQcZjIZrK2tIRwOc1RbW5uc2urqKhRFPn+VS6UyRDGFiLCB/f0DrEcECMImwusRHB+XuKqNaDrhvwiJw1raFkul/dTGu5NgEodyC4eGYSEajcLr9WJ+fg5EAUvGsrpOt1EkTpkILpUqqFRlrla1KkOW1RqU00GO6LtyRW6tstlR1A2bPuoGjsNcLscVJUGTwAOBIDweDwtYlpsnn+XMcUi9m05LyB8VUK7v0xkJ2WyOaWhU8kTU6XEJm9Qfj8chSVJPk0ZuLQqpf3f3L/fr8spKrUPOkEo72mTjLkpTxGoX0Jy0HYdEvCjuIZvN9jxcXa1Hk5oqTAO2XC7zC4qa5NQtGk3AERKHJGhZVkBtyOmq54CiodI+vnZ2dnig9vq4Biydkj8qYv8gDUXVzwSNfOJab0A33BEC9rmiIWfU/60XmF6/l9ihEDvC4xE/ht8sYvCVjzFM9ogfQ68XHQy89OHF2G/kj9XTqzzpjeHC3Y+48WQW1wamcfPpLC4/mEL/0Azb/YMzvL/6aBoX741jM15wroeOw+HLr5rD60MzuP3sG+48n8OVh1OOfevpVz6EDrx0fxzbiWJ9Xnamqk/MlDE2tYH3kwJGJyJ4OxHh/bvPAkY/RRzQ7x9mt1Gq6q4U2x3+A4dl8PMyvEyAAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"not all ar valid form\"\n        title=\"not all ar valid form\"\n        src=\"/static/175984a91f40f8370b5dfd1bf8811cec/2e9f9/not-all-ar-valid-form.png\"\n        srcset=\"/static/175984a91f40f8370b5dfd1bf8811cec/772e8/not-all-ar-valid-form.png 200w,\n/static/175984a91f40f8370b5dfd1bf8811cec/2e9f9/not-all-ar-valid-form.png 292w\"\n        sizes=\"(max-width: 292px) 100vw, 292px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p class=\"markdown-para\">This time, the Rails server output shows a new <code>customers</code> record being inserted into the database, then redirecting to the customers show view at <code>http://localhost/customers/{id}</code>:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"\" data-index=\"20\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">Started POST &quot;/customers&quot;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Processing by CustomersController#create as TURBO_STREAM</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  Parameters: {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    &quot;authenticity_token&quot;=&gt;&quot;[FILTERED]&quot;,</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    &quot;customer_form&quot;=&gt;{</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      &quot;email&quot;=&gt;&quot;jane@example.com&quot;,</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      &quot;first_name&quot;=&gt;&quot;Jane&quot;,</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      &quot;last_name&quot;=&gt;&quot;Doe&quot;,</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      &quot;age&quot;=&gt;&quot;19&quot;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    },</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    &quot;commit&quot;=&gt;&quot;Create Customer&quot;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  }</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  Customer Load (9.8ms)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    SELECT &quot;customers&quot;.* FROM &quot;customers&quot; WHERE &quot;customers&quot;.&quot;email&quot; = ? LIMIT ?</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    [[&quot;email&quot;, &quot;jane@example.com&quot;], [&quot;LIMIT&quot;, 1]]</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  ↳ app/models/customer_form.rb:15:in `email_available?&#39;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  TRANSACTION (0.1ms)  begin transaction</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  Customer Create (3.3ms)  INSERT INTO &quot;customers&quot;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    (&quot;email&quot;, &quot;first_name&quot;, &quot;last_name&quot;, &quot;created_at&quot;, &quot;updated_at&quot;)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    VALUES (?, ?, ?, ?, ?)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    [[&quot;email&quot;, &quot;jane@example.com&quot;], [&quot;first_name&quot;, &quot;Jane&quot;], [&quot;last_name&quot;, &quot;Doe&quot;],</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    [&quot;created_at&quot;, &quot;2023-03-24 11:22:45&quot;], [&quot;updated_at&quot;, &quot;2023-03-24 11:22:45&quot;]]</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  ↳ app/models/customer_form.rb:25:in `save&#39;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  TRANSACTION (1.7ms)  commit transaction</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  ↳ app/models/customer_form.rb:25:in `save&#39;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Redirected to http://localhost:3000/customers/12</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Completed 302 Found</span></span></code></pre>\n<p class=\"markdown-para\">And here is the customer show view with the flash message that it was successfully created (this portion is directly from the scaffolded code):</p>\n<p class=\"markdown-para\"><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 391px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 83.50000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsTAAALEwEAmpwYAAACdElEQVR42p1UW08TURDuiw/+DN+Mxgd8UDEmavgPvqgxkihqjPH/KBLfTEQUWqCl3nB759ILuu0C3bq7Zam73aVLW9pt2X7mTAutLWhkki8z5zs73zkzc7KuWrOGYrWIndoOjD0T5p6J3fou+bJdppihVCtBr+rYLm8Tb9UtymOo2BUwa7VacLHNVXUVnBRAWAkjIAeR1tP4JnFIFpKI5qNY2lrG15+LCClh8rzGY1ldwUfxEz7nvkA0xa5gO+qg347ijjEmxsyFE5rTckjkAIc31HUdoVCIEI/HIYoieJ6nOJ1OI5PJkGdQFAWCIKBS6fZsQLBarZIIS2QJsixDkiTiWMyQy+Vor1AoIJ/Po16v/1Fmr7mOIv+nZwOCmqbB6/ViYWEBkUgEHo8HPp+PbsbWiUQCjUaDBBzHGShxQPCwyY5D2N/fJxzEzWbzrwIDgrZtwzRNaJoOwzCoT2xQlmUR39+v3kH0gwRZIscFEAwGEYvF4Pf7wXEcsqJIk1ZVtVtBT7LTQbsVXf7E7/DYkktlG4HUNhIbRawKOrJbFjLSDlYEHWtZg3jdKCGYUhHjNXwXTWzmLfKhtQKSmwbCP35hXSm1b2hVbMxFZPiX8vDFFPLzEYXgjSpwByUkhAJ8URlRXoMgl+jAVNZAfKNIwiudi5AgW1wcfY+R53O49sSNyw+ncfPZLC49+IDhRzO4/tSDq4/dOHdnkg77Z8mLcRWnboxjeGwaQ/encPb2W1y49w5nbr3B+buTGBqdwpWxaZwemcDr+XVKajTbA2LDcPqHYlh1+vDFTAYv3RlMzAnkX80KGPe0OVp7BChapfNjOP49/gYGRek/Ib60ogAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"not all ar success\"\n        title=\"not all ar success\"\n        src=\"/static/8b5758d0ba2b86acac7cbdf8a93647e0/14e0c/not-all-ar-success.png\"\n        srcset=\"/static/8b5758d0ba2b86acac7cbdf8a93647e0/772e8/not-all-ar-success.png 200w,\n/static/8b5758d0ba2b86acac7cbdf8a93647e0/14e0c/not-all-ar-success.png 391w\"\n        sizes=\"(max-width: 391px) 100vw, 391px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 class=\"markdown-sub-subtitle\" id=\"tests\" style=\"position:relative;\"><a href=\"#tests\" aria-label=\"tests permalink\" class=\"markdown-header-link before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Tests</h3>\n<p class=\"markdown-para\">Before we can conclude that we're done, the <code>CustomerForm</code> model should have automated tests. I'm using <a href=\"https://rspec.info/\" class=\"markdown-link\">RSpec</a> on this project. A really nice feature of including the ActiveModel module is the validation rules can be tested with <a href=\"http://matchers.shoulda.io/\" class=\"markdown-link\">shoulda matchers</a>, just like an Active Record model. Here are the tests for the validation rules, and the <code>save</code> method:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"ruby\" data-index=\"21\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">require</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;rails_helper&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk9 mtki\">RSpec</span><span class=\"mtk1\">.</span><span class=\"mtk5\">describe</span><span class=\"mtk1\"> CustomerForm, </span><span class=\"mtk4\">type:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">:model</span><span class=\"mtk1\"> </span><span class=\"mtk7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk5\">subject</span><span class=\"mtk1\">(</span><span class=\"mtk4\">:customer_form</span><span class=\"mtk1\">) { described_class.</span><span class=\"mtk7\">new</span><span class=\"mtk1\"> }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  describe </span><span class=\"mtk6\">&quot;validations&quot;</span><span class=\"mtk1\"> </span><span class=\"mtk7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    it { should </span><span class=\"mtk5\">validate_presence_of</span><span class=\"mtk1\">(</span><span class=\"mtk4\">:email</span><span class=\"mtk1\">) }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    it { should </span><span class=\"mtk5\">allow_value</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;email@example.com&quot;</span><span class=\"mtk1\">).</span><span class=\"mtk5\">for</span><span class=\"mtk1\">(</span><span class=\"mtk4\">:email</span><span class=\"mtk1\">) }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    it { should_not </span><span class=\"mtk5\">allow_value</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;email&quot;</span><span class=\"mtk1\">).</span><span class=\"mtk5\">for</span><span class=\"mtk1\">(</span><span class=\"mtk4\">:email</span><span class=\"mtk1\">) }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    it { should </span><span class=\"mtk5\">validate_presence_of</span><span class=\"mtk1\">(</span><span class=\"mtk4\">:first_name</span><span class=\"mtk1\">) }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    it { should </span><span class=\"mtk5\">validate_presence_of</span><span class=\"mtk1\">(</span><span class=\"mtk4\">:last_name</span><span class=\"mtk1\">) }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    it { should </span><span class=\"mtk5\">validate_presence_of</span><span class=\"mtk1\">(</span><span class=\"mtk4\">:age</span><span class=\"mtk1\">) }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    it { should </span><span class=\"mtk5\">validate_numericality_of</span><span class=\"mtk1\">(</span><span class=\"mtk4\">:age</span><span class=\"mtk1\">).</span><span class=\"mtk5\">only_integer</span><span class=\"mtk1\">.</span><span class=\"mtk5\">is_greater_than</span><span class=\"mtk1\">(</span><span class=\"mtk4\">18</span><span class=\"mtk1\">) }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    context </span><span class=\"mtk6\">&quot;when email is already taken&quot;</span><span class=\"mtk1\"> </span><span class=\"mtk7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk5\">let!</span><span class=\"mtk1\">(</span><span class=\"mtk4\">:customer</span><span class=\"mtk1\">) { </span><span class=\"mtk5\">create</span><span class=\"mtk1\">(</span><span class=\"mtk4\">:customer</span><span class=\"mtk1\">, </span><span class=\"mtk4\">email:</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;email@example.com&quot;</span><span class=\"mtk1\">) }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      before { customer_form.</span><span class=\"mtk5\">email</span><span class=\"mtk1\"> </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;email@example.com&quot;</span><span class=\"mtk1\"> }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      it { should_not be_valid }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      it </span><span class=\"mtk6\">&quot;has an error on email&quot;</span><span class=\"mtk1\"> </span><span class=\"mtk7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        customer_form.</span><span class=\"mtk5\">valid?</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk5\">expect</span><span class=\"mtk1\">(customer_form.</span><span class=\"mtk5\">errors</span><span class=\"mtk1\">[</span><span class=\"mtk4\">:email</span><span class=\"mtk1\">]).</span><span class=\"mtk5\">to</span><span class=\"mtk1\"> </span><span class=\"mtk7\">include</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;already taken&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  describe </span><span class=\"mtk6\">&quot;#save&quot;</span><span class=\"mtk1\"> </span><span class=\"mtk7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    context </span><span class=\"mtk6\">&quot;when form is valid&quot;</span><span class=\"mtk1\"> </span><span class=\"mtk7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      before </span><span class=\"mtk7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        customer_form.</span><span class=\"mtk5\">email</span><span class=\"mtk1\"> </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;this_is_good@test.com&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        customer_form.</span><span class=\"mtk5\">first_name</span><span class=\"mtk1\"> </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;Fred&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        customer_form.</span><span class=\"mtk5\">last_name</span><span class=\"mtk1\"> </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;Flinstone&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        customer_form.</span><span class=\"mtk5\">age</span><span class=\"mtk1\"> </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> </span><span class=\"mtk4\">44</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      it </span><span class=\"mtk6\">&quot;creates a new customer&quot;</span><span class=\"mtk1\"> </span><span class=\"mtk7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        expect { subject.</span><span class=\"mtk5\">save</span><span class=\"mtk1\"> }.</span><span class=\"mtk5\">to</span><span class=\"mtk1\"> </span><span class=\"mtk5\">change</span><span class=\"mtk1\">(Customer, </span><span class=\"mtk4\">:count</span><span class=\"mtk1\">).</span><span class=\"mtk5\">by</span><span class=\"mtk1\">(</span><span class=\"mtk4\">1</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      it </span><span class=\"mtk6\">&quot;returns true&quot;</span><span class=\"mtk1\"> </span><span class=\"mtk7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk5\">expect</span><span class=\"mtk1\">(subject.</span><span class=\"mtk5\">save</span><span class=\"mtk1\">).</span><span class=\"mtk5\">to</span><span class=\"mtk1\"> be_truthy</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      it </span><span class=\"mtk6\">&quot;sets the customer attribute&quot;</span><span class=\"mtk1\"> </span><span class=\"mtk7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        subject.</span><span class=\"mtk5\">save</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk5\">expect</span><span class=\"mtk1\">(subject.</span><span class=\"mtk5\">customer</span><span class=\"mtk1\">).</span><span class=\"mtk5\">to</span><span class=\"mtk1\"> </span><span class=\"mtk5\">be_a</span><span class=\"mtk1\">(Customer)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    context </span><span class=\"mtk6\">&quot;when form is invalid&quot;</span><span class=\"mtk1\"> </span><span class=\"mtk7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      before </span><span class=\"mtk7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk5\">allow</span><span class=\"mtk1\">(subject).</span><span class=\"mtk5\">to</span><span class=\"mtk1\"> </span><span class=\"mtk5\">receive</span><span class=\"mtk1\">(</span><span class=\"mtk4\">:valid?</span><span class=\"mtk1\">).</span><span class=\"mtk5\">and_return</span><span class=\"mtk1\">(</span><span class=\"mtk4\">false</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      it </span><span class=\"mtk6\">&quot;does not create a new customer&quot;</span><span class=\"mtk1\"> </span><span class=\"mtk7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        expect { subject.</span><span class=\"mtk5\">save</span><span class=\"mtk1\"> }.</span><span class=\"mtk5\">not_to</span><span class=\"mtk1\"> </span><span class=\"mtk5\">change</span><span class=\"mtk1\">(Customer, </span><span class=\"mtk4\">:count</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      it </span><span class=\"mtk6\">&quot;returns false&quot;</span><span class=\"mtk1\"> </span><span class=\"mtk7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk5\">expect</span><span class=\"mtk1\">(subject.</span><span class=\"mtk5\">save</span><span class=\"mtk1\">).</span><span class=\"mtk5\">to</span><span class=\"mtk1\"> be_falsey</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      it </span><span class=\"mtk6\">&quot;does not set the customer attribute&quot;</span><span class=\"mtk1\"> </span><span class=\"mtk7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        subject.</span><span class=\"mtk5\">save</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk5\">expect</span><span class=\"mtk1\">(subject.</span><span class=\"mtk5\">customer</span><span class=\"mtk1\">).</span><span class=\"mtk5\">to</span><span class=\"mtk1\"> be_nil</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">end</span></span></span></code></pre>\n<aside class=\"markdown-aside\">\nIf you're setting up a new Rails project, it defaults to minitest rather than RSpec for automated testing. See this post I wrote on <a class=\"markdown-link\" href=\"https://danielabaron.me/blog/start-rails-6-project-with-rspec/\">Starting a Rails Project with RSpec</a> for how to switch from minitest to RSpec.\n</aside>\n<h2 class=\"markdown-subtitle\" id=\"conclusion\" style=\"position:relative;\"><a href=\"#conclusion\" aria-label=\"conclusion permalink\" class=\"markdown-header-link before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Conclusion</h2>\n<p class=\"markdown-para\">This post has demonstrated how to use Active Model in a Rails application when the form presented to the user does not exactly match what should be persisted in the database. We just scratched the surface of what's available from the ActiveModel module with regards to validation. Be sure to check out the <a href=\"https://guides.rubyonrails.org/active_model_basics.html\" class=\"markdown-link\">Active Model Basics Rails Guides</a> to learn about all the available features.</p>\n<style class=\"grvsc-styles\">\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .monokai {\n    background-color: #272822;\n    color: #f8f8f2;\n  }\n  .monokai .mtki { font-style: italic; }\n  .monokai .mtku {\n    text-decoration: underline;\n    text-underline-position: under;\n  }\n  .monokai .mtk7 { color: #F92672; }\n  .monokai .mtk1 { color: #F8F8F2; }\n  .monokai .mtk5 { color: #A6E22E; }\n  .monokai .mtk4 { color: #AE81FF; }\n  .monokai .mtk3 { color: #75715E; }\n  .monokai .mtk9 { color: #66D9EF; }\n  .monokai .mtk8 { color: #F8F8F0; }\n  .monokai .mtk6 { color: #E6DB74; }\n  .monokai .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));\n  }\n</style>","timeToRead":15,"tableOfContents":"<ul>\n<li>\n<p><a href=\"#example\">Example</a></p>\n</li>\n<li>\n<p><a href=\"#first-attempt\">First Attempt</a></p>\n</li>\n<li>\n<p><a href=\"#solution\">Solution</a></p>\n<ul>\n<li><a href=\"#customerform\">CustomerForm</a></li>\n<li><a href=\"#customerscontroller-new\">CustomersController New</a></li>\n<li><a href=\"#new-view-and-form\">New View and Form</a></li>\n<li><a href=\"#customerscontroller-create\">CustomersController Create</a></li>\n<li><a href=\"#try-it\">Try It</a></li>\n<li><a href=\"#tests\">Tests</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#conclusion\">Conclusion</a></p>\n</li>\n</ul>","frontmatter":{"title":"They Don't All Have To Be ActiveRecord Models","date":"01 Sep 2023","description":"Learn how to handle forms in Rails when the UI does not map one to one with the underlying data model.","featuredImage":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#182828","images":{"fallback":{"src":"/static/f09c57681d2f9326aa60bbeee916a2c4/0d942/not-ar-model-vandan-patel-C63NHsUUR1A-unsplash.jpg","srcSet":"/static/f09c57681d2f9326aa60bbeee916a2c4/9c49f/not-ar-model-vandan-patel-C63NHsUUR1A-unsplash.jpg 225w,\n/static/f09c57681d2f9326aa60bbeee916a2c4/1df08/not-ar-model-vandan-patel-C63NHsUUR1A-unsplash.jpg 450w,\n/static/f09c57681d2f9326aa60bbeee916a2c4/0d942/not-ar-model-vandan-patel-C63NHsUUR1A-unsplash.jpg 900w","sizes":"(min-width: 900px) 900px, 100vw"},"sources":[{"srcSet":"/static/f09c57681d2f9326aa60bbeee916a2c4/9d4c5/not-ar-model-vandan-patel-C63NHsUUR1A-unsplash.webp 225w,\n/static/f09c57681d2f9326aa60bbeee916a2c4/251ee/not-ar-model-vandan-patel-C63NHsUUR1A-unsplash.webp 450w,\n/static/f09c57681d2f9326aa60bbeee916a2c4/6c2a4/not-ar-model-vandan-patel-C63NHsUUR1A-unsplash.webp 900w","type":"image/webp","sizes":"(min-width: 900px) 900px, 100vw"}]},"width":900,"height":589}}}},"fields":{"slug":"/blog/they-dont-all-have-to-be-activerecord-models/"}},"relatedP":{"edges":[{"node":{"id":"848d2c81-d508-5776-ac83-fb1e50ef5848","frontmatter":{"title":"Fix Rails Blocked Host Error with Docker","featuredImage":{"childImageSharp":{"gatsbyImageData":{"layout":"fixed","backgroundColor":"#080808","images":{"fallback":{"src":"/static/648daf1a5b7bca42ff3729828586b2dc/26528/blocked-host-fix-markus-spiske-KTuHfak_EEk-unsplash.jpg","srcSet":"/static/648daf1a5b7bca42ff3729828586b2dc/26528/blocked-host-fix-markus-spiske-KTuHfak_EEk-unsplash.jpg 300w,\n/static/648daf1a5b7bca42ff3729828586b2dc/43429/blocked-host-fix-markus-spiske-KTuHfak_EEk-unsplash.jpg 600w","sizes":"300px"},"sources":[{"srcSet":"/static/648daf1a5b7bca42ff3729828586b2dc/5d6c3/blocked-host-fix-markus-spiske-KTuHfak_EEk-unsplash.webp 300w,\n/static/648daf1a5b7bca42ff3729828586b2dc/68dbc/blocked-host-fix-markus-spiske-KTuHfak_EEk-unsplash.webp 600w","type":"image/webp","sizes":"300px"}]},"width":300,"height":170}}}},"fields":{"slug":"/blog/rails-blocked-host-docker-fix/"}}},{"node":{"id":"31449f25-76f9-5e7d-b0d7-3ef436dcfd4d","frontmatter":{"title":"Rails CORS Middleware For Multiple Resources","featuredImage":{"childImageSharp":{"gatsbyImageData":{"layout":"fixed","backgroundColor":"#080808","images":{"fallback":{"src":"/static/5c6bfd7e0c120605610036c50102bba1/26528/rails-middleware-erik-witsoe-bluVshKGwKQ-unsplash.jpg","srcSet":"/static/5c6bfd7e0c120605610036c50102bba1/26528/rails-middleware-erik-witsoe-bluVshKGwKQ-unsplash.jpg 300w,\n/static/5c6bfd7e0c120605610036c50102bba1/43429/rails-middleware-erik-witsoe-bluVshKGwKQ-unsplash.jpg 600w","sizes":"300px"},"sources":[{"srcSet":"/static/5c6bfd7e0c120605610036c50102bba1/5d6c3/rails-middleware-erik-witsoe-bluVshKGwKQ-unsplash.webp 300w,\n/static/5c6bfd7e0c120605610036c50102bba1/68dbc/rails-middleware-erik-witsoe-bluVshKGwKQ-unsplash.webp 600w","type":"image/webp","sizes":"300px"}]},"width":300,"height":170}}}},"fields":{"slug":"/blog/rails-cors-middleware-multiple/"}}},{"node":{"id":"0c2e1691-4b14-536c-acee-4d0f120de743","frontmatter":{"title":"Rails Strong Params for GET Request","featuredImage":{"childImageSharp":{"gatsbyImageData":{"layout":"fixed","backgroundColor":"#080808","images":{"fallback":{"src":"/static/30de304c73a206886f15aeaf89655663/26528/strong-params-sigmund-f0dJjQMhfXo-unsplash.jpg","srcSet":"/static/30de304c73a206886f15aeaf89655663/26528/strong-params-sigmund-f0dJjQMhfXo-unsplash.jpg 300w,\n/static/30de304c73a206886f15aeaf89655663/43429/strong-params-sigmund-f0dJjQMhfXo-unsplash.jpg 600w","sizes":"300px"},"sources":[{"srcSet":"/static/30de304c73a206886f15aeaf89655663/5d6c3/strong-params-sigmund-f0dJjQMhfXo-unsplash.webp 300w,\n/static/30de304c73a206886f15aeaf89655663/68dbc/strong-params-sigmund-f0dJjQMhfXo-unsplash.webp 600w","type":"image/webp","sizes":"300px"}]},"width":300,"height":170}}}},"fields":{"slug":"/blog/rails-strong-params-get/"}}}]}},"pageContext":{"slug":"/blog/they-dont-all-have-to-be-activerecord-models/","relatedPosts":["Fix Rails Blocked Host Error with Docker","Rails Strong Params for GET Request","Rails CORS Middleware For Multiple Resources"]}},"staticQueryHashes":["163244226"],"slicesMap":{}}