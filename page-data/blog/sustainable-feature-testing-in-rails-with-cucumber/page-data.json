{"componentChunkName":"component---src-templates-post-js","path":"/blog/sustainable-feature-testing-in-rails-with-cucumber/","result":{"data":{"markdownRemark":{"html":"<p class=\"markdown-para\">When your web app has been around for years, you need more than unit tests, you need proof the whole thing still works from the user's perspective. That's where end-to-end tests (a.k.a. system or browser-based tests) come in, simulating clicks, form fills, and page loads to verify entire workflows through the UI. These tests shouldn't just verify correct behaviour; they should tell a clear story about what's being tested. But as your project grows, those same tests can morph into dense, brittle scripts that hide the \"what\" behind the \"how\", making them painful to read and maintain.</p>\n<p class=\"markdown-para\">That's where <a href=\"https://cucumber.io/\" class=\"markdown-link\">Cucumber</a> comes in. By separating high-level intent from low-level implementation, Cucumber lets you write tests in plain language that developers, product managers, and future-you can all understand at a glance. In this post, I'll walk through examples from a demo Rails app: <a href=\"https://github.com/danielabar/book_review_demo\" class=\"markdown-link\">Book Review Demo</a>, to show how Cucumber can make your test suite more readable and maintainable.</p>\n<p class=\"markdown-para\">This post assumes you are familiar with Ruby on Rails and have some experience writing system or feature tests, such as with RSpec and Capybara or similar tools.</p>\n<h2 class=\"markdown-subtitle\" id=\"what-is-cucumber\" style=\"position:relative;\"><a href=\"#what-is-cucumber\" aria-label=\"what is cucumber permalink\" class=\"markdown-header-link before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>What Is Cucumber?</h2>\n<p class=\"markdown-para\">Cucumber is a testing tool that lets you describe application behavior in plain language. Unlike Selenium WebDriver, which controls the browser directly through drivers like ChromeDriver, Cucumber sits <em class=\"markdown-emphasis\">above</em> your browser automation stack. Its job isn't to drive the browser, but to express what you want to test in a way that anyone on your team, technical or non technical, can read and understand.</p>\n<p class=\"markdown-para\">Cucumber scenarios are written in a structured format called <a href=\"https://cucumber.io/docs/gherkin/reference\" class=\"markdown-link\">Gherkin</a>, which uses keywords like <code>Feature</code>, <code>Background</code>, <code>Scenario</code>, <code>Given</code>, <code>When</code>, and <code>Then</code> to describe user-facing behavior. Each line beginning with <code>Given</code>, <code>When</code>, <code>Then</code> or <code>And</code> is called a <a href=\"https://cucumber.io/docs/cucumber/api#steps\" class=\"markdown-link\">step</a>, which is a plain-language instruction that maps to Ruby code performing the actual test logic.</p>\n<p class=\"markdown-para\">For example:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"gherkin\" data-index=\"0\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">Feature</span><span class=\"mtk1\">:</span><span class=\"mtk6\"> Book reviews</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">Background</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">Given </span><span class=\"mtk1\">the following books exist:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">      | Title      | Author   | Published Year |</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">      | Book One   | Author A | 2001           |</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">      | Book Two   | Author B | 2002           |</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">And </span><span class=\"mtk1\">users exist:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">      | Email             | Password  |</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">      | user1@example.com | password1 |</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">      | user2@example.com | password2 |</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">And </span><span class=\"mtk1\">the following reviews exist:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">      | Book     | User Email        | Rating | Body       |</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">      | Book One | user2@example.com | 4      | Good read. |</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">And </span><span class=\"mtk1\">I am signed in as </span><span class=\"mtk6\">&quot;user1@example.com&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">Scenario</span><span class=\"mtk1\">:</span><span class=\"mtk6\"> User sees book details and reviews</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">When </span><span class=\"mtk1\">I visit the book show page for </span><span class=\"mtk6\">&quot;Book One&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">Then </span><span class=\"mtk1\">I should see the book title, author, and published year for </span><span class=\"mtk6\">&quot;Book One&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">And </span><span class=\"mtk1\">I should see the review for </span><span class=\"mtk6\">&quot;user2@example.com&quot;</span><span class=\"mtk1\"> with body </span><span class=\"mtk6\">&quot;Good read.&quot;</span><span class=\"mtk1\"> and 4 stars</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">And </span><span class=\"mtk1\">I should see a submit review button</span></span></span></code></pre>\n<p class=\"markdown-para\">We'll look at how those plain language steps connect to Ruby code in just a bit, but for now, notice how readable it is, even without knowing any Ruby or testing library syntax.</p>\n<p class=\"markdown-para\">These phrases aren't comments or placeholders, they make up an executable test. Behind the scenes, each plain language step is connected to Ruby code that can use Capybara (or other browser automation tools) to interact with the web application under test. This provides the best of both worlds: readable intent at the top, and full control at the bottom.</p>\n<p class=\"markdown-para\">Cucumber is especially valuable in projects where collaboration matters. Product managers, QA engineers, designers, and even stakeholders can follow along with what's being tested without needing to parse through RSpec matchers or complex DOM selectors. And for developers, that same clarity makes tests easier to write, refactor, and maintain over the long haul.</p>\n<aside class=\"markdown-aside\">\nWhile this post uses a Ruby on Rails example, Cucumber, <a class=\"markdown-link\" href=\"https://en.wikipedia.org/wiki/Cucumber_%28software%29\">originally written in Ruby</a>, works with many languages, including Java, JavaScript, Python, and more. See the <a class=\"markdown-link\" href=\"https://cucumber.io/docs/installation/\">installation options</a> for a full list.\n</aside>\n<h2 class=\"markdown-subtitle\" id=\"why-not-just-rspec--capybara\" style=\"position:relative;\"><a href=\"#why-not-just-rspec--capybara\" aria-label=\"why not just rspec  capybara permalink\" class=\"markdown-header-link before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Why Not Just RSpec + Capybara?</h2>\n<p class=\"markdown-para\">It's worth asking: If system testing can already be accomplished with RSpec and Capybara, why add another layer? Let's take a look at how the same scenario we saw earlier might look using RSpec system tests (assume <a href=\"https://github.com/thoughtbot/factory_bot\" class=\"markdown-link\">factory_bot</a> is installed and factories have been defined for all models):</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"ruby\" data-index=\"1\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">require</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;rails_helper&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk9 mtki\">RSpec</span><span class=\"mtk1\">.</span><span class=\"mtk5\">describe</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;Book show page&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk4\">type:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">:system</span><span class=\"mtk1\"> </span><span class=\"mtk7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk5\">let!</span><span class=\"mtk1\">(</span><span class=\"mtk4\">:book_one</span><span class=\"mtk1\">) { </span><span class=\"mtk5\">create</span><span class=\"mtk1\">(</span><span class=\"mtk4\">:book</span><span class=\"mtk1\">, </span><span class=\"mtk4\">title:</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;Book One&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk4\">author:</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;Author A&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk4\">published_year:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">2001</span><span class=\"mtk1\">) }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk5\">let!</span><span class=\"mtk1\">(</span><span class=\"mtk4\">:book_two</span><span class=\"mtk1\">) { </span><span class=\"mtk5\">create</span><span class=\"mtk1\">(</span><span class=\"mtk4\">:book</span><span class=\"mtk1\">, </span><span class=\"mtk4\">title:</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;Book Two&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk4\">author:</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;Author B&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk4\">published_year:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">2002</span><span class=\"mtk1\">) }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk5\">let!</span><span class=\"mtk1\">(</span><span class=\"mtk4\">:user1</span><span class=\"mtk1\">)    { </span><span class=\"mtk5\">create</span><span class=\"mtk1\">(</span><span class=\"mtk4\">:user</span><span class=\"mtk1\">, </span><span class=\"mtk4\">email:</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;user1@example.com&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk4\">password:</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;password1&quot;</span><span class=\"mtk1\">) }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk5\">let!</span><span class=\"mtk1\">(</span><span class=\"mtk4\">:user2</span><span class=\"mtk1\">)    { </span><span class=\"mtk5\">create</span><span class=\"mtk1\">(</span><span class=\"mtk4\">:user</span><span class=\"mtk1\">, </span><span class=\"mtk4\">email:</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;user2@example.com&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk4\">password:</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;password2&quot;</span><span class=\"mtk1\">) }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk5\">let!</span><span class=\"mtk1\">(</span><span class=\"mtk4\">:review</span><span class=\"mtk1\">)   { </span><span class=\"mtk5\">create</span><span class=\"mtk1\">(</span><span class=\"mtk4\">:review</span><span class=\"mtk1\">, </span><span class=\"mtk4\">book:</span><span class=\"mtk1\"> book_one, </span><span class=\"mtk4\">user:</span><span class=\"mtk1\"> user2, </span><span class=\"mtk4\">rating:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">4</span><span class=\"mtk1\">, </span><span class=\"mtk4\">body:</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;Good read.&quot;</span><span class=\"mtk1\">) }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  before </span><span class=\"mtk7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    sign_in user1</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  it </span><span class=\"mtk6\">&quot;shows book details and existing reviews&quot;</span><span class=\"mtk1\"> </span><span class=\"mtk7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    visit </span><span class=\"mtk5\">book_path</span><span class=\"mtk1\">(book_one)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk5\">within</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;#</span><span class=\"mtk7\">#{</span><span class=\"mtk5\">dom_id</span><span class=\"mtk1\">(book_one)</span><span class=\"mtk7\">}</span><span class=\"mtk6\">&quot;</span><span class=\"mtk1\">) </span><span class=\"mtk7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk5\">expect</span><span class=\"mtk1\">(page).</span><span class=\"mtk5\">to</span><span class=\"mtk1\"> </span><span class=\"mtk5\">have_content</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;Book One&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk5\">expect</span><span class=\"mtk1\">(page).</span><span class=\"mtk5\">to</span><span class=\"mtk1\"> </span><span class=\"mtk5\">have_content</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;Author A&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk5\">expect</span><span class=\"mtk1\">(page).</span><span class=\"mtk5\">to</span><span class=\"mtk1\"> </span><span class=\"mtk5\">have_content</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;2001&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk5\">within</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;[data-testid=&quot;reviews-list&quot;]&#39;</span><span class=\"mtk1\">) </span><span class=\"mtk7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      review_item </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> </span><span class=\"mtk5\">all</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;[data-testid=&quot;review-item&quot;]&#39;</span><span class=\"mtk1\">).</span><span class=\"mtk5\">find</span><span class=\"mtk1\"> </span><span class=\"mtk7\">do</span><span class=\"mtk1\"> |item|</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        item.</span><span class=\"mtk5\">find</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;[data-testid=&quot;review-author&quot;]&#39;</span><span class=\"mtk1\">).</span><span class=\"mtk5\">text</span><span class=\"mtk1\"> </span><span class=\"mtk7\">==</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;user2@example.com&quot;</span><span class=\"mtk1\"> </span><span class=\"mtk7\">&amp;&amp;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        item.</span><span class=\"mtk5\">find</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;[data-testid=&quot;review-body&quot;]&#39;</span><span class=\"mtk1\">).</span><span class=\"mtk5\">text</span><span class=\"mtk1\"> </span><span class=\"mtk7\">==</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;Good read.&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk5\">expect</span><span class=\"mtk1\">(review_item).</span><span class=\"mtk5\">not_to</span><span class=\"mtk1\"> be_nil</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk5\">expect</span><span class=\"mtk1\">(review_item.</span><span class=\"mtk5\">find</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;[data-testid=&quot;review-rating&quot;]&#39;</span><span class=\"mtk1\">).</span><span class=\"mtk5\">all</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;svg&#39;</span><span class=\"mtk1\">).</span><span class=\"mtk5\">size</span><span class=\"mtk1\">).</span><span class=\"mtk5\">to</span><span class=\"mtk1\"> </span><span class=\"mtk5\">eq</span><span class=\"mtk1\">(</span><span class=\"mtk4\">4</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk5\">expect</span><span class=\"mtk1\">(page).</span><span class=\"mtk5\">to</span><span class=\"mtk1\"> </span><span class=\"mtk5\">have_button</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;Submit Review&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">end</span></span></span></code></pre>\n<p class=\"markdown-para\">While the same concepts are being tested, it takes effort to understand what's actually being tested. It's not <em class=\"markdown-emphasis\">terrible</em>, especially for developers familiar with Capybara, but it's clearly written for the machine, not the human. You have to <em class=\"markdown-emphasis\">parse</em> the <code>let</code>, <code>within</code>, <code>all</code>, and <code>find</code> blocks to reconstruct what's going on. The intent: \"show book details and reviews\", is buried inside DOM selectors and and Capybara DSL calls.</p>\n<p class=\"markdown-para\">This is where Cucumber shines. Instead of encoding all the implementation detail in the test body, Cucumber pushes that detail down into step definitions. The result is a high-level test that reads like documentation.</p>\n<aside class=\"markdown-aside\">\nIt is possible to make RSpec system tests more readable using custom matchers, <a class=\"markdown-link\" href=\"https://martinfowler.com/bliki/PageObject.html\">page objects</a>, or helper methods. But these strategies can also add complexity or hide detail in other files. Cucumber, on the other hand, embraces the separation between intent and implementation from the start.\n</aside>\n<p class=\"markdown-para\">And the best part? You don't have to throw out your existing Capybara setup to adopt it. Cucumber doesn't replace Capybara, it wraps around it. The same drivers and DSL methods can still be used. You're just giving your tests a better top layer.</p>\n<h2 class=\"markdown-subtitle\" id=\"setting-up-cucumber\" style=\"position:relative;\"><a href=\"#setting-up-cucumber\" aria-label=\"setting up cucumber permalink\" class=\"markdown-header-link before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Setting Up Cucumber</h2>\n<p class=\"markdown-para\">In this section, we'll walk through setting up Cucumber in an existing Rails project. We'll configure Cucumber to work with Capybara, Cuprite (for headless JavaScript testing), FactoryBot, Devise, and DatabaseCleaner.</p>\n<h3 class=\"markdown-sub-subtitle\" id=\"installation\" style=\"position:relative;\"><a href=\"#installation\" aria-label=\"installation permalink\" class=\"markdown-header-link before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Installation</h3>\n<p class=\"markdown-para\">Start by updating the project's <code>Gemfile</code> under the <code>:test</code> group. Note that we're opting for <code>cuprite</code> instead of the default <code>selenium-webdriver</code> because it's easier to setup:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"ruby\" data-index=\"2\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">group </span><span class=\"mtk4\">:test</span><span class=\"mtk1\"> </span><span class=\"mtk7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  gem </span><span class=\"mtk6\">&quot;capybara&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  gem </span><span class=\"mtk6\">&quot;cuprite&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  gem </span><span class=\"mtk6\">&quot;cucumber-rails&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk4\">require:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">false</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  gem </span><span class=\"mtk6\">&quot;database_cleaner&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">end</span></span></span></code></pre>\n<p class=\"markdown-para\">Then run:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"bash\" data-index=\"3\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">bundle install</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">bin/rails generate cucumber:install</span></span></span></code></pre>\n<p class=\"markdown-para\">This creates a new <code>features/</code> directory as shown below:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"\" data-index=\"4\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">features/</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">├── your .feature files go here</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">├── step_definitions/</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">│   └── *_steps.rb files contain your step logic</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">└── support/</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    ├── env.rb (auto-generated, do not modify)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    └── custom configuration (see below)</span></span></code></pre>\n<p class=\"markdown-para\">All files in <code>features/support/*.rb</code> will be automatically loaded when tests run. The following sections explain each file we'll be adding and why it's needed.</p>\n<h3 class=\"markdown-sub-subtitle\" id=\"browser-driver\" style=\"position:relative;\"><a href=\"#browser-driver\" aria-label=\"browser driver permalink\" class=\"markdown-header-link before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Browser Driver</h3>\n<p class=\"markdown-para\">Cucumber itself is agnostic about how your tests interact with the browser - it runs your scenarios and delegates the actual browser automation to whatever tool you choose. In Rails projects, a popular choice is <a href=\"https://github.com/teamcapybara/capybara\" class=\"markdown-link\">Capybara</a>, which provides a unified API for driving different browser engines.</p>\n<p class=\"markdown-para\">Here, we configure Capybara to use <a href=\"https://github.com/rubycdp/cuprite\" class=\"markdown-link\">Cuprite</a>, a pure Ruby driver for Capybara. The configuration below sets Cuprite as the default driver for both regular and JavaScript-enabled tests. It enables headless mode by default, sets a large window size for consistent screenshots, and includes a Docker-friendly option.</p>\n<p class=\"markdown-para\">Add <code>features/support/cuprite.rb</code>:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"ruby\" data-index=\"5\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">require</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;capybara/cuprite&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk9 mtki\">Capybara</span><span class=\"mtk1\">.</span><span class=\"mtk5\">default_driver</span><span class=\"mtk1\"> </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> </span><span class=\"mtk4\">:cuprite</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk9 mtki\">Capybara</span><span class=\"mtk1\">.</span><span class=\"mtk5\">javascript_driver</span><span class=\"mtk1\"> </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> </span><span class=\"mtk4\">:cuprite</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk9 mtki\">Capybara</span><span class=\"mtk1\">.</span><span class=\"mtk5\">register_driver</span><span class=\"mtk1\">(</span><span class=\"mtk4\">:cuprite</span><span class=\"mtk1\">) </span><span class=\"mtk7\">do</span><span class=\"mtk1\"> |app|</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk9 mtki\">Capybara</span><span class=\"mtk1\">::</span><span class=\"mtk9 mtki\">Cuprite</span><span class=\"mtk1\">::</span><span class=\"mtk9 mtki\">Driver</span><span class=\"mtk1\">.</span><span class=\"mtk7\">new</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    app,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">window_size:</span><span class=\"mtk1\"> [</span><span class=\"mtk4\">1920</span><span class=\"mtk1\">, </span><span class=\"mtk4\">1080</span><span class=\"mtk1\">],</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">js_errors:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">true</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">headless:</span><span class=\"mtk1\"> </span><span class=\"mtk7\">!</span><span class=\"mtk1\">ENV[</span><span class=\"mtk6\">&quot;VISIBLE_BROWSER&quot;</span><span class=\"mtk1\">],</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3\"># Max time (in seconds) to wait for browser commands to complete</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">timeout:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">10</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">browser_options:</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk3\"># Required if running in Docker</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk6\">&quot;no-sandbox&quot;</span><span class=\"mtk1\"> =&gt; </span><span class=\"mtk4\">nil</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  )</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># Max time (in seconds) to wait for elements to appear/disappear</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk9 mtki\">Capybara</span><span class=\"mtk1\">.</span><span class=\"mtk5\">default_max_wait_time</span><span class=\"mtk1\"> </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> </span><span class=\"mtk4\">5</span></span></span></code></pre>\n<h3 class=\"markdown-sub-subtitle\" id=\"databasecleaner\" style=\"position:relative;\"><a href=\"#databasecleaner\" aria-label=\"databasecleaner permalink\" class=\"markdown-header-link before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>DatabaseCleaner</h3>\n<p class=\"markdown-para\">With JavaScript drivers, Capybara runs the app server in a separate thread from your tests, so transactions aren't shared. Simply rolling back a transaction at the end of a test won't clean up data seen by both threads. This means we need to configure truncation to ensure a clean state between tests.</p>\n<p class=\"markdown-para\">Create <code>features/support/database_cleaner.rb</code>:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"ruby\" data-index=\"6\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk9 mtki\">DatabaseCleaner</span><span class=\"mtk1\">.</span><span class=\"mtk5\">strategy</span><span class=\"mtk1\"> </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> </span><span class=\"mtk4\">:truncation</span></span></span></code></pre>\n<h3 class=\"markdown-sub-subtitle\" id=\"factorybot\" style=\"position:relative;\"><a href=\"#factorybot\" aria-label=\"factorybot permalink\" class=\"markdown-header-link before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>FactoryBot</h3>\n<p class=\"markdown-para\"><a href=\"https://github.com/thoughtbot/factory_bot\" class=\"markdown-link\">FactoryBot</a> makes it easy to set up test data, and it works well with Cucumber once configured. (Assumes you've already added <code>factory_bot_rails</code> to your Gemfile in the <code>:test</code> group.)</p>\n<p class=\"markdown-para\">Add <code>features/support/factory_bot.rb</code>:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"ruby\" data-index=\"7\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">World(</span><span class=\"mtk9 mtki\">FactoryBot</span><span class=\"mtk1\">::</span><span class=\"mtk9 mtki\">Syntax</span><span class=\"mtk1\">::Methods)</span></span></span></code></pre>\n<p class=\"markdown-para\">This makes methods like <code>create(:user)</code> available directly in your step definitions, no need to prefix with <code>FactoryBot.</code></p>\n<h3 class=\"markdown-sub-subtitle\" id=\"fast-login\" style=\"position:relative;\"><a href=\"#fast-login\" aria-label=\"fast login permalink\" class=\"markdown-header-link before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Fast Login</h3>\n<p class=\"markdown-para\">If your Rails app uses <a href=\"https://github.com/heartcombo/devise\" class=\"markdown-link\">Devise</a> for authentication (which depends on <a href=\"https://github.com/wardencommunity/warden\" class=\"markdown-link\">Warden</a>), you can speed up your Cucumber tests by signing in users programmatically with Warden's test helpers instead of filling in login forms every time.</p>\n<p class=\"markdown-para\">Add this to <code>features/support/warden.rb</code> to enable and reset Warden’s test mode:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"ruby\" data-index=\"8\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># Enable Warden test mode to bypass real authentication</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk9 mtki\">Warden</span><span class=\"mtk1\">.</span><span class=\"mtk5\">test_mode!</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># Make Warden test helper methods available in steps</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">World(</span><span class=\"mtk9 mtki\">Warden</span><span class=\"mtk1\">::</span><span class=\"mtk9 mtki\">Test</span><span class=\"mtk1\">::Helpers)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># Clean up Warden state after each scenario</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">After { </span><span class=\"mtk9 mtki\">Warden</span><span class=\"mtk1\">.</span><span class=\"mtk5\">test_reset!</span><span class=\"mtk1\"> }</span></span></span></code></pre>\n<p class=\"markdown-para\">Now you can call <code>login_as(user)</code> in your step definitions to simulate a logged-in user quickly. This makes your tests faster, but you should still keep at least one test that exercises the actual login form to ensure it works correctly.</p>\n<h3 class=\"markdown-sub-subtitle\" id=\"reports-service\" style=\"position:relative;\"><a href=\"#reports-service\" aria-label=\"reports service permalink\" class=\"markdown-header-link before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Reports Service</h3>\n<p class=\"markdown-para\">When running Cucumber tests for the first time, it may display a message about publishing results. This refers to Cucumber's optional <a href=\"https://reports.cucumber.io/\" class=\"markdown-link\">reports service</a> for uploading test run data to an online dashboard. It can be useful for teams who want to share test reports in a web interface, but it's not required.</p>\n<p class=\"markdown-para\">If you don't need this feature, it can be silenced by editing <code>config/cucumber.yml</code>, which was generated during setup:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"yml\" data-index=\"9\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">std_opts = &quot;--format</span><span class=\"mtk1\"> </span><span class=\"mtk3\">#{ENV[&#39;CUCUMBER_FORMAT&#39;] || &#39;pretty&#39;} --strict --tags &#39;not @wip&#39; --publish-quiet&quot;</span></span></span></code></pre>\n<p class=\"markdown-para\">This also sets a few sensible defaults:</p>\n<ul class=\"markdown-list-unordered\">\n<li class=\"markdown-list-item\"><code>--strict</code> will fail the build on undefined or pending steps.</li>\n<li class=\"markdown-list-item\"><code>--tags 'not @wip'</code> skips work-in-progress scenarios unless explicitly tagged.</li>\n</ul>\n<h2 class=\"markdown-subtitle\" id=\"writing-your-first-feature-test\" style=\"position:relative;\"><a href=\"#writing-your-first-feature-test\" aria-label=\"writing your first feature test permalink\" class=\"markdown-header-link before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Writing Your First Feature Test</h2>\n<p class=\"markdown-para\">Suppose we want to test the login flow in our Book Review Demo app. Let's start by looking at what the user sees:</p>\n<p class=\"markdown-para\"><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 78.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsTAAALEwEAmpwYAAACvElEQVR42qWSy09TQRTGh5Ua3egCVKpS2wImUIQiERaYuEATLya6Y6V/hOIjSkTFYEx4NLQESGNjMG7QFFkY/UtUQqIbY4i2vW1v7zzOzGfmUvFFlMRJfvlmzpz5MufMsL17G3d1tscGutojg2dP9p07PTDg9Pf3O719fc7x451Oc0uL09Lauoldx5qbnaZIxGk6etSJRKPnwpHIYLyj40w8Ht/J9uzZF287FtWd7c041dWNnt5eJLoSaGtrRzQaQ319A+obatQ3oGH/fhw4eBDhw0cQDocROhRCKNSIWCxGjaFQnA0NDXVPTE6IqeQMJpNJPTU9bVLptHmcfWwymYxJpVJmJjUTYOfp2bSZm583TzIZk81mzexcRs8tZDGVnOXnB51ulkqlE1/zX0TBLcMtVXSxVDFVLgyAbUGAlgDKHHx0dCTBRu/eS+QLJakNICUZqTSEIHhVscn71TW8fbcKn0t4Vb4Zr/oCPhdGKoVi0eVXrg53s/tjDxL5fFFaI59Lw4WCIgKRDlSRhpASXAiQ3oh9V5vLhQouUXTLfPja9ZphwZWKTG2T4Hoc6wUPnjQoc42KMBvYOddBjNtK5HYNqxJfXB8ln4LDP2MN3aqGJzTkdgyFJHApkXfLEIogyUAoDWlLVz+wZW/rhlwQAIsPoAJA1h5U/8E/e+hzZYwmfFxXeLjk49HzKiZyEgtvCAuvCdMrhOTKhn5Y1zBaBWf+bmgU1j5r3FrUuPNM4/ZTwviSDri1SBh5SoGuftKA2cLw3v2xxNd80ReStM+FqvqSSNm6JQFWFUGXCajUYhsQSbK5PpdKSDKFYskbHr6WYOPjD094nu3Xr4N+6pa1UPrXDv4+7Ke/ceNmD7t06XL4xYvc0vLyyutc7uWrrVheXgn4y/6bXO7l0oULF8OMMVbHGNvBGNv9n1iPum/KBLKKXFf+OQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"cucumber book review demo app login\"\n        title=\"cucumber book review demo app login\"\n        src=\"/static/9351b30426887a1869c79641be160a57/5a190/cucumber-book-review-demo-app-login.png\"\n        srcset=\"/static/9351b30426887a1869c79641be160a57/772e8/cucumber-book-review-demo-app-login.png 200w,\n/static/9351b30426887a1869c79641be160a57/e17e5/cucumber-book-review-demo-app-login.png 400w,\n/static/9351b30426887a1869c79641be160a57/5a190/cucumber-book-review-demo-app-login.png 800w,\n/static/9351b30426887a1869c79641be160a57/5b587/cucumber-book-review-demo-app-login.png 1010w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p class=\"markdown-para\">A user enters their credentials and clicks “Log in.” If the login is successful, they're redirected to the landing page, and the navigation bar updates to indicate they're logged in:</p>\n<p class=\"markdown-para\"><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 78.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsTAAALEwEAmpwYAAADLElEQVR42qWR328UVRTHL09q5AUfSusC7o9ut6a2hM5CxISa+FBNGB4anvoijya+GcO21cQHKC0m2HbbnU1QEowPJiT82CYaI/EfIBZLKbQChW13u4uW7c7O7s7Mnbl3ztfM0o1FEhPlJp/c780553vOyWW7dgVeOdAd7e/tjhz74O13jr7X36/29fWpR470qUo8rnbEYmqss7OBr6OxDrU9GlXfCIfVYCikRiKRo+G9e4/1dHW9371//8ts587Xet56s9070N2Bd3vjOHT4MJReBZ2xTgSDIbS07EbL7qe0traira0NrwcCiASDCIfD2LNvHwLRKNq7uuSeQKCHDQ4OxicmJ52p6RQmktPe5FSSUlqatLRGMzMzlNK0BjOpFH01MUFTySRNp1L0tZam899coPPJpHfxo4+hffIpV48fjzMtnVZ0veSYZg2WbXqmZZKULgH4V6QU5Pla1z2MnwMuXeFfTE0qbPT0KaVUrrp5HVh9Imn1iUR2QyC/6TxHsSJQ0EXjblKoSHpsAxtVkw8PJeLsy/ExZWPTcJeLHu7kXfq9SHjwJ1CoAusGsF7dprfeTZ03gNVNSXmdUCrX+GcjQ3E2emZMKeuG29iEiBbvLuHXm7dw6/YSlu+tYG7+Dm7MLeC3hSXcmLuN+YW7WFhcxs35RdxfycKTHnkewTBqPDE0HGenR88oeqXq1kyOTb1K2bUC7q2s4sGjHLK5AorFHHK5LP54vI5iIdeIrWTzuP9wDY/WCiiVDbK4C6Na5ycT/oQNQ8O1uYBu1Khu2qhbDmybo1SxMXbJxvBFG59/x3HqexvVOodpcdR9TBu6USe/1jdMJLatLCTBFR65woPjSggpUbc9fPuLROoHCe1HiQvXJbjrwRWykePn+jV+baW5ctPQFQTuCOKOQBPHFQCeZXt8i8YQzxn6Xfyg39lxnk7AHQmLPwvfiv2dI0iIf3xKqazbjis8y3aEzR35X7C4I7grSK8Y5snEkMLGz549WDdNvOixOMfwyMgh9uGJE6ErV69ezszO/nwtk/np/5CZnb1+LZO5PDAwEGKMsR2MsZcYY6++IL7Hjr8AcYOoxkR0fNsAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"cucumber book review demo app signed in\"\n        title=\"cucumber book review demo app signed in\"\n        src=\"/static/2de5ffd94cca2f484f9b3c212f726589/5a190/cucumber-book-review-demo-app-signed-in.png\"\n        srcset=\"/static/2de5ffd94cca2f484f9b3c212f726589/772e8/cucumber-book-review-demo-app-signed-in.png 200w,\n/static/2de5ffd94cca2f484f9b3c212f726589/e17e5/cucumber-book-review-demo-app-signed-in.png 400w,\n/static/2de5ffd94cca2f484f9b3c212f726589/5a190/cucumber-book-review-demo-app-signed-in.png 800w,\n/static/2de5ffd94cca2f484f9b3c212f726589/5b587/cucumber-book-review-demo-app-signed-in.png 1010w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p class=\"markdown-para\">Let's see how we can express this workflow as a Cucumber feature test:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"gherkin\" data-index=\"10\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># features/authentication.feature</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">Feature</span><span class=\"mtk1\">:</span><span class=\"mtk6\"> User authentication</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">Scenario</span><span class=\"mtk1\">:</span><span class=\"mtk6\"> User logs in with valid credentials</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">Given </span><span class=\"mtk1\">a user exists with email </span><span class=\"mtk6\">&quot;user@example.com&quot;</span><span class=\"mtk1\"> and password </span><span class=\"mtk6\">&quot;password&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">When </span><span class=\"mtk1\">I visit the login page</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">And </span><span class=\"mtk1\">I fill in </span><span class=\"mtk6\">&quot;Email&quot;</span><span class=\"mtk1\"> with </span><span class=\"mtk6\">&quot;user@example.com&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">And </span><span class=\"mtk1\">I fill in </span><span class=\"mtk6\">&quot;Password&quot;</span><span class=\"mtk1\"> with </span><span class=\"mtk6\">&quot;password&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">And </span><span class=\"mtk1\">I click </span><span class=\"mtk6\">&quot;Log in&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">Then </span><span class=\"mtk1\">I should see </span><span class=\"mtk6\">&quot;Signed in as user@example.com&quot;</span><span class=\"mtk1\"> in the navigation bar</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">And </span><span class=\"mtk1\">I should see a </span><span class=\"mtk6\">&quot;Logout&quot;</span><span class=\"mtk1\"> button</span></span></span></code></pre>\n<p class=\"markdown-para\">A feature file starts with a <code>Feature</code> block, which describes a high-level capability or area of your application (for example, \"User authentication\" or \"Book reviews\"). Feature files can contain multiple <code>Scenario</code> blocks, representing user stories or test cases within that feature.</p>\n<p class=\"markdown-para\">Each line in the <code>Scenario</code> maps to a Ruby method called a <a href=\"https://cucumber.io/docs/cucumber/step-definitions\" class=\"markdown-link\">step definition</a>, which connects steps in the feature file to code. These Ruby files are located at <code>features/step_definitions/</code>.</p>\n<p class=\"markdown-para\">The <code>Given</code> keyword is used to set up the initial state for your scenario. This might mean creating test data, configuring the environment, or ensuring the application is in a known state before the user takes any actions.</p>\n<p class=\"markdown-para\">Here's what the step definitions for the above scenario might look like:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"ruby\" data-index=\"11\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># features/step_definitions/authentication_steps.rb</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">Given(</span><span class=\"mtk6\">&quot;a user exists with email {string} and password {string}&quot;</span><span class=\"mtk1\">) </span><span class=\"mtk7\">do</span><span class=\"mtk1\"> |email, password|</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk5\">create</span><span class=\"mtk1\">(</span><span class=\"mtk4\">:user</span><span class=\"mtk1\">, </span><span class=\"mtk4\">email:</span><span class=\"mtk1\"> email, </span><span class=\"mtk4\">password:</span><span class=\"mtk1\"> password) </span><span class=\"mtk3\"># FactoryBot</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">When(</span><span class=\"mtk6\">&quot;I visit the login page&quot;</span><span class=\"mtk1\">) </span><span class=\"mtk7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  visit new_user_session_path</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">When(</span><span class=\"mtk6\">&quot;I fill in {string} with {string}&quot;</span><span class=\"mtk1\">) </span><span class=\"mtk7\">do</span><span class=\"mtk1\"> |field, value|</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  fill_in field, </span><span class=\"mtk4\">with:</span><span class=\"mtk1\"> value</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">When(</span><span class=\"mtk6\">&quot;I click {string}&quot;</span><span class=\"mtk1\">) </span><span class=\"mtk7\">do</span><span class=\"mtk1\"> |button|</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  click_button button</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">Then(</span><span class=\"mtk6\">&quot;I should see {string} in the navigation bar&quot;</span><span class=\"mtk1\">) </span><span class=\"mtk7\">do</span><span class=\"mtk1\"> |text|</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk5\">within</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;nav&quot;</span><span class=\"mtk1\">) { </span><span class=\"mtk5\">expect</span><span class=\"mtk1\">(page).</span><span class=\"mtk5\">to</span><span class=\"mtk1\"> </span><span class=\"mtk5\">have_content</span><span class=\"mtk1\">(text) }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">Then(</span><span class=\"mtk6\">&quot;I should see a {string} button&quot;</span><span class=\"mtk1\">) </span><span class=\"mtk7\">do</span><span class=\"mtk1\"> |text|</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk5\">expect</span><span class=\"mtk1\">(page).</span><span class=\"mtk5\">to</span><span class=\"mtk1\"> </span><span class=\"mtk5\">have_button</span><span class=\"mtk1\">(text)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">end</span></span></span></code></pre>\n<p class=\"markdown-para\">Each <code>{string}</code>, <code>{int}</code>, or other placeholder in the step's text corresponds to a parameter passed into the Ruby step definition block. For example, in:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"ruby\" data-index=\"12\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">Given(</span><span class=\"mtk6\">&quot;a user exists with email {string} and password {string}&quot;</span><span class=\"mtk1\">) </span><span class=\"mtk7\">do</span><span class=\"mtk1\"> |email, password|</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk3\"># ...</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">end</span></span></span></code></pre>\n<p class=\"markdown-para\">the two <code>{string}</code> placeholders in the feature step are extracted and provided as the <code>email</code> and <code>password</code> variables inside the block.</p>\n<p class=\"markdown-para\"><strong class=\"markdown-strong\">Additional Notes:</strong></p>\n<ul class=\"markdown-list-unordered\">\n<li class=\"markdown-list-item\">You can use any Ruby code, including Capybara matchers and Rails helpers inside the step definitions.</li>\n<li class=\"markdown-list-item\">The <code>{string}</code> placeholders let you reuse steps for different values.</li>\n<li class=\"markdown-list-item\">You can mix and match <code>Given</code>, <code>When</code>, <code>Then</code>, and <code>And</code> in both your feature files and step definitions - Cucumber matches them by the text rather than the Gherkin keyword.</li>\n<li class=\"markdown-list-item\">In addition to <code>{string}</code>, step definitions can match on several other <a href=\"https://github.com/cucumber/cucumber-expressions?tab=readme-ov-file#parameter-types\" class=\"markdown-link\">types</a></li>\n<li class=\"markdown-list-item\">If the built-in types aren't enough for your use case, you can write a <a href=\"https://github.com/cucumber/cucumber-expressions?tab=readme-ov-file#custom-parameter-types\" class=\"markdown-link\">custom type</a></li>\n</ul>\n<p class=\"markdown-para\">To run this feature test:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"bash\" data-index=\"13\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># Run a specific feature test</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">bundle </span><span class=\"mtk9\">exec</span><span class=\"mtk1\"> cucumber features/authentication.feature</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># Run all feature tests</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">bundle </span><span class=\"mtk9\">exec</span><span class=\"mtk1\"> cucumber</span></span></span></code></pre>\n<p class=\"markdown-para\">Cucumber will print each step as it runs, showing which Ruby file and line number implements it. If all steps pass, you'll see a summary at the end. For example:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"\" data-index=\"14\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">Capybara starting Puma...</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">* Version 6.6.0, codename: Return to Forever</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">* Min threads: 0, max threads: 4</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">* Listening on http://127.0.0.1:56341</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Feature: User authentication</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  Scenario: User logs in with valid credentials                               # features/demo_auth.feature:3</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    Given a user exists with email &quot;user@example.com&quot; and password &quot;password&quot; # features/step_definitions/authentication_steps.rb:9</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    When I visit the login page                                               # features/step_definitions/authentication_steps.rb:27</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    And I fill in &quot;Email&quot; with &quot;user@example.com&quot;                             # features/step_definitions/authentication_steps.rb:41</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    And I fill in &quot;Password&quot; with &quot;password&quot;                                  # features/step_definitions/authentication_steps.rb:41</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    And I click &quot;Log in&quot;                                                      # features/step_definitions/authentication_steps.rb:1</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    And I should see &quot;Signed in as user@example.com&quot; in the navigation bar    # features/step_definitions/authentication_steps.rb:53</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    And I should see a &quot;Logout&quot; button                                        # features/step_definitions/authentication_steps.rb:13</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">1 scenario (1 passed)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">7 steps (7 passed)</span></span></code></pre>\n<p class=\"markdown-para\">Just like with RSpec system tests, Capybara starts a Rails server for each test run, so the scenarios interact with a running application.</p>\n<h2 class=\"markdown-subtitle\" id=\"more-complex-feature\" style=\"position:relative;\"><a href=\"#more-complex-feature\" aria-label=\"more complex feature permalink\" class=\"markdown-header-link before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>More Complex Feature</h2>\n<p class=\"markdown-para\">Now that we've seen a simple scenario, let's cover something a little more involved. After a user logs in, they're presented with a listing of books:</p>\n<p class=\"markdown-para\"><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 147%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAdCAYAAACqhkzFAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFR0lEQVR42nVUW28TVxDelyQ0CVL7UihJRAz0okoFByiFRhAqLkGqeIE4QC9IGFr1T6A+0Kda4qkP/SlFgaRcS5EgmISY2PHdsdeX3fXa3vueneo7u3YIBVujszt7zpyZb75vBEEYHvzs47Hrn3+68+bJA1/GJo9NxQ4d+iq2f/+B2O49e2Ijo6Ox0bExbnju2o6RkdhHIzuw/j6yffvNPbt2Xd+5e/eQ8P4H23Z+c2zSOX3yOJ09dZq+PXuWpqenaWpqiiYmJuiLvXtpb2D79u2jcDhMBw4epKOHj9Dxo8fo8OQkHTl1ir4+ccIe+3BbSLh06bvxBw/vS48e/0v3H/3j3L3/wH367JmbWku5yVSyZ3iPv3jhLsbjvi0+d+MrCfflg4fOWvQXWvz1RuPCn3+EhB8vXx5vqqpiu4xc5jGXeR4RvdPYmz7bYfT0ObUX4/LPv90ICefOnR9vNBRF0w3K5AosWyhSobROLnOpo+mUSmcplclSYjVFtYZEuC+TL1A6l6eXr5JUEquMEZGotuUr3/8QEmYikfGGpCi6adF6RWRirU6KqhLzGJmWRZVqjcpijQfTTYNcl3GfrDSpLsmk6TrzGKNarSFHr14LCZHZ2fF6Q1Zs16W2pjHLsckjjwe0bIdnaVgmf0eFjuuS3FRJbbXJdmyOArKuN2Q5Gr0aEiKRWV6y7bhk2TazbBsrGaZFpmWTyxg3BHL4HodnbjsO99mOwxzXD3glGg0J58/PjEtyU+noBmXzBbaWzVGz1eIZISjwyuQKpLZavSDrFZHS2TylMjmSFIWhO7W6JEd5wJmNgGWxyiSlyTHEYdO2qbBepuJ6hRqyQh1NCwJWKV9cp2q9Qa12u1cyzzASNAWlKKrKdNPkGHqcEQ4v32cSBSzh0HAYgt9bMJR8DNsdjbU1DZ3jh4BhR9fhJ90wgwv8RsGH1bRscHcjw5kZP0PglS+WWDZfpFK5QqZtcQwLpTLHCxRBno7LOAzZfIGXzWnTw/DqRkBkU67WGHBRmir53XYIvIShUSA7SsUecBG4IiAvuS77TemWjJsNy2JdbLAJlwBTNIICreGSLqV87XkMZ30Mu10OSl7L5hgokiuUSFFb/FCxXKFsocR9ZbHKmwJpgjqAoy5Jm0t+nYfx5RUG7UqKQpqh+wHXK5QrlqhUFkluNjmG4CaeYaZlvoFhQBvDsqnV6TDdMDjfgCGyaXU6BJ8vPepJD9putTsbtKnLmwMCG0luctrgMDaBJt5rf/hxCS7AhYHvXTxk2MigU8M0e11GU2CaYfC1q2XwEiNP041eUzZrWdNpObHKVlZTtLTyissPQZNrGVpOJCmZzpKsKL15iFm4nFhFgxhA3CB2ULJpO+AXAweRAbBCQGAFfeOZAmJjPqJJUJSPIZoSlDwbzEN4Pc/rCdTzPF7eho6JExu4Qo4o2cea9aQXfV16oEg3Qyih2WrzgFADuoosfT27fLjiO76prfZmLXfHFzZn8gUGnWLOgWMIiPd8scR9kB8yB8HhA5Zirb55HiJDRIdSxFrdRfW6aQAAZpgWtM3qkszUdpvZjs0woeETaw2GWei4jsv1XWtIPMMLFy+G1FZH6+r3zR/7v+utvqba7ly79tMuYfrMmdHn8aWXyyuJxtz8QmXuzoIIiy8tia9Wk+L83/fEufkF8dbtefHxkydiOp0WF+7eE2/dviP+NXdHXEkkKmvpdOPZYnw5EomMCYIg9AmC8MmWLVsmhoeGwsPDvg0MDIT7+/vDQ4Fv69bh8ODge+G+vr7w4OCg7xseDg8M9MMmEAOx/gN2Y2U2x8F2ZQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"cucumber book review demo app book listing\"\n        title=\"cucumber book review demo app book listing\"\n        src=\"/static/5565f6ee373d6f0f32476db97524eab2/5a190/cucumber-book-review-demo-app-book-listing.png\"\n        srcset=\"/static/5565f6ee373d6f0f32476db97524eab2/772e8/cucumber-book-review-demo-app-book-listing.png 200w,\n/static/5565f6ee373d6f0f32476db97524eab2/e17e5/cucumber-book-review-demo-app-book-listing.png 400w,\n/static/5565f6ee373d6f0f32476db97524eab2/5a190/cucumber-book-review-demo-app-book-listing.png 800w,\n/static/5565f6ee373d6f0f32476db97524eab2/dd104/cucumber-book-review-demo-app-book-listing.png 1064w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p class=\"markdown-para\">The user can click on any of them to view the reviews that have been left for this book, and they also are presented with a form to leave their own review:</p>\n<p class=\"markdown-para\"><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 147%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAdCAYAAACqhkzFAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEL0lEQVR42pVUyW8bVRyeS+KwHOBCS5ModsImpDruktISaAtJWhWUU+M0VVuJpMt/UQ7lhqXeOHBA4ojEBY49cCBtKGKJnYh47HGWkrbZPItnX95786E3XrI5IZ2nT7+ZJ71vvu+3PEEQXn35vbc7777/btf9wRN9mf5z5zKnTn2QOXb8eKa7pyfT3tGR6ejsjMDf6zjS3p55s/0Ij1+3Hz58/63u7rtdPT2vCK+9fqjrk7P9ZGjwPIaHLuDz4WFcvHARAwOD6Ovrw9GjR5FM9iKZTCLZ24tUKoUTJ0/io9NncP7jszjd348zQ4P48NOBoPONQwnh6tVr8YdTk8rU498x+dtj8uvkQ/r39DQtzZeoVJKiyDG/ME9nZmdpNpejuZkZms3m6Iwo0rlHU2Rh/A6yX96Tr3z7TUK4fuNGXNcNjVAGyhgjjIUA9kRYAwsRMr7nBwzTszBzs+qdr+4lhMuXR+JlWdF8P4SqBExRAiiKD9v1YDseHNdvwPWCXXB8wnwA64apfnHtekJIp0fjsqJqAQlh2yHzPMB1AVaTRCgXQeAHtDl8wkhAUS7L6vjNW5wwHS/LqkZZiJXVZ6woFbCwWIJUkpAX81BUBfxhIdsLjJ8ty6o6MXFzk5BnbmHpCfvjr2mIBQkFqYTnK89hO3ZEGIIhbLKaEI42FKoVnZUVDZpuwOHea7Ypq6rhcTco42mpEk7Uc6hpfDOspi56+A88P6jlb180CMfrhHXLy0+XWVEqQhRFmJbZyF24z9rHMqBVKmxDlqO8EUr2K0QD3PJ2wtHRuCyrkWX+t8h4lLvwwITbLe8gRI0oPODaTbilyp4fMN79hLBGZV9E4URdYYOQGIyBF4NFiOZ7z3aJyBBQsiWHWxRy+bk/CXvwM8GDnwKsrdCI9P+U7irKSI2Q5+7RLwH74TsPP37v4+kT2lD5wpZ5Y/PLAWC1xuZFqQ5/QPbHno3NZS8/W2VFaRG27UbNU1WxrYkPcjlsTkp5fZEtLc6hrKhwXHfX4R0TAstx4Hhu86LwSbGtDabrazAsCxXDgKpVYJgmNF1HRdcREHJwhXzTsEzG66NqGiybj1+AgGyCjyOPfuDD8z3ohsHHlHExTXII6OoSK8sb4KQV3YBumjAtC6Ztw3Ls6Nv1vIZlP4h+tJflELYbMN20udKISDeNxrtpW5F9fnHUFXI0IUzHN8qKSiiga//S8lqeyarKLMdh1fxUF6HVWLtAonfTspntOJT36kZZUcbHJxLC2NhYQjes6J73PB2GsR5V2HZdWLYT2bUdF7bjRMVitdto51PRTevW7dvdwqVLn3Vkc7NzRakkiwVpNV8oreXFQlOIPObFtbktyIvialGal7PZmX9G0ulOQRCEFkEQ3mltjR1rbWlJxVpbUrFYW1O0xmJRbGt7KdXWVo18j5/lHJzrPzsifAwZYSeXAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"cucumber book review demo app book details and new review form\"\n        title=\"cucumber book review demo app book details and new review form\"\n        src=\"/static/d1a4e52131bb8be47976ba6cca2bf7be/5a190/cucumber-book-review-demo-app-book-details-and-new-review-form.png\"\n        srcset=\"/static/d1a4e52131bb8be47976ba6cca2bf7be/772e8/cucumber-book-review-demo-app-book-details-and-new-review-form.png 200w,\n/static/d1a4e52131bb8be47976ba6cca2bf7be/e17e5/cucumber-book-review-demo-app-book-details-and-new-review-form.png 400w,\n/static/d1a4e52131bb8be47976ba6cca2bf7be/5a190/cucumber-book-review-demo-app-book-details-and-new-review-form.png 800w,\n/static/d1a4e52131bb8be47976ba6cca2bf7be/dd104/cucumber-book-review-demo-app-book-details-and-new-review-form.png 1064w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p class=\"markdown-para\">If they try to submit a review with no review text, an error results:</p>\n<p class=\"markdown-para\"><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 147%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAdCAYAAACqhkzFAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEfklEQVR42o2USU9bVxiGbyuwo7aLdtOkARSGTqoEOANpUto0FRmUqlkFaBIVqZCk6p+IukhXtZpVF1F/RbfdZm4QeMBg8AghFQbb176XO5/znbc61wMB7DTXevTZxz6vv1lRlHfe+vSjntuffXLk7rnjI+HRM1+HT578PHz02LFw/8BAuKu7O9zd0+Mj3zc43NUV/qDrsLS/dR06dPfD/v7bRwYG3lbefe/gkW/OjLIL587i8vkL+O7yZVy8cBFjY2MYGRnB4OAghoaGMTQ0hOHhYYRCIRw/cQJfnjqNs1+dwanRUZw+fx5fjI15Pe8f7FOuXbve+/DR/fLjp//gwZOn7P6Dh3wuEuHpTJqn0infSjLZDI8tLPBINMaj8TiPRmM8nkzyxUePWXbmZ0R+uVP6/t4ffcrU1FRvVdMrHuPwGCOPcyEAgRbIc6pbTkJwee64hLkotudj6k+/3ulTrlwZ7y2W1IrrCVQqHqmqB1V1YdoOTMuBZbtNbMd7CeZby2XkAtjUDfXH6z/0KRMTk72lck3QMIhsG7AsgOpuMS7gegyux1vjMmIeR3GrpE7fuCkFJ3wPOQlsFP6ldCaFXD6LdCaN5ZVllFUV8iFB7SB5t1hS1ZmZGzuCJIBMbpWePJvFYnIZyeUVrL9Yh2EavqAAQbR4tRCcbHqoVjUqqRVUNR2249SFAE4EagMnTjItNcGZRg4rFXkoaqnzH84JjuPJHNVz2Jam4HRDsBHy+ot1SmUzSKZWsG2ZTQ93Q68ZsgDs9XXS5+ahR6OwFxJwF5fgJZfhLiXhJhLga88hNrcgCgWIzU2IjQKEqhIn7A65IYiNDaJoDHwhAW8+AlpJQWRzoEzWR+RXgbXnO+RXpTDJu8XiXkECDE2jarEEbtsgxwa5Lsh7CdfZjePI85dCbhSlpPpF8Tgjj7ifJVkdqmfsVXBBe4oyuSMoBPlVFoJeD8jW4fsFZciMRG05MOa3zCsmYxct+7DR2Katk+PpQD1g2dBc1G1b+P4c+n0IgbW8S0txhuUEg6bxpug+r5reERhnuwXHxyd7i0W1Ilv27788uhd28OfvLnIp7rexvCRaT3Gbxp6srS/mN2Jt9Dj5y/b/Rs7HcduMXm19FWh1bRWu59XmmXZC4y0KUhtF0W7bAFvFAq09X0VF0+AxD3ufPTMMy7Zhu07rosiIDS1PaikLtar7opquwzBNaNvb0A1DFmCXh/JPZau1FiTIi7RVKqNcqTTFTNvyrWGZdQEPruf6yHPb2efhRO9WsazKxFbLeb5Z3JSiVNU0MkyTDMsk07LIsm3SDYOkAPnjxvwz27E544StYrk8PT3Tp1y9erVP0w1/+THO/U3tuK6PWctR87PMmccZWj1Vbdu4eetWv3Lp0rfdkWh8MZXOlGLx2Maz2dnC7Nx8YXFpqZDP5wrZXLZJLl+zmWymkEqnCtFYvLCQSGzIu/ORWGJ8YqJHURSlU1GUjwPB4NFg4M3QgeAboQMHgqFAIBDq6OjYR2dnZygQ6PS/l78LBn2OSg2p9R/jDHduo7n1TQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"cucumber book review demo app new review validation error\"\n        title=\"cucumber book review demo app new review validation error\"\n        src=\"/static/ea4a0bbb697ff50ef613dbf37ae35403/5a190/cucumber-book-review-demo-app-new-review-validation-error.png\"\n        srcset=\"/static/ea4a0bbb697ff50ef613dbf37ae35403/772e8/cucumber-book-review-demo-app-new-review-validation-error.png 200w,\n/static/ea4a0bbb697ff50ef613dbf37ae35403/e17e5/cucumber-book-review-demo-app-new-review-validation-error.png 400w,\n/static/ea4a0bbb697ff50ef613dbf37ae35403/5a190/cucumber-book-review-demo-app-new-review-validation-error.png 800w,\n/static/ea4a0bbb697ff50ef613dbf37ae35403/dd104/cucumber-book-review-demo-app-new-review-validation-error.png 1064w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p class=\"markdown-para\">After correcting the error by providing some review text, they can then submit the review successfully, at which point it displays at the top of the review list as \"You\". The user can now also edit their review:</p>\n<p class=\"markdown-para\"><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 147%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAdCAYAAACqhkzFAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEh0lEQVR42o2UXW8UVRjHp0Kr0pLojSBtQ7f1LUba5aWIoIgpxaAhxqStYMCkCyR+CeIFXrEGb7zAb2DijbfeGWkVKel228KW7m5LbSntztvO7HZm55zznL85M2zZvlFn8s9z5syZ3zxv52ia1rTrnTdbr7379v6bpw93J0+c/Dh59Oj7yYOHDiXbOzqSzS0tyZbW1lBqXNW+5ubk6837lL3RvHfvzTfa26/t7+ho1F55dc/+T06e4L2nT+Fc7xl8fu4czpz5FD09p9Hd3Y33DhxAZ2cXOjs70dnVha54HIePHMGHxz7AqY9O4tjxEzjW24vjPT2s9bU9Me3Cha/bhob/NP+68w+G/r7Dbw8NidFUSuRyWZHNTodWKZ/PifGJCTGWTov0+LhIj6XFxFRGPBge5vnL3yL13XXjq1s/xbSLl75pKzquXWECXiDIC4TkEhLYKDXPKFKFSxlISO4FhJExlFJp6+r312PaF1/2tZmmZT+2JUbynFKPOO7NMIzkA4zNMWQLHNNPldUFcrpYtUoPdaIlCeilknXpwsWY1tc/0GaYlu0zCcfj5Pocri/grAi4nkDJ31xu1Xqc/IqArhvWYOJKTOvri4ABkzB1TkaBKQvGOIIgUjjeSgEnISR0w7IGE4mY1h96aNuMS1QCQSQBLiQERYlUlnHxPBGvBfb197fphmWrD7O5LA0N38ZoahQj9+7h7shdLBeWoC6SBLnJTZJIfauAicTlyEMFVJ7Nzs3T+P0M8rNzmH+8iBVvBVzwTUE1yI1AlUPlNhfRSwWPvFJzYpuQ+dqQQ6ARAd1SmRzXhV0soug4arH6SQh9jtYDn+VwfmGe8jMzmJmdweyjWXDBqmFtHfCGHA48y6FbKtHC4iIqQWW1ENtJkCC+Ckw8A0Y55BSwAIyzp1WlbQoSebg25AGVQzsESkhCuHHl//Ju1cP1Ranm0C2XyS2VIYhCbQskEQLFZiGrST9YoYCr/KlQw8VbS3kHgEGuLYray7pu2SrQ339j9PMPDLduMGQzIgw+2oI1d5hbQPoeRPJH8F9+JbVSLxhWYjBRu1Mk5ucETU0KPBjnsCwB5YNq3g29RwQeBGDjk2D5GeIKqJu1h0O1yj5x8gDwNbD1u4OH8wQehoyaolxe29iP5hYoM/UQnu8jqvaWB0JUEMGVNj8cBAEV7wkBVdjmt7rUgbHieaG8ir8KXNc2gOMYtKwXwoWquZ8nBX1q17VNFSgBp/iYCsuz0E0LpXI5/KhWtW2jnt1SSf2clDNrDoeCbloqsU5xUeiFf8kuOmTaNi3rBlm2TQXDJN00ya/4xDhT2zO0yjsuuGCCUNBNc1C1zfnz52OOW14Jc0MSXoXBD4LwLNzuYoKvris6pfKVq1fbtbNnP2tJjaXvT2fzxmT6jyfpdGopPTG59CCTWcrmshuUy+dCqbFak5maejKdzRmjqfRkX39/q6ZpWr2maW81NDQcfPGlxvjupqb47qbGeENDQ7yuri6+Y8eOUHV1L8Q1rS6+c+fOeH19ffi+qakxvmvXy2p8UDEU6z9xhHitSC/3JwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"cucumber book review demo app review submit success\"\n        title=\"cucumber book review demo app review submit success\"\n        src=\"/static/f82c5752c6e767c4fc75d8579817707d/5a190/cucumer-book-review-demo-app-review-submitted-success.png\"\n        srcset=\"/static/f82c5752c6e767c4fc75d8579817707d/772e8/cucumer-book-review-demo-app-review-submitted-success.png 200w,\n/static/f82c5752c6e767c4fc75d8579817707d/e17e5/cucumer-book-review-demo-app-review-submitted-success.png 400w,\n/static/f82c5752c6e767c4fc75d8579817707d/5a190/cucumer-book-review-demo-app-review-submitted-success.png 800w,\n/static/f82c5752c6e767c4fc75d8579817707d/dd104/cucumer-book-review-demo-app-review-submitted-success.png 1064w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<aside class=\"markdown-aside\">\nIn a real app, reviews would undergo content moderation before publishing, and users would be able to choose a display name instead of showing their email publicly. These details are omitted here to keep the demo simple.\n</aside>\n<p class=\"markdown-para\">To test this, we'll need a few books, users, and reviews setup in the test database. Recall in our first test, some data was created like this:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"gherkin\" data-index=\"15\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># features/authentication.feature</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">Feature</span><span class=\"mtk1\">:</span><span class=\"mtk6\"> User authentication</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">Scenario</span><span class=\"mtk1\">:</span><span class=\"mtk6\"> User logs in with valid credentials</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">Given </span><span class=\"mtk1\">a user exists with email </span><span class=\"mtk6\">&quot;user@example.com&quot;</span><span class=\"mtk1\"> and password </span><span class=\"mtk6\">&quot;password&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    ...</span></span></span></code></pre>\n<p class=\"markdown-para\">While we could write many individual steps like this, Cucumber offers a more powerful feature called <a href=\"https://www.jakubsobolewski.com/cucumber/articles/reference-gherkin.html#data-tables\" class=\"markdown-link\">Data Tables</a> to pass lists of values to a single step. For example:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"gherkin\" data-index=\"16\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># features/book_reviews.feature</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">Feature</span><span class=\"mtk1\">:</span><span class=\"mtk6\"> Book reviews</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">Background</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">Given </span><span class=\"mtk1\">the following books exist:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">      | Title      | Author   | Published Year |</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">      | Book One   | Author A | 2001           |</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">      | Book Two   | Author B | 2002           |</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">And </span><span class=\"mtk1\">users exist:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">      | Email             | Password  |</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">      | user1@example.com | password1 |</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">      | user2@example.com | password2 |</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">And </span><span class=\"mtk1\">the following reviews exist:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">      | Book     | User Email        | Rating | Body       |</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">      | Book One | user2@example.com | 4      | Good read. |</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">And </span><span class=\"mtk1\">I am signed in as </span><span class=\"mtk6\">&quot;user1@example.com&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">  # All scenarios depend on the same data setup in Background</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">Scenario</span><span class=\"mtk1\">:</span><span class=\"mtk6\"> User adds a review</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    ...</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">Scenario</span><span class=\"mtk1\">:</span><span class=\"mtk6\"> User edits their review</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    ...</span></span></span></code></pre>\n<p class=\"markdown-para\">Focusing on the first <code>Background</code> step:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"gherkin\" data-index=\"17\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># features/book_reviews.feature</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">Feature</span><span class=\"mtk1\">:</span><span class=\"mtk6\"> Book reviews</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">Background</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">Given </span><span class=\"mtk1\">the following books exist:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">      | Title      | Author   | Published Year |</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">      | Book One   | Author A | 2001           |</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">      | Book Two   | Author B | 2002           |</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">    # ...</span></span></span></code></pre>\n<p class=\"markdown-para\">The corresponding step definition is as follows:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"ruby\" data-index=\"18\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># features/step_definitions/book_steps.rb</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">Given(</span><span class=\"mtk6\">&quot;the following books exist:&quot;</span><span class=\"mtk1\">) </span><span class=\"mtk7\">do</span><span class=\"mtk1\"> |table|</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  table.</span><span class=\"mtk5\">hashes</span><span class=\"mtk1\">.</span><span class=\"mtk5\">each</span><span class=\"mtk1\"> </span><span class=\"mtk7\">do</span><span class=\"mtk1\"> |row|</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk5\">create</span><span class=\"mtk1\">(</span><span class=\"mtk4\">:book</span><span class=\"mtk1\">, </span><span class=\"mtk4\">title:</span><span class=\"mtk1\"> row[</span><span class=\"mtk6\">&quot;Title&quot;</span><span class=\"mtk1\">], </span><span class=\"mtk4\">author:</span><span class=\"mtk1\"> row[</span><span class=\"mtk6\">&quot;Author&quot;</span><span class=\"mtk1\">], </span><span class=\"mtk4\">published_year:</span><span class=\"mtk1\"> row[</span><span class=\"mtk6\">&quot;Published Year&quot;</span><span class=\"mtk1\">])</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">end</span></span></span></code></pre>\n<p class=\"markdown-para\">Rather than passing a single value like a <code>{string}</code> or <code>{int}</code> into the step, we are making use of Cucumber's <a href=\"https://cucumber.io/docs/cucumber/data-tables/\" class=\"markdown-link\">data tables</a>, which let you pass structured lists or records directly from your <code>.feature</code> files into your step definitions. When you write a step with a table, Cucumber automatically parses it and passes it as a <a href=\"https://www.rubydoc.info/gems/cucumber/Cucumber/MultilineArgument/DataTable\" class=\"markdown-link\">Cucumber::MultilineArgument::DataTable</a> object to your Ruby block. You can then use methods like <a href=\"https://www.rubydoc.info/gems/cucumber/Cucumber/MultilineArgument/DataTable#hashes-instance_method\" class=\"markdown-link\">hashes</a> to iterate over each row as a hash, making it easy to create multiple records or set up complex test data in a single, readable step.</p>\n<p class=\"markdown-para\"><strong class=\"markdown-strong\">Why use data tables?</strong></p>\n<ul class=\"markdown-list-unordered\">\n<li class=\"markdown-list-item\"><strong class=\"markdown-strong\">Clarity:</strong> Test data is visible right in the scenario, not hidden in Ruby code.</li>\n<li class=\"markdown-list-item\"><strong class=\"markdown-strong\">Maintainability:</strong> Adding or changing test cases is as simple as editing the table.</li>\n<li class=\"markdown-list-item\"><strong class=\"markdown-strong\">Reusability:</strong> Step definitions can handle any number of rows, so you don't need to write repetitive steps.</li>\n</ul>\n<p class=\"markdown-para\">The <code>users exist</code> step follows the same pattern:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"ruby\" data-index=\"19\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">Given(</span><span class=\"mtk6\">&#39;users exist:&#39;</span><span class=\"mtk1\">) </span><span class=\"mtk7\">do</span><span class=\"mtk1\"> |table|</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  table.</span><span class=\"mtk5\">hashes</span><span class=\"mtk1\">.</span><span class=\"mtk5\">each</span><span class=\"mtk1\"> </span><span class=\"mtk7\">do</span><span class=\"mtk1\"> |row|</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk5\">create</span><span class=\"mtk1\">(</span><span class=\"mtk4\">:user</span><span class=\"mtk1\">, </span><span class=\"mtk4\">email:</span><span class=\"mtk1\"> row[</span><span class=\"mtk6\">&#39;Email&#39;</span><span class=\"mtk1\">], </span><span class=\"mtk4\">password:</span><span class=\"mtk1\"> row[</span><span class=\"mtk6\">&#39;Password&#39;</span><span class=\"mtk1\">])</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">end</span></span></span></code></pre>\n<p class=\"markdown-para\">The <code>the following reviews exist</code> step is similar, but since a Review is an association between a User and a Book, it uses the book title and user email to find the corresponding records:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"ruby\" data-index=\"20\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">Given(</span><span class=\"mtk6\">&quot;the following reviews exist:&quot;</span><span class=\"mtk1\">) </span><span class=\"mtk7\">do</span><span class=\"mtk1\"> |table|</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  table.</span><span class=\"mtk5\">hashes</span><span class=\"mtk1\">.</span><span class=\"mtk5\">each</span><span class=\"mtk1\"> </span><span class=\"mtk7\">do</span><span class=\"mtk1\"> |row|</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    book </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> </span><span class=\"mtk9 mtki\">Book</span><span class=\"mtk1\">.</span><span class=\"mtk5\">find_by</span><span class=\"mtk1\">(</span><span class=\"mtk4\">title:</span><span class=\"mtk1\"> row[</span><span class=\"mtk6\">&quot;Book&quot;</span><span class=\"mtk1\">])</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    user </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> </span><span class=\"mtk9 mtki\">User</span><span class=\"mtk1\">.</span><span class=\"mtk5\">find_by</span><span class=\"mtk1\">(</span><span class=\"mtk4\">email:</span><span class=\"mtk1\"> row[</span><span class=\"mtk6\">&quot;User Email&quot;</span><span class=\"mtk1\">])</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk5\">create</span><span class=\"mtk1\">(</span><span class=\"mtk4\">:review</span><span class=\"mtk1\">, </span><span class=\"mtk4\">book:</span><span class=\"mtk1\"> book, </span><span class=\"mtk4\">user:</span><span class=\"mtk1\"> user, </span><span class=\"mtk4\">rating:</span><span class=\"mtk1\"> row[</span><span class=\"mtk6\">&quot;Rating&quot;</span><span class=\"mtk1\">], </span><span class=\"mtk4\">body:</span><span class=\"mtk1\"> row[</span><span class=\"mtk6\">&quot;Body&quot;</span><span class=\"mtk1\">])</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">end</span></span></span></code></pre>\n<p class=\"markdown-para\">The last background step is to ensure a user is signed in that doesn't have a review on the book, so we can test the new review feature:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"gherkin\" data-index=\"21\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># features/book_reviews.feature</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">Feature</span><span class=\"mtk1\">:</span><span class=\"mtk6\"> Book reviews</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">Background</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">  # data creation...</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">And </span><span class=\"mtk1\">I am signed in as </span><span class=\"mtk6\">&quot;user1@example.com&quot;</span></span></span></code></pre>\n<p class=\"markdown-para\">Rather than performing the UI navigation and form filling to log in, we can accomplish this faster with the <a href=\"../sustainable-feature-testing-in-rails-with-cucuber#devise-and-warden-for-fast-login\" class=\"markdown-link\">Warden helper</a> we configured earlier:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"ruby\" data-index=\"22\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># features/step_definitions/authentication_steps.rb</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">Given(</span><span class=\"mtk6\">&quot;I am signed in as {string}&quot;</span><span class=\"mtk1\">) </span><span class=\"mtk7\">do</span><span class=\"mtk1\"> |email|</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  user </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> </span><span class=\"mtk9 mtki\">User</span><span class=\"mtk1\">.</span><span class=\"mtk5\">find_by</span><span class=\"mtk1\">(</span><span class=\"mtk4\">email:</span><span class=\"mtk1\"> email)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk5\">login_as</span><span class=\"mtk1\">(user, </span><span class=\"mtk4\">scope:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">:user</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">end</span></span></span></code></pre>\n<p class=\"markdown-para\">Now we can write the step definitions for the scenario:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"gherkin\" data-index=\"23\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># features/book_reviews.feature</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">Feature</span><span class=\"mtk1\">:</span><span class=\"mtk6\"> Book reviews</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">Background</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">    # data creation...</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">And </span><span class=\"mtk1\">I am signed in as </span><span class=\"mtk6\">&quot;user1@example.com&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">Scenario</span><span class=\"mtk1\">:</span><span class=\"mtk6\"> User adds a review</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">When </span><span class=\"mtk1\">I visit the book show page for </span><span class=\"mtk6\">&quot;Book One&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">And </span><span class=\"mtk1\">I enter a review with body </span><span class=\"mtk6\">&quot;&quot;</span><span class=\"mtk1\"> and rating 5</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">And </span><span class=\"mtk1\">I click </span><span class=\"mtk6\">&quot;Submit Review&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">Then </span><span class=\"mtk1\">I should see the following form validation messages:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">      | There were some problems with your submission: |</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">      | Body can&#39;t be blank                            |</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">And </span><span class=\"mtk1\">I enter a review with body </span><span class=\"mtk6\">&quot;Amazing!&quot;</span><span class=\"mtk1\"> and rating 5</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">And </span><span class=\"mtk1\">I click </span><span class=\"mtk6\">&quot;Submit Review&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">Then </span><span class=\"mtk1\">I should see </span><span class=\"mtk6\">&quot;Review was successfully created.&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">And </span><span class=\"mtk1\">I should see </span><span class=\"mtk6\">&quot;You&quot;</span><span class=\"mtk1\"> at the top of the reviews list</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">And </span><span class=\"mtk1\">I should see </span><span class=\"mtk6\">&quot;Amazing!&quot;</span><span class=\"mtk1\"> in my review</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">And </span><span class=\"mtk1\">I should see 5 stars for my review</span></span></span></code></pre>\n<p class=\"markdown-para\">The step definition for navigating to a given book details page finds the associated book by the given title, then uses the Rails path helper together with Capybara's <code>visit</code> method to perform the navigation:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"ruby\" data-index=\"24\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># features/step_definitions/review_steps.rb</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">When(</span><span class=\"mtk6\">&quot;I visit the book show page for {string}&quot;</span><span class=\"mtk1\">) </span><span class=\"mtk7\">do</span><span class=\"mtk1\"> |book_title|</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  book </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> </span><span class=\"mtk9 mtki\">Book</span><span class=\"mtk1\">.</span><span class=\"mtk5\">find_by</span><span class=\"mtk1\">(</span><span class=\"mtk4\">title:</span><span class=\"mtk1\"> book_title)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  visit </span><span class=\"mtk5\">book_path</span><span class=\"mtk1\">(book)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">end</span></span></span></code></pre>\n<p class=\"markdown-para\">The step to fill in the review form accepts a string and integer rating, then uses Capybara <code>fill_in</code> and <code>select</code> methods to fill in a text area and select dropdown respectively:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"ruby\" data-index=\"25\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># features/step_definitions/review_steps.rb</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">When(</span><span class=\"mtk6\">&quot;I enter a review with body {string} and rating {int}&quot;</span><span class=\"mtk1\">) </span><span class=\"mtk7\">do</span><span class=\"mtk1\"> |body, rating|</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  fill_in </span><span class=\"mtk6\">&quot;Your Review&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk4\">with:</span><span class=\"mtk1\"> body</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk9\">select</span><span class=\"mtk1\"> rating.</span><span class=\"mtk5\">to_s</span><span class=\"mtk1\">, </span><span class=\"mtk4\">from:</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;Rating (1-5)&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">end</span></span></span></code></pre>\n<p class=\"markdown-para\">Clicking the \"Submit Review\" button can re-use the same step definition we saw earlier for clicking the \"Log in\" button, so this step can be extracted to a common file (more on <a href=\"../sustainable-feature-testing-in-rails-with-cucumber#steps-organization\" class=\"markdown-link\">steps organization</a> later):</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"ruby\" data-index=\"26\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># features/step_definitions/common_steps.rb</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">When(</span><span class=\"mtk6\">&quot;I click {string}&quot;</span><span class=\"mtk1\">) </span><span class=\"mtk7\">do</span><span class=\"mtk1\"> |button|</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  click_button button</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">end</span></span></span></code></pre>\n<p class=\"markdown-para\">The remainder of the scenario steps:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"gherkin\" data-index=\"27\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">Then </span><span class=\"mtk1\">I should see </span><span class=\"mtk6\">&quot;Review was successfully created.&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">And </span><span class=\"mtk1\">I should see </span><span class=\"mtk6\">&quot;You&quot;</span><span class=\"mtk1\"> at the top of the reviews list</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">And </span><span class=\"mtk1\">I should see </span><span class=\"mtk6\">&quot;Amazing!&quot;</span><span class=\"mtk1\"> in my review</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">And </span><span class=\"mtk1\">I should see 5 stars for my review</span></span></span></code></pre>\n<p class=\"markdown-para\">Are implemented as follows:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"ruby\" data-index=\"28\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># Generic verification for text anywhere on the page</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># Optionally could create something more specific for success alerts</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">Then(</span><span class=\"mtk6\">&quot;I should see {string}&quot;</span><span class=\"mtk1\">) </span><span class=\"mtk7\">do</span><span class=\"mtk1\"> |text|</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk5\">expect</span><span class=\"mtk1\">(page).</span><span class=\"mtk5\">to</span><span class=\"mtk1\"> </span><span class=\"mtk5\">have_content</span><span class=\"mtk1\">(text)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># Example of more specific verification using data test ids in the markup</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">Then(</span><span class=\"mtk6\">&quot;I should see </span><span class=\"mtk4\">\\&quot;</span><span class=\"mtk6\">You</span><span class=\"mtk4\">\\&quot;</span><span class=\"mtk6\"> at the top of the reviews list&quot;</span><span class=\"mtk1\">) </span><span class=\"mtk7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  first_item </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> </span><span class=\"mtk5\">all</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;[data-testid=&quot;review-item&quot;]&#39;</span><span class=\"mtk1\">).</span><span class=\"mtk5\">first</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  author </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> first_item.</span><span class=\"mtk5\">find</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;[data-testid=&quot;review-author&quot;]&#39;</span><span class=\"mtk1\">).</span><span class=\"mtk5\">text</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk5\">expect</span><span class=\"mtk1\">(author).</span><span class=\"mtk5\">to</span><span class=\"mtk1\"> </span><span class=\"mtk5\">eq</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;You&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">Then(</span><span class=\"mtk6\">&quot;I should see {string} in my review&quot;</span><span class=\"mtk1\">) </span><span class=\"mtk7\">do</span><span class=\"mtk1\"> |text|</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk3\"># Find the review item where the author is &#39;You&#39;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  my_review </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> </span><span class=\"mtk5\">all</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;[data-testid=&quot;review-item&quot;]&#39;</span><span class=\"mtk1\">).</span><span class=\"mtk5\">find</span><span class=\"mtk1\"> </span><span class=\"mtk7\">do</span><span class=\"mtk1\"> |item|</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    item.</span><span class=\"mtk5\">find</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;[data-testid=&quot;review-author&quot;]&#39;</span><span class=\"mtk1\">).</span><span class=\"mtk5\">text</span><span class=\"mtk1\"> </span><span class=\"mtk7\">==</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;You&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk5\">expect</span><span class=\"mtk1\">(my_review).</span><span class=\"mtk5\">not_to</span><span class=\"mtk1\"> be_nil</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk5\">expect</span><span class=\"mtk1\">(my_review).</span><span class=\"mtk5\">to</span><span class=\"mtk1\"> </span><span class=\"mtk5\">have_content</span><span class=\"mtk1\">(text)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">Then(</span><span class=\"mtk6\">&quot;I should see {int} stars for my review&quot;</span><span class=\"mtk1\">) </span><span class=\"mtk7\">do</span><span class=\"mtk1\"> |count|</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk3\"># Find the first review item where the author is &#39;You&#39;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  my_review </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> </span><span class=\"mtk5\">all</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;[data-testid=&quot;review-item&quot;]&#39;</span><span class=\"mtk1\">).</span><span class=\"mtk5\">find</span><span class=\"mtk1\"> </span><span class=\"mtk7\">do</span><span class=\"mtk1\"> |item|</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    item.</span><span class=\"mtk5\">find</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;[data-testid=&quot;review-author&quot;]&#39;</span><span class=\"mtk1\">).</span><span class=\"mtk5\">text</span><span class=\"mtk1\"> </span><span class=\"mtk7\">==</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;You&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk5\">expect</span><span class=\"mtk1\">(my_review).</span><span class=\"mtk5\">not_to</span><span class=\"mtk1\"> be_nil</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk3\"># Given that the stars in the rating are implemented with svg</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk5\">expect</span><span class=\"mtk1\">(my_review.</span><span class=\"mtk5\">find</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;[data-testid=&quot;review-rating&quot;]&#39;</span><span class=\"mtk1\">).</span><span class=\"mtk5\">all</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;svg&#39;</span><span class=\"mtk1\">).</span><span class=\"mtk5\">size</span><span class=\"mtk1\">).</span><span class=\"mtk5\">to</span><span class=\"mtk1\"> </span><span class=\"mtk5\">eq</span><span class=\"mtk1\">(count)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">end</span></span></span></code></pre>\n<p class=\"markdown-para\">Notice that the last two step definitions both need to find the current user's review. To avoid this duplication, the Capybara gem provides a <a href=\"https://github.com/cucumber/cucumber-ruby/blob/2cf3a61802cc36cbca6bf3eed666b3a4a90f77a3/lib/cucumber/glue/dsl.rb#L58\" class=\"markdown-link\">World</a> method. This can be used to register a module, which then becomes available in the global namespace. We used this earlier when configuring FactoryBot and Warden helper methods.</p>\n<p class=\"markdown-para\">To add our own helper method:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"ruby\" data-index=\"29\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># features/support/review_helpers.rb</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">module</span><span class=\"mtk1\"> </span><span class=\"mtk5 mtku\">ReviewHelpers</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">def</span><span class=\"mtk1\"> </span><span class=\"mtk5\">find_my_review</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk5\">all</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;[data-testid=&quot;review-item&quot;]&#39;</span><span class=\"mtk1\">).</span><span class=\"mtk5\">find</span><span class=\"mtk1\"> </span><span class=\"mtk7\">do</span><span class=\"mtk1\"> |item|</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      item.</span><span class=\"mtk5\">find</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;[data-testid=&quot;review-author&quot;]&#39;</span><span class=\"mtk1\">).</span><span class=\"mtk5\">text</span><span class=\"mtk1\"> </span><span class=\"mtk7\">==</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;You&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">World(ReviewHelpers)</span></span></span></code></pre>\n<p class=\"markdown-para\">Then those two step definitions can use this helper method:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"ruby\" data-index=\"30\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># features/step_definitions/review_steps.rb</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">Then(</span><span class=\"mtk6\">&quot;I should see {string} in my review&quot;</span><span class=\"mtk1\">) </span><span class=\"mtk7\">do</span><span class=\"mtk1\"> |text|</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk3\"># === USE HELPER FROM REVIEW HELPERS MODULE ===</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  my_review </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> find_my_review</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk5\">expect</span><span class=\"mtk1\">(my_review).</span><span class=\"mtk5\">not_to</span><span class=\"mtk1\"> be_nil</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk5\">expect</span><span class=\"mtk1\">(my_review).</span><span class=\"mtk5\">to</span><span class=\"mtk1\"> </span><span class=\"mtk5\">have_content</span><span class=\"mtk1\">(text)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">Then(</span><span class=\"mtk6\">&quot;I should see {int} stars for my review&quot;</span><span class=\"mtk1\">) </span><span class=\"mtk7\">do</span><span class=\"mtk1\"> |count|</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk3\"># === USE HELPER FROM REVIEW HELPERS MODULE ===</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  my_review </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> find_my_review</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk5\">expect</span><span class=\"mtk1\">(my_review).</span><span class=\"mtk5\">not_to</span><span class=\"mtk1\"> be_nil</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk5\">expect</span><span class=\"mtk1\">(my_review.</span><span class=\"mtk5\">find</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;[data-testid=&quot;review-rating&quot;]&#39;</span><span class=\"mtk1\">).</span><span class=\"mtk5\">all</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;svg&#39;</span><span class=\"mtk1\">).</span><span class=\"mtk5\">size</span><span class=\"mtk1\">).</span><span class=\"mtk5\">to</span><span class=\"mtk1\"> </span><span class=\"mtk5\">eq</span><span class=\"mtk1\">(count)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">end</span></span></span></code></pre>\n<p class=\"markdown-para\">Another scenario we would want to test is a user visiting a book details page where they've already left a review. In this case, they have an option to update their review, but they can't create another one. It looks like this:</p>\n<p class=\"markdown-para\"><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 138%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAcCAYAAABh2p9gAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEUElEQVR42p1U7U9bVRy+iSQa/eIS42COl64UOkagyYTYYZi5m//CHJj4RUfLRxFWR1HoZ2NiNCa+jFFatR/2Z7jsBTX4lkwMG29DaO89995Ce9/O+Z2fObctLaOAsTdPzrkn9zz9Pc/vRZJeaGzo7wq81h3yX36zNyTLly7Jgxcvyn39/fL586/KZ7u65I7OTg+Bzg65PRCQW/1n5Ja2NvmM3y/7fD7Z39Z2uae7O9weDDZIDc+/6Ovt8Cvnetrxjd4QDgy8juFwGEOhEPb09OLp5mY82diIjU1N2NTUhKdOvYJtra3o8/mwubkFm1tb8XS7Hzu6zmkvnTjRIl0Ih4Nj4x+QePxjjMXj8OGNGzw+NcUTiQSfSSR4LBbj4xPjfGJigr8/NsYnrl/n05Nxnpie4ZNTH/GZeBym330PYyMRo2fgQkCKxWLBjY1VlegGKkSDHNF4frfAEfEALMfhjkt50bL5bqHAiwCcPV4FHJ/E3a9n9XeSNwPSSCQSzCmEAEd0KQWXMbGiZbtoO663VmA71IPjllB6d7lLAbM51bg6NBSQIpHRYE5RSNHkmMu6sPWPg6pSJauQHAbLppwyjjmFGEOCMBodDWZzKhGHLuUiUGRQ0ojeXpyzo8DZHuFwVbLjuvjHn7/DnTs/4q+/LeKDhQW8/+A+ZnNZjxg4IK/zAAcvCo9weFhIjnqElAE+WlmD5ZVVXNt4gptb22haJlJG6xLtp6wlLEsW0ohuANHzaOzsou04CJwjA0DK2FHg4u6e5GgNIWUgODzf4Hjvqh5CXQ8pLv29BCurK/jwr4e4/GgZGbCKrP8uuRKhOMwqCmxsbqJlW553glAkgx0FYFXCWsmiTIpWEYy8gbZj72X2KIj4SoR1PPTMQ4Ry+R1aJjVCjyNE0RkgOoRS8LJbkVsvOu9c2EJdDnBIhEVbA47F8izYT1rHO08OReSsNikjI6KXVeK6iIsLDvx8j+JPdynu5Nk+0gMQcn9ZRPfuPc5cF3OqZgy9dTUgXbs2GlRUlZgmxx++deCrT2z85lMHtzaPI0Sks/NIP/uSg2VjjujG0JUrASk6WvWwmhRBJEZUqXjFehAUHUQBTqFOL4uLq2vrsL7+xBtdwtPjSoYDIH+6DiPRynBguL29CZpOajrk8Ef0umlZaNrW070cCWZzhAiJhfwyWNZOqZePKWox7hzXEdhfh7XTxtgxgWgGLxQL3LJt7rg2tx2xOh7EvgLxbloWt2wLyoR6OcKoiFARMnV1iRJ1gxE9z4qmyYADY8A8UBBzmYvUe6uAaVniO1qWTCqFfVZRNVPkVte3kGg5zO/som4YqGoaGvk8El1HzTA8ieKPK4OjNDyYVxcq0Z3h4bc7pMHBwZM3Z299nk5/dzuV/j6TSqUz86n5TCqVyqTSqUxK7NOlfXI+mUkmq5hLznlrKp2+PXtr7ou+vr6XpfKvQZKk5yRJevZ/Qtx9RjD9C2saBEfNL+C5AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"cucumber book review demo app edit review\"\n        title=\"cucumber book review demo app edit review\"\n        src=\"/static/2a44b149567de537a183b609e6bc6a2e/5a190/cucumber-book-review-demo-app-edit-review.png\"\n        srcset=\"/static/2a44b149567de537a183b609e6bc6a2e/772e8/cucumber-book-review-demo-app-edit-review.png 200w,\n/static/2a44b149567de537a183b609e6bc6a2e/e17e5/cucumber-book-review-demo-app-edit-review.png 400w,\n/static/2a44b149567de537a183b609e6bc6a2e/5a190/cucumber-book-review-demo-app-edit-review.png 800w,\n/static/2a44b149567de537a183b609e6bc6a2e/ecf19/cucumber-book-review-demo-app-edit-review.png 948w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p class=\"markdown-para\">That scenario could be written like this:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"gherkin\" data-index=\"31\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">Feature</span><span class=\"mtk1\">:</span><span class=\"mtk6\"> Book reviews</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">Background</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">    # data creation...</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">And </span><span class=\"mtk1\">I am signed in as </span><span class=\"mtk6\">&quot;user1@example.com&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">Scenario</span><span class=\"mtk1\">:</span><span class=\"mtk6\"> User adds a review</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">    # steps we saw earlier...</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">Scenario</span><span class=\"mtk1\">:</span><span class=\"mtk6\"> User edits their review</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">Given </span><span class=\"mtk1\">User </span><span class=\"mtk6\">&quot;user1@example.com&quot;</span><span class=\"mtk1\"> has left a review for </span><span class=\"mtk6\">&quot;Book One&quot;</span><span class=\"mtk1\"> with rating 3 and body </span><span class=\"mtk6\">&quot;It was ok.&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">When </span><span class=\"mtk1\">I visit the book show page for </span><span class=\"mtk6\">&quot;Book One&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">Then </span><span class=\"mtk1\">I should see 3 stars for my review</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">And </span><span class=\"mtk1\">I enter a review with body </span><span class=\"mtk6\">&quot;Actually, I loved it!&quot;</span><span class=\"mtk1\"> and rating 5</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">And </span><span class=\"mtk1\">I click </span><span class=\"mtk6\">&quot;Update Review&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">Then </span><span class=\"mtk1\">I should see </span><span class=\"mtk6\">&quot;Review was successfully updated.&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">And </span><span class=\"mtk1\">I should see </span><span class=\"mtk6\">&quot;Actually, I loved it!&quot;</span><span class=\"mtk1\"> in my review</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">And </span><span class=\"mtk1\">I should see 5 stars for my review</span></span></span></code></pre>\n<p class=\"markdown-para\">The step implementations are similar to what we've already seen. The only point of interest is rather than navigating the UI again to create a new review, that data is created with the <code>Given</code> step:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"ruby\" data-index=\"32\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># features/step_definitions/review_steps.rb</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">Given(</span><span class=\"mtk6\">&quot;User {string} has left a review for {string} with rating {int} and body {string}&quot;</span><span class=\"mtk1\">) </span><span class=\"mtk7\">do</span><span class=\"mtk1\"> |email, book_title, rating, body|</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  book </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> </span><span class=\"mtk9 mtki\">Book</span><span class=\"mtk1\">.</span><span class=\"mtk5\">find_by</span><span class=\"mtk1\">(</span><span class=\"mtk4\">title:</span><span class=\"mtk1\"> book_title)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  user </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> </span><span class=\"mtk9 mtki\">User</span><span class=\"mtk1\">.</span><span class=\"mtk5\">find_by</span><span class=\"mtk1\">(</span><span class=\"mtk4\">email:</span><span class=\"mtk1\"> email)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk5\">create</span><span class=\"mtk1\">(</span><span class=\"mtk4\">:review</span><span class=\"mtk1\">, </span><span class=\"mtk4\">book:</span><span class=\"mtk1\"> book, </span><span class=\"mtk4\">user:</span><span class=\"mtk1\"> user, </span><span class=\"mtk4\">rating:</span><span class=\"mtk1\"> rating, </span><span class=\"mtk4\">body:</span><span class=\"mtk1\"> body)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">end</span></span></span></code></pre>\n<p class=\"markdown-para\">Alternatively the original scenario \"User adds a review\" could be renamed to \"User manages their reviews\", then more steps added showing how a user can at first create a review, edit it, then even delete it.</p>\n<h2 class=\"markdown-subtitle\" id=\"steps-organization\" style=\"position:relative;\"><a href=\"#steps-organization\" aria-label=\"steps organization permalink\" class=\"markdown-header-link before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Steps Organization</h2>\n<p class=\"markdown-para\">You may have noticed from the examples so far, that there were multiple step definition files in the book review demo app:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"\" data-index=\"33\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">features</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">├── authentication.feature</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">├── book_reviews.feature</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">├── other feature files...</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">├── step_definitions</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">│   ├── authentication_steps.rb</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">│   ├── common_steps.rb</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">│   ├── review.rb</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">│   └── other step files...</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">└── support</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    ├── env.rb</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    └── other support files...</span></span></code></pre>\n<p class=\"markdown-para\">How you organize your Cucumber step definitions can make a big difference as your test suite grows. While it's technically possible to keep all your steps in a single file, this quickly becomes unwieldy. A more sustainable approach is to group step definitions by domain concept, such as authentication, books, or reviews, mirroring the main features of your app. For example, in the Book Review Demo, you might have <code>authentication_steps.rb</code> for login-related steps, <code>book_steps.rb</code> for book setup, and <code>review_steps.rb</code> for anything review-related.</p>\n<p class=\"markdown-para\">As you add more features, you'll notice some steps are used across multiple domains, such as clicking buttons or verifying flash messages. These can be extracted into a shared file, such as <code>common_steps.rb</code>. For instance, a generic step like:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"ruby\" data-index=\"34\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">When(</span><span class=\"mtk6\">&quot;I click {string}&quot;</span><span class=\"mtk1\">) </span><span class=\"mtk7\">do</span><span class=\"mtk1\"> |button|</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  click_button button</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">end</span></span></span></code></pre>\n<p class=\"markdown-para\">is applicable to many scenarios.</p>\n<p class=\"markdown-para\">There's a tradeoff between writing very generic steps (like checking for text anywhere on the page) and tightly scoped ones (like checking for a message within a specific DOM selector or data test id). Generic steps are easier to reuse but can lead to false positives, while tightly scoped steps are more robust but may break when the markup changes. For example, instead of:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"ruby\" data-index=\"35\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">Then(</span><span class=\"mtk6\">&quot;I should see {string}&quot;</span><span class=\"mtk1\">) </span><span class=\"mtk7\">do</span><span class=\"mtk1\"> |text|</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk5\">expect</span><span class=\"mtk1\">(page).</span><span class=\"mtk5\">to</span><span class=\"mtk1\"> </span><span class=\"mtk5\">have_content</span><span class=\"mtk1\">(text)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">end</span></span></span></code></pre>\n<p class=\"markdown-para\">you might prefer:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"ruby\" data-index=\"36\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">Then(</span><span class=\"mtk6\">&quot;I should see {string} in the alert&quot;</span><span class=\"mtk1\">) </span><span class=\"mtk7\">do</span><span class=\"mtk1\"> |text|</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk5\">within</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;.alert&quot;</span><span class=\"mtk1\">) { </span><span class=\"mtk5\">expect</span><span class=\"mtk1\">(page).</span><span class=\"mtk5\">to</span><span class=\"mtk1\"> </span><span class=\"mtk5\">have_content</span><span class=\"mtk1\">(text) }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">end</span></span></span></code></pre>\n<p class=\"markdown-para\">See the Cucumber documentation on <a href=\"https://cucumber.io/docs/guides/anti-patterns\" class=\"markdown-link\">Anti Patterns</a> for more information.</p>\n<h2 class=\"markdown-subtitle\" id=\"debugging\" style=\"position:relative;\"><a href=\"#debugging\" aria-label=\"debugging permalink\" class=\"markdown-header-link before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Debugging</h2>\n<p class=\"markdown-para\">Browser tests are great when everything is passing, but when something goes wrong, debugging can be a challenge. Unlike unit or integration tests, these tests involve a real browser and a visual UI. This means it's not enough to read the error message; you need to also inspect what's happening on the page.</p>\n<p class=\"markdown-para\">By default, Capybara runs the tests in headless mode, meaning the browser operates invisibly in the background without displaying any windows. This is fast and convenient for automated runs, but it makes troubleshooting UI issues harder. Fortunately, with a simple environment variable, you can launch the browser in visible mode and watch your tests run.</p>\n<p class=\"markdown-para\">Recall earlier when configuring Cucumber, we added <code>features/support/cuprite.rb</code> with the following:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"ruby\" data-index=\"37\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk9 mtki\">Capybara</span><span class=\"mtk1\">.</span><span class=\"mtk5\">register_driver</span><span class=\"mtk1\">(</span><span class=\"mtk4\">:cuprite</span><span class=\"mtk1\">) </span><span class=\"mtk7\">do</span><span class=\"mtk1\"> |app|</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk9 mtki\">Capybara</span><span class=\"mtk1\">::</span><span class=\"mtk9 mtki\">Cuprite</span><span class=\"mtk1\">::</span><span class=\"mtk9 mtki\">Driver</span><span class=\"mtk1\">.</span><span class=\"mtk7\">new</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    app,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">window_size:</span><span class=\"mtk1\"> [</span><span class=\"mtk4\">1920</span><span class=\"mtk1\">, </span><span class=\"mtk4\">1080</span><span class=\"mtk1\">],</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">js_errors:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">true</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">headless:</span><span class=\"mtk1\"> </span><span class=\"mtk7\">!</span><span class=\"mtk1\">ENV[</span><span class=\"mtk6\">&quot;VISIBLE_BROWSER&quot;</span><span class=\"mtk1\">],</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">timeout:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">10</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">browser_options:</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk6\">&quot;no-sandbox&quot;</span><span class=\"mtk1\"> =&gt; </span><span class=\"mtk4\">nil</span><span class=\"mtk1\"> </span><span class=\"mtk3\"># Required if running in Docker</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  )</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">end</span></span></span></code></pre>\n<p class=\"markdown-para\">This means you can set the <code>VISIBLE_BROWSER</code> environment variable when running the <code>cucumber</code> command. When set, Capybara will launch the browser in visible (non-headless) mode, so you can watch the test as it runs. However, if a failure happens quickly, you might still miss it. The solution is to also add a <code>debugger</code> statement to pause the test right before the failure.</p>\n<p class=\"markdown-para\">For example, suppose the edit scenario is failing in not finding the expected validation messages. The output might look something like this:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"\" data-index=\"38\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"> Scenario: User edits their review                                                                     # features/book_reviews.feature:42</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    ...</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    And I click &quot;Update Review&quot;                                                                         # features/step_definitions/common_steps.rb:1</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    Then I should see the following form validation messages:                                           # features/step_definitions/common_steps.rb:26</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      | There were some problems with your submission: |</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      | Body can&#39;t be blank                            |</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      Unable to find css &quot;[data-testid=\\&quot;form-validation-error\\&quot;]&quot; (Capybara::ElementNotFound)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      ./features/step_definitions/common_steps.rb:27:in &#39;block in &lt;main&gt;&#39;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      features/book_reviews.feature:48:in `I should see the following form validation messages:&#39;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Failing Scenarios:</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">cucumber features/book_reviews.feature:42 # Scenario: User edits their review</span></span></code></pre>\n<p class=\"markdown-para\">To troubleshoot the failing test, we add a <code>debugger</code> statement at the beginning of the failing step definition:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"ruby\" data-index=\"39\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># features/step_definitions/common_steps.rb</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">Then(</span><span class=\"mtk6\">&quot;I should see the following form validation messages:&quot;</span><span class=\"mtk1\">) </span><span class=\"mtk7\">do</span><span class=\"mtk1\"> |table|</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk3\"># === ADD DEBUGGER TO MAKE TEST PAUSE HERE ===</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  debugger</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk5\">within</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;[data-testid=&quot;form-validation-error&quot;]&#39;</span><span class=\"mtk1\">) </span><span class=\"mtk7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    table.</span><span class=\"mtk5\">raw</span><span class=\"mtk1\">.</span><span class=\"mtk5\">flatten</span><span class=\"mtk1\">.</span><span class=\"mtk5\">each</span><span class=\"mtk1\"> </span><span class=\"mtk7\">do</span><span class=\"mtk1\"> |msg|</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk5\">expect</span><span class=\"mtk1\">(page).</span><span class=\"mtk5\">to</span><span class=\"mtk1\"> </span><span class=\"mtk5\">have_content</span><span class=\"mtk1\">(msg)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">end</span></span></span></code></pre>\n<p class=\"markdown-para\">And then run only the failing test, setting the <code>VISIBLE_BROWSER</code> environment variable as follows:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"bash\" data-index=\"40\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">VISIBLE_BROWSER=true bundle </span><span class=\"mtk9\">exec</span><span class=\"mtk1\"> cucumber features/book_reviews.feature</span></span></span></code></pre>\n<p class=\"markdown-para\">When the test runs, you'll see it pause at the <code>debugger</code> line, just like any regular Ruby program:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"\" data-index=\"41\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">    When I visit the book show page for &quot;Book One&quot;                                                      # features/step_definitions/review_steps.rb:21</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    Then I should see 3 stars for my review                                                             # features/step_definitions/review_steps.rb:49</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    And I enter a review with body &quot;&quot; and rating 3                                                      # features/step_definitions/review_steps.rb:26</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    And I click &quot;Update Review&quot;                                                                         # features/step_definitions/common_steps.rb:1</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">[22, 31] in ~/projects/book_review_demo/features/step_definitions/common_steps.rb</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    26| Then(&quot;I should see the following form validation messages:&quot;) do |table|</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">=&gt;  27|   debugger</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    28|   within(&#39;[data-testid=&quot;form-validation-error&quot;]&#39;) do</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    29|     table.raw.flatten.each do |msg|</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    30|       expect(page).to have_content(msg)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    31|     end</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">=&gt;#0\tblock {|table=#&lt;Cucumber::MultilineArgument::DataTable:...|} in &lt;main&gt; at ~/projects/book_review_demo/features/step_definitions/common_steps.rb:27</span></span></code></pre>\n<p class=\"markdown-para\">Also, a new browser will open and you can see exactly what the UI looks like at the point of failure. In this case, we can see that the error is displayed as expected:</p>\n<p class=\"markdown-para\"><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 725px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 126%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAZCAYAAAAxFw7TAAAACXBIWXMAAAsTAAALEwEAmpwYAAACR0lEQVR42q2Ua2/TMBSG8/+/IEDiG3wAiX+BEOKy+0CwK92FbmvTdU3SdG1sHzt+wG7TSqCxrpDoyc3O62Of4zcpR4Y01ZFBptFiUGZ1EmUE60CcxzqPFvknEmU0B4f7nJy2Iq52eDy1rx9E+EecnQqub27z5es3vrdOECuxcZUzChor3GQ5N3lBUY6olHpwdA1iLUmYdziaUUKDNuZPZBkkCBrOLtpcpintTofOdY86DrCgXpLplEUYtI4ZHB3SPzygf7CH7XZwaRcb6Fzh+tf4ssAP7yLHj4ZIiNBagf093PoadmMd+fQR2dlCdneQz7uYrU3c3jc4P4WzkztoQfsc0YokqFadK6r2D1y3g+1ewTCHsoBhAeUwvvtsgM/vILQV+TTCkJlyMmGs9XwtnK9/wxOq8z7iGoZLs/yrlktDKMEo6P/DuRC0lttJRaUM1jlcXT8cZ3FW4i5LrLNUZoijmldU2M/3Uy/ugI116EiUdmx+EDbeC2vvhCJ3M9ElaJK2tY158xZRiuR2bHn5TPPiieL5Y03nciH41yTUbv5sX73GPnqKjMdTc1gcFltPfc0swdwHYUo0B2O4uLgk7fViUlbxQe9rCG7jGsHLNmkvnZurp16qVEJ/pTXa6OhI0b7EalR5HNctOouvl669RrBhKugsWTFiOBqhtKJS1dKE/iG6cDcyj1Ao81OyLCUfjmiSdF90MYW14zb4wKRiPJlMBYNAPz0iy3rxg8SRZHnEzKKTWVKCfWlLpfRsKmoFKqow/V/29RObNZwd6zrJUgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"cucumber book review demo app test browser\"\n        title=\"cucumber book review demo app test browser\"\n        src=\"/static/22dc9d971953cb06aeb366e4f7f768a9/a0209/cucumber-book-review-demo-app-test-browser.png\"\n        srcset=\"/static/22dc9d971953cb06aeb366e4f7f768a9/772e8/cucumber-book-review-demo-app-test-browser.png 200w,\n/static/22dc9d971953cb06aeb366e4f7f768a9/e17e5/cucumber-book-review-demo-app-test-browser.png 400w,\n/static/22dc9d971953cb06aeb366e4f7f768a9/a0209/cucumber-book-review-demo-app-test-browser.png 725w\"\n        sizes=\"(max-width: 725px) 100vw, 725px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p class=\"markdown-para\">So perhaps the problem lies in the css selector. This is a regular browser so you can open the developer tools and inspect elements. And here we see the issue is that the <code>data-testid</code> in the markup is <code>form-validation-errors</code>:</p>\n<p class=\"markdown-para\"><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 10.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAfklEQVR42h3GSRKCMBBAUQ+kSRQLB+iEdBOGAK68/1W+Vb7VO90fgtjBlJWja9jSm4+0zGqUqbKaMpeZZJX4bLmFgPMe5wPBBfrzi8Zd8e6Cc45THIxx+7LVnS0Liym7CtXy/zULdVTWUqiamFLPkI2kBU0Di0TG1GGxp5PID6NnRUhlVxo0AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"cucumber book review demo app test browser dev tools\"\n        title=\"cucumber book review demo app test browser dev tools\"\n        src=\"/static/0ce6d4362aaf754c6874e08c3ec05ba7/5a190/cucumber-book-review-demo-app-test-browser-dev-tools.png\"\n        srcset=\"/static/0ce6d4362aaf754c6874e08c3ec05ba7/772e8/cucumber-book-review-demo-app-test-browser-dev-tools.png 200w,\n/static/0ce6d4362aaf754c6874e08c3ec05ba7/e17e5/cucumber-book-review-demo-app-test-browser-dev-tools.png 400w,\n/static/0ce6d4362aaf754c6874e08c3ec05ba7/5a190/cucumber-book-review-demo-app-test-browser-dev-tools.png 800w,\n/static/0ce6d4362aaf754c6874e08c3ec05ba7/c1b63/cucumber-book-review-demo-app-test-browser-dev-tools.png 1200w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p class=\"markdown-para\">But the step definition is incorrectly looking for a <code>data-testid</code> of \"form-validation-error\" (singular):</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"ruby\" data-index=\"42\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">Then(</span><span class=\"mtk6\">&quot;I should see the following form validation messages:&quot;</span><span class=\"mtk1\">) </span><span class=\"mtk7\">do</span><span class=\"mtk1\"> |table|</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  debugger</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk3\"># === FOUND THE BUG HERE! ===</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk5\">within</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;[data-testid=&quot;form-validation-error&quot;]&#39;</span><span class=\"mtk1\">) </span><span class=\"mtk7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3\"># ...</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">end</span></span></span></code></pre>\n<p class=\"markdown-para\">So we can fix the selector in the test and run again to confirm it passes.</p>\n<h2 class=\"markdown-subtitle\" id=\"screenshot-on-failure\" style=\"position:relative;\"><a href=\"#screenshot-on-failure\" aria-label=\"screenshot on failure permalink\" class=\"markdown-header-link before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Screenshot on Failure</h2>\n<p class=\"markdown-para\">Anytime a test fails, you will almost certainly want to see what the browser looked like at the point of failure. While the debugging steps covered in the previous section can get you there, a more efficient way is to automatically capture a <a href=\"https://cucumber.io/docs/guides/browser-automation/#screenshot-on-failure\" class=\"markdown-link\">screenshot on failure</a>. The Cucumber documentation suggests adding the following code in an <code>After</code> hook, which is placed in a support file:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"ruby\" data-index=\"43\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># features/support/hooks.rb</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">After </span><span class=\"mtk7\">do</span><span class=\"mtk1\"> |scenario|</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">if</span><span class=\"mtk1\"> scenario.</span><span class=\"mtk5\">failed?</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    path </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;html-report/</span><span class=\"mtk7\">#{</span><span class=\"mtk1\">scenario.__id__</span><span class=\"mtk7\">}</span><span class=\"mtk6\">.png&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    page.</span><span class=\"mtk5\">save_screenshot</span><span class=\"mtk1\">(path)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk5\">attach</span><span class=\"mtk1\">(path, </span><span class=\"mtk6\">&#39;image/png&#39;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">end</span></span></span></code></pre>\n<p class=\"markdown-para\">The generated files will be saved at <code>tmp/capybara/html-report/</code>, which should be git ignored. For example <code>tmp/capybara/html-report/12192.png</code>. A problem with this is if you're running an entire suite and multiple tests fail, it will be difficult to associate which screenshot is from which test failure because it's not obvious from the scenario ID.</p>\n<p class=\"markdown-para\">Fortunately Cucumber exposes some details on the <code>scenario</code> object yielded by the <code>After</code> block. We can use these attributes to construct a more meaningful file name for the screenshot:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"ruby\" data-index=\"44\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># features/support/hooks.rb</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">After </span><span class=\"mtk7\">do</span><span class=\"mtk1\"> |scenario|</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">if</span><span class=\"mtk1\"> scenario.</span><span class=\"mtk5\">failed?</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    file, line </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> scenario.</span><span class=\"mtk5\">location</span><span class=\"mtk1\">.</span><span class=\"mtk5\">to_s</span><span class=\"mtk1\">.</span><span class=\"mtk5\">split</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;:&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    feature </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> </span><span class=\"mtk9 mtki\">File</span><span class=\"mtk1\">.</span><span class=\"mtk5\">basename</span><span class=\"mtk1\">(file, </span><span class=\"mtk6\">&quot;.feature&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    scenario_name </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> scenario.</span><span class=\"mtk5\">name</span><span class=\"mtk1\">.</span><span class=\"mtk9\">gsub</span><span class=\"mtk1\">(</span><span class=\"mtk6\">/</span><span class=\"mtk4\">\\W</span><span class=\"mtk6\">+/</span><span class=\"mtk1\">, </span><span class=\"mtk6\">&quot;_&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    path </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;html-report/</span><span class=\"mtk7\">#{</span><span class=\"mtk1\">feature</span><span class=\"mtk7\">}</span><span class=\"mtk6\">_</span><span class=\"mtk7\">#{</span><span class=\"mtk1\">scenario_name</span><span class=\"mtk7\">}</span><span class=\"mtk6\">_line_</span><span class=\"mtk7\">#{</span><span class=\"mtk1\">line</span><span class=\"mtk7\">}</span><span class=\"mtk6\">.png&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    page.</span><span class=\"mtk5\">save_screenshot</span><span class=\"mtk1\">(path)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk5\">attach</span><span class=\"mtk1\">(path, </span><span class=\"mtk6\">&quot;image/png&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">end</span></span></span></code></pre>\n<p class=\"markdown-para\">Now that failing test for a user editing their review would have its screenshot saved as <code>tmp/capybara/html-report/book_reviews_User_edits_their_review_line_42.png</code>.</p>\n<aside class=\"markdown-aside\">\nThe <code>scenario</code> object yielded by the Cucumber <code>After</code> hook is an instance of <a class=\"markdown-link\" href=\"https://github.com/cucumber/cucumber-ruby/blob/main/lib/cucumber/running_test_case.rb\">Cucumber::RunningTestCase::TestCase</a>, which is defined in the <a class=\"markdown-link\" href=\"https://github.com/cucumber/cucumber-ruby/tree/main\">cucumber-ruby</a> gem. The documentation for <code>RunningTestCase</code> state that it wraps <a class=\"markdown-link\" href=\"https://github.com/cucumber/cucumber-ruby-core/blob/main/lib/cucumber/core/test/case.rb\">Cucumber::Core::Test::Case</a>, which is defined in the <a class=\"markdown-link\" href=\"https://github.com/cucumber/cucumber-ruby-core\">cucumber-ruby-core</a> gem. Feel free to peruse the cucumber-ruby and cucumber-ruby-core gems to learn what methods are available for scenarios and other parts of Cucumber.\n</aside>\n<h2 class=\"markdown-subtitle\" id=\"developer-tooling\" style=\"position:relative;\"><a href=\"#developer-tooling\" aria-label=\"developer tooling permalink\" class=\"markdown-header-link before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Developer Tooling</h2>\n<p class=\"markdown-para\">To make working with Cucumber more pleasant, I recommend the <a href=\"https://marketplace.visualstudio.com/items?itemName=CucumberOpen.cucumber-official\" class=\"markdown-link\">Cucumber extension for VSCode</a>. It adds syntax highlighting, step definition navigation (click a step in a feature file to jump to the corresponding step definition), and helpful autocomplete when writing feature files. The screenshot below shows autocomplete in action from the demo project:</p>\n<p class=\"markdown-para\"><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 61%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAACi0lEQVR42l2TWVMaQRSFR01pymzKKoNBFgdkHBYJMAwM6wACyia4m6hRklSe8pDFSuW/f6npWFSSh1Pn3u7qU+f07ZaeyWl8kQprW1k8OwYb8dIcPrWErJp4dwxcio5/t8yrYEbAEcmxHskiORUWXFEWnFHBkkuzCKhNtrItPMkaTtVkI1XDo5WR9xp4k1Xcmr1mc5nVUIaVQJrlRzzxJ1iStT/s15CeR3S8iolidOnfPzD9/Ive7TcO3n9ncP/AYPZA/+6HqO390Yefggezn2S671hTcrjjRdaUPIsbKtKqP4VzS8cd0Rke3XN795Ve/0bgYHDLePqRXv+W4dGM4eQD3cNrxsef6B3eEFErIuaSJ8ai6zHy880MfqWGM5Sj2phyMLimVD2iVBkLbrTOKNemGOYQszYRfbVxjFEaEogaSI9CNhbdMaRlXwJv2BSX39y/YDSZUbVOBFqdS6z9C+rNMyFktS8omEOy+gHJvRbBWEkI2kI2hMMVX4LXsTrhVI3D4Q1X119odd/S7FzSH9/T6l6RN/rCbaV+jGGOMMojsvkeobiJ5FLmgsLhkldldVMjljZEZGv/HLM6oVz/U9eap6K2BW22oZeGFM0RYbUsns0/gnZkV6hAQCvT7lwwnsyoWSdY7XO6h+9EbLuv1KfUrVPe5LokUhbpvTZh4TD6r+BTOUlwp0UwbaFbU4qtE9Jmn2x1jN6YoBW67OY7xHNtNL1DotBDjho4tzK83EzNhzEXtO/QEy7h1yr4k1Ucio5PM/GqRRxKHk+8iJyo4IoWeBHK8CKYYVneRXJsz+P+N2WN9UBeHPCpJo7tPO5oAW+8iGM7J9Y3VJMVWUNajyA5FPHN/p7s3w5/A5kfecIDqLFDAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"cucumber vscode extension autocomplete\"\n        title=\"cucumber vscode extension autocomplete\"\n        src=\"/static/ce4f330bfa22f750dedad9390689dcba/5a190/cucumber-vscode-extension-autocomplete.png\"\n        srcset=\"/static/ce4f330bfa22f750dedad9390689dcba/772e8/cucumber-vscode-extension-autocomplete.png 200w,\n/static/ce4f330bfa22f750dedad9390689dcba/e17e5/cucumber-vscode-extension-autocomplete.png 400w,\n/static/ce4f330bfa22f750dedad9390689dcba/5a190/cucumber-vscode-extension-autocomplete.png 800w,\n/static/ce4f330bfa22f750dedad9390689dcba/764be/cucumber-vscode-extension-autocomplete.png 806w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p class=\"markdown-para\">It also warns you if there is no corresponding step definition from a feature file, for example:</p>\n<p class=\"markdown-para\"><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 26.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAABHklEQVR42kXNXU+CYBiH8Qd8ydJq8wVQRFEMHjEF0QyDfMuOOmqr1Vbf/2tcDWp58Nt1cG//W1xZS4xRiuEnmNMtVrDHCnZ0Jo9Ysy310R3l9iRXMvz/Kk0XtXWi6F5OnHcCdDelO9vQ8RN0uaY73aCPH2j7aT6cyZ5p8oHOJEWTa6q9kIo1p9SNKHcjimaAakjEpRlyPUxQejGKuUBkNB/RuEE0XETTQ9RHObXloTR/FTSJ2sqMUf5a0CWi7m2wgxdk8o0bf+LGH9ys3hktX/HiD2Tyhbx/w7w9cmYvqDorLpwVZ/0FFfskuxWtAFHrLzHcFCc60p/uGIZPDMIDvekOOzhgB3uc6Bk7PFCz51wPF1wOIgr6+F/xr6om+QF9ZIv/IjkhnAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"cucumber vscode extension no step definition warning\"\n        title=\"cucumber vscode extension no step definition warning\"\n        src=\"/static/74e53212be2471ca0fb6f58f0661fadb/5a190/cucumber-vscode-extension-no-step-definition-warning.png\"\n        srcset=\"/static/74e53212be2471ca0fb6f58f0661fadb/772e8/cucumber-vscode-extension-no-step-definition-warning.png 200w,\n/static/74e53212be2471ca0fb6f58f0661fadb/e17e5/cucumber-vscode-extension-no-step-definition-warning.png 400w,\n/static/74e53212be2471ca0fb6f58f0661fadb/5a190/cucumber-vscode-extension-no-step-definition-warning.png 800w,\n/static/74e53212be2471ca0fb6f58f0661fadb/d7ba6/cucumber-vscode-extension-no-step-definition-warning.png 1107w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p class=\"markdown-para\">If you're using a different editor, check Cucumber's <a href=\"https://cucumber.io/docs/tools/#editors\" class=\"markdown-link\">editor support page</a>.</p>\n<h2 class=\"markdown-subtitle\" id=\"continuous-integration\" style=\"position:relative;\"><a href=\"#continuous-integration\" aria-label=\"continuous integration permalink\" class=\"markdown-header-link before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Continuous Integration</h2>\n<p class=\"markdown-para\">To ensure your Cucumber feature tests run consistently across different environments and automatically catch regressions, it's a good practice to include them in your Continuous Integration (CI) pipeline. Since my project is hosted on GitHub, I use <a href=\"https://docs.github.com/en/actions\" class=\"markdown-link\">GitHub Actions</a> to run tests automatically on every push.</p>\n<p class=\"markdown-para\">To get started, add a workflow YAML file in your project's <code>.github/workflows</code> directory:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"yml\" data-index=\"45\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># .github/workflows/feature_tests.yml</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">name</span><span class=\"mtk1\">: </span><span class=\"mtk6\">Feature Tests</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">on</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">push</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">branches</span><span class=\"mtk1\">: [</span><span class=\"mtk6\">&quot;*&quot;</span><span class=\"mtk1\">]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">jobs</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">cucumber</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">runs-on</span><span class=\"mtk1\">: </span><span class=\"mtk6\">ubuntu-latest</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">steps</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      - </span><span class=\"mtk7\">name</span><span class=\"mtk1\">: </span><span class=\"mtk6\">Checkout code</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk7\">uses</span><span class=\"mtk1\">: </span><span class=\"mtk6\">actions/checkout@v4</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      - </span><span class=\"mtk7\">name</span><span class=\"mtk1\">: </span><span class=\"mtk6\">Set up Ruby</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk7\">uses</span><span class=\"mtk1\">: </span><span class=\"mtk6\">ruby/setup-ruby@v1</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk7\">with</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">          </span><span class=\"mtk7\">ruby-version</span><span class=\"mtk1\">: </span><span class=\"mtk6\">.ruby-version</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">          </span><span class=\"mtk7\">bundler-cache</span><span class=\"mtk1\">: </span><span class=\"mtk4\">true</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      - </span><span class=\"mtk7\">name</span><span class=\"mtk1\">: </span><span class=\"mtk6\">Install system dependencies</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk7\">run</span><span class=\"mtk1\">: </span><span class=\"mtk6\">sudo apt-get update &amp;&amp; sudo apt-get install --no-install-recommends -y build-essential git pkg-config google-chrome-stable</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      - </span><span class=\"mtk7\">name</span><span class=\"mtk1\">: </span><span class=\"mtk6\">Prepare test database</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk7\">run</span><span class=\"mtk1\">: </span><span class=\"mtk6\">bin/rails db:test:prepare</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      - </span><span class=\"mtk7\">name</span><span class=\"mtk1\">: </span><span class=\"mtk6\">Precompile assets</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk7\">run</span><span class=\"mtk1\">: </span><span class=\"mtk6\">bin/rails assets:precompile</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      - </span><span class=\"mtk7\">name</span><span class=\"mtk1\">: </span><span class=\"mtk6\">Run Cucumber features</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk7\">env</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">          </span><span class=\"mtk7\">RAILS_ENV</span><span class=\"mtk1\">: </span><span class=\"mtk6\">test</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk7\">run</span><span class=\"mtk1\">: </span><span class=\"mtk6\">bundle exec cucumber</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      - </span><span class=\"mtk7\">name</span><span class=\"mtk1\">: </span><span class=\"mtk6\">Upload screenshots from failed tests</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk7\">uses</span><span class=\"mtk1\">: </span><span class=\"mtk6\">actions/upload-artifact@v4</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk7\">if</span><span class=\"mtk1\">: </span><span class=\"mtk6\">failure()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk7\">with</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">          </span><span class=\"mtk7\">name</span><span class=\"mtk1\">: </span><span class=\"mtk6\">screenshots</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">          </span><span class=\"mtk7\">path</span><span class=\"mtk1\">: </span><span class=\"mtk6\">tmp/capybara/html-report</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">          </span><span class=\"mtk7\">if-no-files-found</span><span class=\"mtk1\">: </span><span class=\"mtk6\">ignore</span></span></span></code></pre>\n<p class=\"markdown-para\">Let's break down a few key parts:</p>\n<ul class=\"markdown-list-unordered\">\n<li class=\"markdown-list-item\"><strong class=\"markdown-strong\">Checkout &#x26; setup:</strong> Pulls down your code and installs the Ruby version from <code>.ruby-version</code>.</li>\n<li class=\"markdown-list-item\"><strong class=\"markdown-strong\">System dependencies:</strong> Installs packages like Chrome for running headless feature tests.</li>\n<li class=\"markdown-list-item\"><strong class=\"markdown-strong\">Test setup:</strong>\n<ul class=\"markdown-list-unordered\">\n<li class=\"markdown-list-item\"><code>bin/rails db:test:prepare</code> sets up the test database.</li>\n<li class=\"markdown-list-item\"><code>bin/rails assets:precompile</code> precompiling assets ensures the test browser sees a fully styled, functional site.</li>\n</ul>\n</li>\n<li class=\"markdown-list-item\"><strong class=\"markdown-strong\">Test execution:</strong> Runs your Cucumber features in test mode.</li>\n<li class=\"markdown-list-item\"><strong class=\"markdown-strong\">Artifacts on failure:</strong> If any test fails, screenshots and HTML reports from Capybara are saved and uploaded as artifacts. You can download them from the GitHub UI to debug what went wrong.</li>\n</ul>\n<p class=\"markdown-para\">Here's what a successful run looks like:</p>\n<p class=\"markdown-para\"><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 47.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABXklEQVR42o1S2W6DQAw0SdhAwgIL4Q5XCCSlaqv2//9tKjtHK1VR8zDysbO2Z73kRzluCOICOsqxDRLoMIE2qcS+5FJokwmYF+5K8dnKPZMJj+a3Lwznd/TjK5rDGXV/QlodEOYj/KSBF6Zyzmcbf4eqHYVrkkrO0rJDlO7F1yYHtf2EqptQNkckZScXm2GGKc8wWS+duUl7nMUv6kHAKniyIC7v08mEEsjoBVwvwkJtsVx7sB0PytFQm0DipfLEX601Vte8cq/YBLBdH44Xgab5A/tuRNNP2PoxyFKwVi5o6VywWD/2Jb7mFkqaEdECRBY7ILIvJEuJ5cLPgovajgaFZYV8PyDOW3gmE/hxAS/MhPRfkT8F89MR4/yJ+vCCMKlh0hq7okeUNU9NeZPL6q6SVyBaQuztXVgy4/Zej2ApWQo3Z4WujkG8nZ+N+b9w2dwjMMd2eLPm/uH5n34DP5nnK+kEs80AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"cucumber github workflow runner success\"\n        title=\"cucumber github workflow runner success\"\n        src=\"/static/9f9de2367615a92696087d248787e77b/5a190/cucumber-github-workflow-runner-success.png\"\n        srcset=\"/static/9f9de2367615a92696087d248787e77b/772e8/cucumber-github-workflow-runner-success.png 200w,\n/static/9f9de2367615a92696087d248787e77b/e17e5/cucumber-github-workflow-runner-success.png 400w,\n/static/9f9de2367615a92696087d248787e77b/5a190/cucumber-github-workflow-runner-success.png 800w,\n/static/9f9de2367615a92696087d248787e77b/e4900/cucumber-github-workflow-runner-success.png 988w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p class=\"markdown-para\">And here's a deliberately failing test, which triggers a failing CI run and stores screenshots in the artifacts section. This can be downloaded which will download a zip file containing screenshots of the browser at the point that test(s) failed:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"gherkin\" data-index=\"46\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">Feature</span><span class=\"mtk1\">:</span><span class=\"mtk6\"> Book reviews</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">Background</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">Given </span><span class=\"mtk1\">the following books exist:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">      | Title      | Author   | Published Year |</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">      | Book One   | Author A | 2001           |</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">      | Book Two   | Author B | 2002           |</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">And </span><span class=\"mtk1\">users exist:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">      | Email             | Password  |</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">      | user1@example.com | password1 |</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">      | user2@example.com | password2 |</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">And </span><span class=\"mtk1\">the following reviews exist:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">      | Book     | User Email        | Rating | Body       |</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">      | Book One | user2@example.com | 4      | Good read. |</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">And </span><span class=\"mtk1\">I am signed in as </span><span class=\"mtk6\">&quot;user1@example.com&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">Scenario</span><span class=\"mtk1\">:</span><span class=\"mtk6\"> User sees book details and reviews</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">When </span><span class=\"mtk1\">I visit the book show page for </span><span class=\"mtk6\">&quot;Book One&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">Then </span><span class=\"mtk1\">I should see the book title, author, and published year for </span><span class=\"mtk6\">&quot;Book One DOES NOT EXIST&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">And </span><span class=\"mtk1\">I should see the review for </span><span class=\"mtk6\">&quot;user2@example.com&quot;</span><span class=\"mtk1\"> with body </span><span class=\"mtk6\">&quot;Good read.&quot;</span><span class=\"mtk1\"> and 4 stars</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">And </span><span class=\"mtk1\">I should see a submit review button</span></span></span></code></pre>\n<p class=\"markdown-para\"><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 90.49999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsTAAALEwEAmpwYAAACMUlEQVR42pVUa3PaMBAUBGxsI2xLfkh+YAwBQkgJpW3azPT//63tnGQHJhlK8mFHJ+m8t3c6H+NCIZQFQqkNosTa0ygFJ8Q5ZkKB/MimlfZRUpo9+RN6PyayEsfTCx6ff2HzeES7fsL9wzeoZoe4ekIQKeh6icPpFdMoQ5yWOPx4RV4tzV5VS3NGNo8VGLHG6Vkh7RM1h8jnmCVz2Ay0OetVEMmsU0yrJcstoc8lSKVIS8i8wiSIMRh5GI593DmEwMDurU33vW3gTs3q+CGYNxWo2w3yokGiajjeDGzogN1Nvoahi5HLwQwrG4MNHDDmdOqsIrI/CyIdTzhYwCX27Rb742+02wOkWkDqFrrZ2lcbujeJyIcNxhi5UzA3iOD5ITwu4QYxxl4Ih+BHpja3UiVS+s7jAsTFXD+yNaMoxsGid6bUr4HuSVVED6obBGEK1jcn9ZJpgbhvAQtqiWvg3RqECfxZYmxG7PvTH+wPPyHz2kS5JLokvwVT80QqLIsGWbWCyKq3ix7/U/hBcZyDxUKhVDWKxQa6vkdWtkh1g7RYIFHN+R/+rEL6QKg5QqHe6vDe6Stg9CCnl7/Y7L8bZecf3RJSTS/T6mvMr6UcJoVJjRz7KJcvLPLanNE9BUv1wth9IN51xZlQajOKaILQK1+qI5tUZ8WiG10VdL1CQjXWDaK0Bhe6m492YpnxVTZrrHfPZn1PSIHqdouA1GaVsefLByxWO8hiBS5t/5IYGtT/AKk0roKmldmhAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"cucumber github workflow runner failure\"\n        title=\"cucumber github workflow runner failure\"\n        src=\"/static/fbae51585d36249a5fbb76b668fe9596/5a190/cucumber-github-workflow-runner-failure.png\"\n        srcset=\"/static/fbae51585d36249a5fbb76b668fe9596/772e8/cucumber-github-workflow-runner-failure.png 200w,\n/static/fbae51585d36249a5fbb76b668fe9596/e17e5/cucumber-github-workflow-runner-failure.png 400w,\n/static/fbae51585d36249a5fbb76b668fe9596/5a190/cucumber-github-workflow-runner-failure.png 800w,\n/static/fbae51585d36249a5fbb76b668fe9596/e4900/cucumber-github-workflow-runner-failure.png 988w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 class=\"markdown-subtitle\" id=\"conclusion\" style=\"position:relative;\"><a href=\"#conclusion\" aria-label=\"conclusion permalink\" class=\"markdown-header-link before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Conclusion</h2>\n<p class=\"markdown-para\">Cucumber isn't magic, but it does bring structure and sanity to testing complex user flows. It helps you describe what matters in plain language and keeps test code focused on behavior, not plumbing. When paired with Capybara and a CI runner, it becomes a powerful tool for catching regressions before your users do.</p>\n<p class=\"markdown-para\">For further reading, here are some of the resources mentioned in this post:</p>\n<ul class=\"markdown-list-unordered\">\n<li class=\"markdown-list-item\"><a href=\"https://cucumber.io/\" class=\"markdown-link\">Cucumber</a></li>\n<li class=\"markdown-list-item\"><a href=\"https://cucumber.io/docs/gherkin/reference\" class=\"markdown-link\">Gherkin Reference</a></li>\n<li class=\"markdown-list-item\"><a href=\"https://cucumber.io/docs/installation/\" class=\"markdown-link\">Installation Options</a></li>\n<li class=\"markdown-list-item\"><a href=\"https://cucumber.io/docs/cucumber/data-tables/\" class=\"markdown-link\">Data Tables</a></li>\n<li class=\"markdown-list-item\"><a href=\"https://github.com/cucumber/cucumber-expressions#parameter-types\" class=\"markdown-link\">Cucumber Expressions – Parameter Types</a></li>\n<li class=\"markdown-list-item\"><a href=\"https://github.com/cucumber/cucumber-expressions#custom-parameter-types\" class=\"markdown-link\">Cucumber Expressions – Custom Parameter Types</a></li>\n<li class=\"markdown-list-item\"><a href=\"https://cucumber.io/docs/guides/anti-patterns\" class=\"markdown-link\">Cucumber Anti-Patterns</a></li>\n<li class=\"markdown-list-item\"><a href=\"https://www.rubydoc.info/gems/cucumber/Cucumber/MultilineArgument/DataTable\" class=\"markdown-link\">Cucumber::DataTable API Docs</a></li>\n<li class=\"markdown-list-item\"><a href=\"https://www.rubydoc.info/gems/cucumber/Cucumber/MultilineArgument/DataTable#hashes-instance_method\" class=\"markdown-link\"><code>hashes</code> Method for Data Tables</a></li>\n<li class=\"markdown-list-item\"><a href=\"https://github.com/cucumber/cucumber-ruby/blob/2cf3a61802cc36cbca6bf3eed666b3a4a90f77a3/lib/cucumber/glue/dsl.rb#L58\" class=\"markdown-link\"><code>World</code> Method Source Code</a></li>\n</ul>\n<style class=\"grvsc-styles\">\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .monokai {\n    background-color: #272822;\n    color: #f8f8f2;\n  }\n  .monokai .mtku {\n    text-decoration: underline;\n    text-underline-position: under;\n  }\n  .monokai .mtki { font-style: italic; }\n  .monokai .mtk7 { color: #F92672; }\n  .monokai .mtk1 { color: #F8F8F2; }\n  .monokai .mtk6 { color: #E6DB74; }\n  .monokai .mtk9 { color: #66D9EF; }\n  .monokai .mtk5 { color: #A6E22E; }\n  .monokai .mtk4 { color: #AE81FF; }\n  .monokai .mtk3 { color: #75715E; }\n  .monokai .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));\n  }\n</style>","timeToRead":24,"tableOfContents":"<ul>\n<li>\n<p><a href=\"#what-is-cucumber\">What Is Cucumber?</a></p>\n</li>\n<li>\n<p><a href=\"#why-not-just-rspec--capybara\">Why Not Just RSpec + Capybara?</a></p>\n</li>\n<li>\n<p><a href=\"#setting-up-cucumber\">Setting Up Cucumber</a></p>\n<ul>\n<li><a href=\"#installation\">Installation</a></li>\n<li><a href=\"#browser-driver\">Browser Driver</a></li>\n<li><a href=\"#databasecleaner\">DatabaseCleaner</a></li>\n<li><a href=\"#factorybot\">FactoryBot</a></li>\n<li><a href=\"#fast-login\">Fast Login</a></li>\n<li><a href=\"#reports-service\">Reports Service</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#writing-your-first-feature-test\">Writing Your First Feature Test</a></p>\n</li>\n<li>\n<p><a href=\"#more-complex-feature\">More Complex Feature</a></p>\n</li>\n<li>\n<p><a href=\"#steps-organization\">Steps Organization</a></p>\n</li>\n<li>\n<p><a href=\"#debugging\">Debugging</a></p>\n</li>\n<li>\n<p><a href=\"#screenshot-on-failure\">Screenshot on Failure</a></p>\n</li>\n<li>\n<p><a href=\"#developer-tooling\">Developer Tooling</a></p>\n</li>\n<li>\n<p><a href=\"#continuous-integration\">Continuous Integration</a></p>\n</li>\n<li>\n<p><a href=\"#conclusion\">Conclusion</a></p>\n</li>\n</ul>","frontmatter":{"title":"Sustainable Feature Testing in Rails with Cucumber","date":"13 Dec 2025","description":"A practical guide to feature testing in Rails with Cucumber, highlighting its readability, maintainability, and team-friendly syntax through a working demo project.","featuredImage":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#382828","images":{"fallback":{"src":"/static/711246998e7cd1e9950cf9138a7e4fa3/d730f/cucumber-feature-testing-kelly-neil-pdlC9_bgN9o-unsplash.jpg","srcSet":"/static/711246998e7cd1e9950cf9138a7e4fa3/b834a/cucumber-feature-testing-kelly-neil-pdlC9_bgN9o-unsplash.jpg 225w,\n/static/711246998e7cd1e9950cf9138a7e4fa3/21c52/cucumber-feature-testing-kelly-neil-pdlC9_bgN9o-unsplash.jpg 450w,\n/static/711246998e7cd1e9950cf9138a7e4fa3/d730f/cucumber-feature-testing-kelly-neil-pdlC9_bgN9o-unsplash.jpg 900w","sizes":"(min-width: 900px) 900px, 100vw"},"sources":[{"srcSet":"/static/711246998e7cd1e9950cf9138a7e4fa3/71a10/cucumber-feature-testing-kelly-neil-pdlC9_bgN9o-unsplash.webp 225w,\n/static/711246998e7cd1e9950cf9138a7e4fa3/901f1/cucumber-feature-testing-kelly-neil-pdlC9_bgN9o-unsplash.webp 450w,\n/static/711246998e7cd1e9950cf9138a7e4fa3/5acd1/cucumber-feature-testing-kelly-neil-pdlC9_bgN9o-unsplash.webp 900w","type":"image/webp","sizes":"(min-width: 900px) 900px, 100vw"}]},"width":900,"height":599}}}},"fields":{"slug":"/blog/sustainable-feature-testing-in-rails-with-cucumber/"}},"relatedP":{"edges":[{"node":{"id":"31e8cce4-5682-5c17-8f35-c677650c8622","frontmatter":{"title":"Capybara Webdriver Element not Clickable Resolved","featuredImage":{"childImageSharp":{"gatsbyImageData":{"layout":"fixed","backgroundColor":"#c8c8c8","images":{"fallback":{"src":"/static/eca525b5ea56e9b81eb24b1a855a3cad/26528/capybara-jackson-simmer-Vqg809B-SrE-unsplash.jpg","srcSet":"/static/eca525b5ea56e9b81eb24b1a855a3cad/26528/capybara-jackson-simmer-Vqg809B-SrE-unsplash.jpg 300w,\n/static/eca525b5ea56e9b81eb24b1a855a3cad/43429/capybara-jackson-simmer-Vqg809B-SrE-unsplash.jpg 600w","sizes":"300px"},"sources":[{"srcSet":"/static/eca525b5ea56e9b81eb24b1a855a3cad/5d6c3/capybara-jackson-simmer-Vqg809B-SrE-unsplash.webp 300w,\n/static/eca525b5ea56e9b81eb24b1a855a3cad/68dbc/capybara-jackson-simmer-Vqg809B-SrE-unsplash.webp 600w","type":"image/webp","sizes":"300px"}]},"width":300,"height":170}}}},"fields":{"slug":"/blog/capybara-selenium-webdriver-element-not-clickable/"}}},{"node":{"id":"c92d7f13-ff75-5632-be8c-e9b5ff992ddc","frontmatter":{"title":"Rails Feature Test Solved by Regex","featuredImage":{"childImageSharp":{"gatsbyImageData":{"layout":"fixed","backgroundColor":"#487898","images":{"fallback":{"src":"/static/4b2924a3726801417360b49f81f7747b/26528/rails-feature-test-regex-patrick-tomasso-QMDap1TAu0g-unsplash.jpg","srcSet":"/static/4b2924a3726801417360b49f81f7747b/26528/rails-feature-test-regex-patrick-tomasso-QMDap1TAu0g-unsplash.jpg 300w,\n/static/4b2924a3726801417360b49f81f7747b/43429/rails-feature-test-regex-patrick-tomasso-QMDap1TAu0g-unsplash.jpg 600w","sizes":"300px"},"sources":[{"srcSet":"/static/4b2924a3726801417360b49f81f7747b/5d6c3/rails-feature-test-regex-patrick-tomasso-QMDap1TAu0g-unsplash.webp 300w,\n/static/4b2924a3726801417360b49f81f7747b/68dbc/rails-feature-test-regex-patrick-tomasso-QMDap1TAu0g-unsplash.webp 600w","type":"image/webp","sizes":"300px"}]},"width":300,"height":170}}}},"fields":{"slug":"/blog/rails-feature-test-solved-regex/"}}},{"node":{"id":"334ba24b-01a2-58f3-9962-67e64296c56e","frontmatter":{"title":"Testing Faraday with RSpec","featuredImage":{"childImageSharp":{"gatsbyImageData":{"layout":"fixed","backgroundColor":"#e8e8e8","images":{"fallback":{"src":"/static/69f6b56407e655dd690ba4b363161733/26528/faraday-alex-kondratiev-H9t723yPjYI-unsplash.jpg","srcSet":"/static/69f6b56407e655dd690ba4b363161733/26528/faraday-alex-kondratiev-H9t723yPjYI-unsplash.jpg 300w,\n/static/69f6b56407e655dd690ba4b363161733/43429/faraday-alex-kondratiev-H9t723yPjYI-unsplash.jpg 600w","sizes":"300px"},"sources":[{"srcSet":"/static/69f6b56407e655dd690ba4b363161733/5d6c3/faraday-alex-kondratiev-H9t723yPjYI-unsplash.webp 300w,\n/static/69f6b56407e655dd690ba4b363161733/68dbc/faraday-alex-kondratiev-H9t723yPjYI-unsplash.webp 600w","type":"image/webp","sizes":"300px"}]},"width":300,"height":170}}}},"fields":{"slug":"/blog/testing-faraday-with-rspec/"}}}]}},"pageContext":{"slug":"/blog/sustainable-feature-testing-in-rails-with-cucumber/","relatedPosts":["Rails Feature Test Solved by Regex","Testing Faraday with RSpec","Capybara Webdriver Element not Clickable Resolved"]}},"staticQueryHashes":["163244226"],"slicesMap":{}}