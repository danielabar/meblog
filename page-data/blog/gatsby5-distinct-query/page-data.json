{"componentChunkName":"component---src-templates-post-js","path":"/blog/gatsby5-distinct-query/","result":{"data":{"markdownRemark":{"html":"<p class=\"markdown-para\">If you're building a website or web application with Gatsby, you might come across a situation where you need to perform a distinct query. This is a query that only returns unique results, eliminating any duplicates. This post will show how to do a distinct query in Gatsby 5 (which is the latest version at the time of this writing) using GraphQL.</p>\n<aside class=\"markdown-aside\">\nThis post assumes that the reader has some basic knowledge of building websites with Gatsby, including familiarity with GraphQL queries. If you're new to Gatsby, or need a refresher on GraphQL, there are plenty of resources available to help you get up to speed. The official <a class=\"markdown-link\" href=\"https://www.gatsbyjs.com/docs/\">documentation</a> is a great place to start. Pluralsight also has some <a class=\"markdown-link\" href=\"https://www.pluralsight.com/paths/building-static-sites-with-gatsbyjs\">courses</a>, although at the time of this writing, they're mostly for an older Gatsby versions.\n</aside>\n<h2 class=\"markdown-subtitle\" id=\"example\" style=\"position:relative;\"><a href=\"#example\" aria-label=\"example permalink\" class=\"markdown-header-link before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Example</h2>\n<p class=\"markdown-para\">A common use case for Gatsby is to generate a static site where the content for the pages comes from markdown files. The <a href=\"https://www.npmjs.com/package/gatsby-transformer-remark\" class=\"markdown-link\">gatsby-transformer-remark</a> plugin transforms markdown files into HTML and creates nodes for them in Gatsby's GraphQL data layer. For instance, suppose we're building a website to share health and fitness site information. The <code>src</code> directory contains markdown files for each workout routine as follows:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"\" data-index=\"0\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">src</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">├── components</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">│   ├── footer.js</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">│   ├── header.js</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">│   ├── layout.js</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">├── markdown</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">│   ├── advanced-lifting-techniques.md</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">│   ├── cardio-basics.md</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">│   ├── strength-training-tips-for-beginners.md</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">│   ├── yoga-for-flexibility.md</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">│   ├── ...</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">├── pages</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">│   ├── about.js</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">│   ├── index.js</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">└── templates</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    ├── post.js</span></span></code></pre>\n<p class=\"markdown-para\">Here are some example markdown files with title, description, publish date, and category in the frontmatter, and a sample body content:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"markdown\" data-index=\"1\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">---</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">title</span><span class=\"mtk1\">: </span><span class=\"mtk6\">&quot;Advanced Lifting Techniques&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">description</span><span class=\"mtk1\">: </span><span class=\"mtk6\">&quot;Learn some advanced techniques to take your lifting to the next level.&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">date</span><span class=\"mtk1\">: </span><span class=\"mtk6\">&quot;2023-01-15&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">category</span><span class=\"mtk1\">: </span><span class=\"mtk6\">&quot;strength&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">---</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">If you&#39;ve been lifting weights for a while and want to take your workout to the next level,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">you&#39;ll need to start incorporating some advanced techniques...</span></span></span></code></pre>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"markdown\" data-index=\"2\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">---</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">title</span><span class=\"mtk1\">: </span><span class=\"mtk6\">&quot;Cardio Basics&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">description</span><span class=\"mtk1\">: </span><span class=\"mtk6\">&quot;Get back to the basics with a beginner&#39;s guide to cardio workouts.&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">date</span><span class=\"mtk1\">: </span><span class=\"mtk6\">&quot;2023-03-22&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">category</span><span class=\"mtk1\">: </span><span class=\"mtk6\">&quot;cardio&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">---</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">If you&#39;re new to working out or just looking to get back into shape,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">cardio is a great place to start...</span></span></span></code></pre>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"markdown\" data-index=\"3\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">---</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">title</span><span class=\"mtk1\">: </span><span class=\"mtk6\">&quot;Strength Training Tips for Beginners&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">description</span><span class=\"mtk1\">: </span><span class=\"mtk6\">&quot;Get started with strength training and build a foundation for a healthier life.&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">date</span><span class=\"mtk1\">: </span><span class=\"mtk6\">&quot;2023-07-16&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">category</span><span class=\"mtk1\">: </span><span class=\"mtk6\">&quot;strength&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">---</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">Strength training is an effective way to build muscle, increase bone density,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">and improve overall health...</span></span></span></code></pre>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"markdown\" data-index=\"4\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">---</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">title</span><span class=\"mtk1\">: </span><span class=\"mtk6\">&quot;Yoga for Flexibility&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">description</span><span class=\"mtk1\">: </span><span class=\"mtk6\">&quot;Improve your flexibility and reduce stress with this beginner&#39;s guide to yoga.&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">date</span><span class=\"mtk1\">: </span><span class=\"mtk6\">&quot;2023-09-02&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">category</span><span class=\"mtk1\">: </span><span class=\"mtk6\">&quot;yoga&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">---</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">Yoga is a good way to improve flexibility, reduce stress,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">and promote overall wellness...</span></span></span></code></pre>\n<p class=\"markdown-para\">Now we would like to get a list of all the categories, to generate a list of category tags that readers could click on to view articles for that category.</p>\n<h2 class=\"markdown-subtitle\" id=\"solution\" style=\"position:relative;\"><a href=\"#solution\" aria-label=\"solution permalink\" class=\"markdown-header-link before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Solution</h2>\n<p class=\"markdown-para\">Here is the GraphQL query to get a list of distinct categories. The key here is to use the <code>distinct</code> <em class=\"markdown-emphasis\">aggregation resolver</em>, and within that, specify the field to extract unique values for. The nesting of <code>category</code> within <code>frontmatter</code> matches how the nodes are structured when using the <a href=\"https://www.npmjs.com/package/gatsby-transformer-remark\" class=\"markdown-link\">gatsby-transformer-remark</a> plugin. The <code>SELECT</code> after specifying the <code>category</code> field seems a little odd, more on this later:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"graphql\" data-index=\"5\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  allMarkdownRemark {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    distinct(</span><span class=\"mtk10 mtki\">field</span><span class=\"mtk1\">: { </span><span class=\"mtk6\">frontmatter</span><span class=\"mtk1\">: { </span><span class=\"mtk6\">category</span><span class=\"mtk1\">:</span><span class=\"mtk4\"> SELECT</span><span class=\"mtk1\">} })</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<aside class=\"markdown-aside\">\nAn aggregation resolver is a type of resolver function that aggregates data from multiple sources into a single field on a GraphQL node. In addition to the distinct aggregation, Gatsby also supports group, min, max, and sum. I couldn't find documentation about these built-in resolvers but here's a <a class=\"markdown-link\" href=\"https://github.com/gatsbyjs/gatsby/pull/30789\">PR</a> where some of them got introduced. It's also possible to create your own <a class=\"markdown-link\" href=\"https://www.gatsbyjs.com/docs/reference/graphql-data-layer/schema-customization/#createresolvers-api\">custom resolvers</a>.\n</aside>\n<p class=\"markdown-para\">Running the above query will produce output like this:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"json\" data-index=\"6\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk9 mtki\">&quot;data&quot;</span><span class=\"mtk1\">: {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk9 mtki\">&quot;allMarkdownRemark&quot;</span><span class=\"mtk1\">: {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk9 mtki\">&quot;distinct&quot;</span><span class=\"mtk1\">: [</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">&quot;strength&quot;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">&quot;cardio&quot;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">&quot;yoga&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      ]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  },</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk9 mtki\">&quot;extensions&quot;</span><span class=\"mtk1\">: {}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<p class=\"markdown-para\">To have the categories sorted alphabetically in ascending order, pass in the <code>sort</code> option to the query field <code>allMarkdownRemark</code>. Use <code>DESC</code> instead of <code>ASC</code> for reverse alphabetic order:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"graphql\" data-index=\"7\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  allMarkdownRemark(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10 mtki\">sort</span><span class=\"mtk1\">: {</span><span class=\"mtk6\">frontmatter</span><span class=\"mtk1\">: {</span><span class=\"mtk6\">category</span><span class=\"mtk1\">:</span><span class=\"mtk4\"> ASC</span><span class=\"mtk1\">}}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  ) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    distinct(</span><span class=\"mtk10 mtki\">field</span><span class=\"mtk1\">: { </span><span class=\"mtk6\">frontmatter</span><span class=\"mtk1\">: { </span><span class=\"mtk6\">category</span><span class=\"mtk1\">:</span><span class=\"mtk4\"> SELECT</span><span class=\"mtk1\">} })</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<p class=\"markdown-para\">If the markdown files are located in different directories such as <code>/src/markdown/fitness</code> and <code>/src/markdown/recipes</code> and you only want the distinct categories for the <code>fitness</code> articles, pass the <code>filter</code> option to the query field. Within that, specify the field that should be filtered on, in this case, <code>fileAbsolutePath</code>, which is a field generated by the <code>gatsby-transformer-remark</code> plugin containing the absolute file path of the markdown files on the file system. Then use the <code>regex</code> filter operator to limit the results to only markdown files that are located in a certain directory:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"graphql\" data-index=\"8\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  allMarkdownRemark(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10 mtki\">filter</span><span class=\"mtk1\">: { </span><span class=\"mtk6\">fileAbsolutePath</span><span class=\"mtk1\">: { </span><span class=\"mtk6\">regex</span><span class=\"mtk1\">: </span><span class=\"mtk6\">&quot;/src/markdown/fitness/&quot;</span><span class=\"mtk1\"> } }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10 mtki\">sort</span><span class=\"mtk1\">: {</span><span class=\"mtk6\">frontmatter</span><span class=\"mtk1\">: {</span><span class=\"mtk6\">category</span><span class=\"mtk1\">:</span><span class=\"mtk4\"> ASC</span><span class=\"mtk1\">}}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  ) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    distinct(</span><span class=\"mtk10 mtki\">field</span><span class=\"mtk1\">: { </span><span class=\"mtk6\">frontmatter</span><span class=\"mtk1\">: { </span><span class=\"mtk6\">category</span><span class=\"mtk1\">:</span><span class=\"mtk4\"> SELECT</span><span class=\"mtk1\">} })</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<p class=\"markdown-para\">For more filter options and how they can be combined, see the <a href=\"https://www.gatsbyjs.com/docs/graphql-reference/#filter\" class=\"markdown-link\">Gatsby GraphQL</a> docs.</p>\n<p class=\"markdown-para\">Use the <a href=\"https://www.gatsbyjs.com/docs/graphql-reference/#group\" class=\"markdown-link\">group</a> function to get a list of categories and how frequently they appear:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"graphql\" data-index=\"9\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  allMarkdownRemark(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10 mtki\">filter</span><span class=\"mtk1\">: { </span><span class=\"mtk6\">fileAbsolutePath</span><span class=\"mtk1\">: { </span><span class=\"mtk6\">regex</span><span class=\"mtk1\">: </span><span class=\"mtk6\">&quot;/src/learning/&quot;</span><span class=\"mtk1\"> } }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  ) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    group(</span><span class=\"mtk10 mtki\">field</span><span class=\"mtk1\">: { </span><span class=\"mtk6\">frontmatter</span><span class=\"mtk1\">: { </span><span class=\"mtk6\">category</span><span class=\"mtk1\">:</span><span class=\"mtk4\"> SELECT</span><span class=\"mtk1\">} }) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      fieldValue</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      totalCount</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<p class=\"markdown-para\">This will output:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"json\" data-index=\"10\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk9 mtki\">&quot;data&quot;</span><span class=\"mtk1\">: {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk9 mtki\">&quot;allMarkdownRemark&quot;</span><span class=\"mtk1\">: {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk9 mtki\">&quot;group&quot;</span><span class=\"mtk1\">: [</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">          </span><span class=\"mtk9 mtki\">&quot;fieldValue&quot;</span><span class=\"mtk1\">: </span><span class=\"mtk12\">&quot;strength&quot;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">          </span><span class=\"mtk9 mtki\">&quot;totalCount&quot;</span><span class=\"mtk1\">: </span><span class=\"mtk4\">2</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        },</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">          </span><span class=\"mtk9 mtki\">&quot;fieldValue&quot;</span><span class=\"mtk1\">: </span><span class=\"mtk12\">&quot;cardio&quot;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">          </span><span class=\"mtk9 mtki\">&quot;totalCount&quot;</span><span class=\"mtk1\">: </span><span class=\"mtk4\">1</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        },</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">          </span><span class=\"mtk9 mtki\">&quot;fieldValue&quot;</span><span class=\"mtk1\">: </span><span class=\"mtk12\">&quot;yoga&quot;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">          </span><span class=\"mtk9 mtki\">&quot;totalCount&quot;</span><span class=\"mtk1\">: </span><span class=\"mtk4\">1</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      ]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  },</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk9 mtki\">&quot;extensions&quot;</span><span class=\"mtk1\">: {}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<p class=\"markdown-para\">If you just needed to find the solution quickly, you can copy paste the above and move on. But if you're curious as to how I found it when regular searching failed, read on.</p>\n<h2 class=\"markdown-subtitle\" id=\"finding-the-solution\" style=\"position:relative;\"><a href=\"#finding-the-solution\" aria-label=\"finding the solution permalink\" class=\"markdown-header-link before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Finding The Solution</h2>\n<p class=\"markdown-para\">Although the query seems straightforward enough, finding the correct syntax was surprisingly difficult. The reason is the aggregation syntax has changed from Gatsby v4 to Gatsby v5. In my search for the correct syntax, I tried both Duck Duck Go (my default search engine) and Google (my fallback option), but both returned either invalid syntax or links to official Gatsby docs with no mention of the \"distinct\" keyword. Here is the query that was turning up from web search:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"graphql\" data-index=\"11\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># OLD GATSBY V4 SYNTAX - DO NOT USE ON GATSBY V5</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  allMarkdownRemark {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    distinct(</span><span class=\"mtk10 mtki\">field</span><span class=\"mtk1\">:</span><span class=\"mtk4\"> frontmatter___category</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<p class=\"markdown-para\">Running the above will result in an error:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"json\" data-index=\"12\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk9 mtki\">&quot;errors&quot;</span><span class=\"mtk1\">: [</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk9 mtki\">&quot;message&quot;</span><span class=\"mtk1\">: </span><span class=\"mtk12\">&quot;Expected value of type </span><span class=\"mtk4\">\\&quot;</span><span class=\"mtk12\">MarkdownRemarkFieldSelector!</span><span class=\"mtk4\">\\&quot;</span><span class=\"mtk12\">, found frontmatter___category.&quot;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk9 mtki\">&quot;locations&quot;</span><span class=\"mtk1\">: [</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">          </span><span class=\"mtk9 mtki\">&quot;line&quot;</span><span class=\"mtk1\">: </span><span class=\"mtk4\">3</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">          </span><span class=\"mtk9 mtki\">&quot;column&quot;</span><span class=\"mtk1\">: </span><span class=\"mtk4\">21</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      ]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  ]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<h3 class=\"markdown-sub-subtitle\" id=\"ai-to-the-rescue\" style=\"position:relative;\"><a href=\"#ai-to-the-rescue\" aria-label=\"ai to the rescue permalink\" class=\"markdown-header-link before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>AI To The Rescue?</h3>\n<p class=\"markdown-para\">I also asked ChatGPT but it returned the same invalid syntax. When told about the error, ChatGPT suggested this variation which also does not work:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"graphql\" data-index=\"13\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># ALSO INCORRECT - DO NOT USE!</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  allMarkdownRemark {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    distinct(</span><span class=\"mtk10 mtki\">field</span><span class=\"mtk1\">:</span><span class=\"mtk4\"> frontmatter</span><span class=\"mtk1\"> {</span><span class=\"mtk4\"> category</span><span class=\"mtk1\"> })</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<p class=\"markdown-para\">Running the above results in a syntax error:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"json\" data-index=\"14\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk9 mtki\">&quot;errors&quot;</span><span class=\"mtk1\">: [</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk9 mtki\">&quot;message&quot;</span><span class=\"mtk1\">: </span><span class=\"mtk12\">&quot;Syntax Error: Expected Name, found </span><span class=\"mtk4\">\\&quot;</span><span class=\"mtk12\">{</span><span class=\"mtk4\">\\&quot;</span><span class=\"mtk12\">.&quot;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk9 mtki\">&quot;locations&quot;</span><span class=\"mtk1\">: [</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">          </span><span class=\"mtk9 mtki\">&quot;line&quot;</span><span class=\"mtk1\">: </span><span class=\"mtk4\">3</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">          </span><span class=\"mtk9 mtki\">&quot;column&quot;</span><span class=\"mtk1\">: </span><span class=\"mtk4\">33</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      ]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  ]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<p class=\"markdown-para\">When I told ChatGPT this solution was also not working, it responded with \"I apologize, the correct syntax is...\", and then proceeded to provide the first \"solution\" that I had already told it was incorrect <code>distinct(field: frontmatter___category)</code>. When I pointed this out it apologized again and then gave me the second incorrect \"solution\" <code>distinct(field: frontmatter { category })</code>. It was literally stuck in a loop apologizing and alternating between incorrect solutions. So our engineering jobs are safe for now.</p>\n<h3 class=\"markdown-sub-subtitle\" id=\"dig-into-the-source\" style=\"position:relative;\"><a href=\"#dig-into-the-source\" aria-label=\"dig into the source permalink\" class=\"markdown-header-link before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Dig Into The Source</h3>\n<p class=\"markdown-para\">A useful technique when web search fails is to search in the source code. Since Gatsby is open source and hosted on Github, the source is easily accessible. I started on the <a href=\"https://github.com/gatsbyjs/gatsby\" class=\"markdown-link\">Gatsby repo on Github</a> and entered <code>distinct</code> in the search box, then selected to search \"In this repository\" as shown in the screenshot below:</p>\n<p class=\"markdown-para\"><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 44.49999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB+ElEQVR42kWRS2sUQRSFWwXzmJnM9LOqu6sf1c/pnp5MZgJCUAhmIgjiRnEh4sqVP8KNSBIDLsWf+0mXoouPgrp1z7n3lPXk4pLz3ZZaxwzLgqHNaQtFlYUkoUsaOqSRT5ooEhWT55qmW1M1K0PdDv9ZDlir9Rn9/jPtm5/Iq28Ez28QVzeI/S3y+hb54h55+QW5eYvYvifsr1kOW4rlhqI9pe63/2iHc6zZwsM7+0D/7hf61Q+C/R3y+vtf7hDX98T7r+iLj+inn3DKZxxO5hzNPI5PPA6nDl6YodsBmZRYTpDgej6hcHAXU44eP2By+MhwfPDQnLPJAV4gCKMY15dGIEorFl6MH2WEUYlrJ8SqxrJdSRhr0nIgiEu8UGMHqUGoirmfMFkIprZk7sXMbIlUBVnVI1RBmneI05L05Qq5a7Emcx9XVZT9lrTsUHlLnDdEWU1e9cikwg8z/DDHEQm2HxNlDVm1QukleTmQnHdUr3cEmwprNvexdU/W72hXW3SzpmjW6GZA14MJvlyeUndnJEVHlJbGZGQUHs2Lak0UNnh+hjVdBIgop+k2OIEyIY9Tj4GP04yNQaQRcYFQf8TG/GTa4quGhRexMFPXZgMj6Ee5uUjLpRGd2cIwfphUpREMYm3ejav7UYGjOk7cmLF/NB7rdqD4DR3w+6Ly+GC0AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"gatsby repo search distinct\"\n        title=\"gatsby repo search distinct\"\n        src=\"/static/411c0db68623e95571081c9c61df87fd/5a190/gatsby-repo-search-distinct.png\"\n        srcset=\"/static/411c0db68623e95571081c9c61df87fd/772e8/gatsby-repo-search-distinct.png 200w,\n/static/411c0db68623e95571081c9c61df87fd/e17e5/gatsby-repo-search-distinct.png 400w,\n/static/411c0db68623e95571081c9c61df87fd/5a190/gatsby-repo-search-distinct.png 800w,\n/static/411c0db68623e95571081c9c61df87fd/6937a/gatsby-repo-search-distinct.png 1094w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p class=\"markdown-para\">A number of results were returned. One of the results was for a test with the description being <code>returns list of distinct values in a field</code> as shown below:</p>\n<p class=\"markdown-para\"><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 26.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAABCklEQVR42k2QSW7CUBAFfQAGD3/29G1jMwSwLVgEQqIsIuUGyf1PUlGAoCyeqvWkVqs6CHVNUg4IPyLrI6LsEX4gW47kXY8od0g/IKsB5Xt0uSdUBdNIMwnVlf8ThCJFuBpla7qup9kccH7DoR95PV9YPp1QWYtIFyhb4WyJTGsimTGLDbPEMovtnYZgnjik9YTCEsYaXXQ0yy0f70fadY8pVli/wlVrbLW+Lk4jxTyxhDK9Rdz42wWxdJisZhoZJqHENXu2xxe+vz4ZT2+k7Ujbn+nGC83umbTZXo8KVz20/3JVzn1OWi6IdYF0Hp01qLQhNjWJ8ShXYfLFva8Q1hPpgkjdlB//u88/r/OFRqYweC4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"gatsby repo search distinct result\"\n        title=\"gatsby repo search distinct result\"\n        src=\"/static/d045b7e65b1ed04c90f676499770858c/5a190/gatsby-repo-search-distinct-result.png\"\n        srcset=\"/static/d045b7e65b1ed04c90f676499770858c/772e8/gatsby-repo-search-distinct-result.png 200w,\n/static/d045b7e65b1ed04c90f676499770858c/e17e5/gatsby-repo-search-distinct-result.png 400w,\n/static/d045b7e65b1ed04c90f676499770858c/5a190/gatsby-repo-search-distinct-result.png 800w,\n/static/d045b7e65b1ed04c90f676499770858c/5b4a1/gatsby-repo-search-distinct-result.png 831w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p class=\"markdown-para\">This seemed promising as that was exactly the problem I was trying to solve. Looking more closely at this <a href=\"https://github.com/gatsbyjs/gatsby/blob/master/packages/gatsby/src/schema/__tests__/connection-input-fields.js#L177-L215\" class=\"markdown-link\">test</a>, it defines a query that extracts distinct values from a number of fields. One of them is a frontmatter field which is what I was looking for - notice the field <code>blue</code> in this test:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"js\" data-index=\"15\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// Copied from: packages/gatsby/src/schema/__tests__/connection-input-fields.js</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk5\">it</span><span class=\"mtk1\">(</span><span class=\"mtk6\">`returns list of distinct values in a field`</span><span class=\"mtk1\">, </span><span class=\"mtk7\">async</span><span class=\"mtk1\"> () </span><span class=\"mtk9 mtki\">=&gt;</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk9 mtki\">const</span><span class=\"mtk1\"> result </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">await</span><span class=\"mtk1\"> </span><span class=\"mtk5\">queryResult</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk5\">makeNodes</span><span class=\"mtk1\">(),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk6\">`</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">      {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">        allTest {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">          totalCount</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">          names: distinct(field: { name: SELECT })</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">          array: distinct(field: { anArray: SELECT })</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">          blue: distinct(field: { frontmatter: { blue: SELECT }})</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">          dates: distinct(field: { dateArray: SELECT })</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">          # Only one node has this field</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">          circle: distinct(field: { frontmatter: { circle: SELECT }})</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">          nestedField: distinct(field: { anotherKey:{ withANested:{ nestedKey: SELECT }}})</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">      }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">    `</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  )</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk5\">expect</span><span class=\"mtk1\">(result.errors).not.</span><span class=\"mtk5\">toBeDefined</span><span class=\"mtk1\">()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk5\">expect</span><span class=\"mtk1\">(result.data.allTest.names.length).</span><span class=\"mtk5\">toEqual</span><span class=\"mtk1\">(</span><span class=\"mtk4\">2</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk5\">expect</span><span class=\"mtk1\">(result.data.allTest.names[</span><span class=\"mtk4\">0</span><span class=\"mtk1\">]).</span><span class=\"mtk5\">toEqual</span><span class=\"mtk1\">(</span><span class=\"mtk6\">`The Mad Max`</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk5\">expect</span><span class=\"mtk1\">(result.data.allTest.array.length).</span><span class=\"mtk5\">toEqual</span><span class=\"mtk1\">(</span><span class=\"mtk4\">5</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk5\">expect</span><span class=\"mtk1\">(result.data.allTest.array[</span><span class=\"mtk4\">0</span><span class=\"mtk1\">]).</span><span class=\"mtk5\">toEqual</span><span class=\"mtk1\">(</span><span class=\"mtk6\">`1`</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk5\">expect</span><span class=\"mtk1\">(result.data.allTest.blue.length).</span><span class=\"mtk5\">toEqual</span><span class=\"mtk1\">(</span><span class=\"mtk4\">2</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk5\">expect</span><span class=\"mtk1\">(result.data.allTest.blue[</span><span class=\"mtk4\">0</span><span class=\"mtk1\">]).</span><span class=\"mtk5\">toEqual</span><span class=\"mtk1\">(</span><span class=\"mtk6\">`100`</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk5\">expect</span><span class=\"mtk1\">(result.data.allTest.circle.length).</span><span class=\"mtk5\">toEqual</span><span class=\"mtk1\">(</span><span class=\"mtk4\">1</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk5\">expect</span><span class=\"mtk1\">(result.data.allTest.circle[</span><span class=\"mtk4\">0</span><span class=\"mtk1\">]).</span><span class=\"mtk5\">toEqual</span><span class=\"mtk1\">(</span><span class=\"mtk6\">`happy`</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk5\">expect</span><span class=\"mtk1\">(result.data.allTest.dates[</span><span class=\"mtk4\">2</span><span class=\"mtk1\">]).</span><span class=\"mtk5\">toEqual</span><span class=\"mtk1\">(</span><span class=\"mtk6\">`2006-07-04T22:39:53.000Z`</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk5\">expect</span><span class=\"mtk1\">(result.data.allTest.dates.length).</span><span class=\"mtk5\">toEqual</span><span class=\"mtk1\">(</span><span class=\"mtk4\">4</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk5\">expect</span><span class=\"mtk1\">(result.data.allTest.nestedField.length).</span><span class=\"mtk5\">toEqual</span><span class=\"mtk1\">(</span><span class=\"mtk4\">2</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk5\">expect</span><span class=\"mtk1\">(result.data.allTest.nestedField[</span><span class=\"mtk4\">0</span><span class=\"mtk1\">]).</span><span class=\"mtk5\">toEqual</span><span class=\"mtk1\">(</span><span class=\"mtk6\">`bar`</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk5\">expect</span><span class=\"mtk1\">(result.data.allTest.nestedField[</span><span class=\"mtk4\">1</span><span class=\"mtk1\">]).</span><span class=\"mtk5\">toEqual</span><span class=\"mtk1\">(</span><span class=\"mtk6\">`foo`</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">})</span></span></span></code></pre>\n<p class=\"markdown-para\">So to make the <code>distinct</code> query work requires specifying an object for the field rather than triple underscores, and the addition of <code>: SELECT</code> after specifying which field you want to extract distinct values for. Updating my query to the syntax shown in the test resolved the issue.</p>\n<h3 class=\"markdown-sub-subtitle\" id=\"but-why\" style=\"position:relative;\"><a href=\"#but-why\" aria-label=\"but why permalink\" class=\"markdown-header-link before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>But Why?</h3>\n<p class=\"markdown-para\">I could have left it at that but got curious as to what this special word <code>SELECT</code> was doing and whether there were any other special values that could be specified in the query. In GraphiQL, the in-browser GraphQL IDE that's running on <code>http://localhost:8000/___graphql</code> when you run Gatsby in development mode, you can <kbd class=\"markdown-kbd\">Cmd</kbd> + click on any text in the query to open the documentation. Doing this on the <code>SELECT</code> keyword revealed that its a <code>FieldSelectorEnum</code>:</p>\n<p class=\"markdown-para\"><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 24%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA9ElEQVR42k1P206EMBTkM0y8cF1sgRahIpbl0oW4ItH4ZmLio///C2NOWXd5mMyctjNz6rBiAi8n7KRBnBuEWQePNwjS1uog2SNImpXT9sInHaYtbhONSS0w6g0OK0ZU/SfK9gNF8w6aXaZtGCFWM+JqQaRe4YsBrhzgUSlBDIjEAVdc47f7xs/+C04kDdjjbBvv4tpu51MzBdKW+QHhwwg/N/CzHm5u4Ine4kYMEPc1IqZxTT7ZwwmyDn7a2ZAtqIDY4xoe0yuT6QSas+oFShmU9RG8GLGTA5zV1JyD/jUFbs/P95t38ukI+TyjaBbwcrS/+gOy45xVsYNQQgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"graphiql select doc\"\n        title=\"graphiql select doc\"\n        src=\"/static/64c69cce00901f3c86541f75942b4b4f/5a190/graphiql-select-doc.png\"\n        srcset=\"/static/64c69cce00901f3c86541f75942b4b4f/772e8/graphiql-select-doc.png 200w,\n/static/64c69cce00901f3c86541f75942b4b4f/e17e5/graphiql-select-doc.png 400w,\n/static/64c69cce00901f3c86541f75942b4b4f/5a190/graphiql-select-doc.png 800w,\n/static/64c69cce00901f3c86541f75942b4b4f/cd536/graphiql-select-doc.png 1114w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p class=\"markdown-para\">Unfortunately there was no additional description of what this is or what other values are possible. So I searched for <code>FieldSelectorEnum</code> in the Gatsby source (same technique as before, searching with Github UI) and found it defined <a href=\"https://github.com/gatsbyjs/gatsby/blob/master/packages/gatsby/src/schema/types/pagination.ts#L114-L125\" class=\"markdown-link\">here</a>:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"js\" data-index=\"16\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// Copied from: packages/gatsby/src/schema/types/pagination.ts</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">leafInputComposer: schemaComposer.</span><span class=\"mtk5\">getOrCreateETC</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk6\">`FieldSelectorEnum`</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10 mtki\">etc</span><span class=\"mtk1\"> </span><span class=\"mtk9 mtki\">=&gt;</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      etc.</span><span class=\"mtk5\">setFields</span><span class=\"mtk1\">({</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk3\">// GraphQL spec doesn&#39;t allow using &quot;true&quot; (or &quot;false&quot; or &quot;null&quot;) as enum values</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk3\">// so we &quot;SELECT&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        SELECT: { value: </span><span class=\"mtk6\">`SELECT`</span><span class=\"mtk1\"> },</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      })</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  ),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  postfix: </span><span class=\"mtk6\">`FieldSelector`</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}).</span><span class=\"mtk5\">getTypeNonNull</span><span class=\"mtk1\">()</span></span></span></code></pre>\n<p class=\"markdown-para\">From the comment, it looks like it would have made more sense to have nothing specified, for example <code>distinct(field: frontmatter { category })</code> but the GraphQL spec doesn't allow this and that's why <code>SELECT</code> had to be added as in <code>distinct(field: frontmatter { category: SELECT })</code>. To see if I could get any more explanation about this, I clicked on the \"Blame\" button (in the Github UI, it shows up at the top of every source file) as shown in the screenshot below:</p>\n<p class=\"markdown-para\"><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 35%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABIklEQVR42o2Ry26DMBBF2TcPQgBjgh+AHQghz3aRrvr/X3Uqk6SqKlXK4mjGln11504klcO4gZV0LEVLXLTEuWWRW2JRo+qeUjsSoYjTkvlKME8KFklBmghmK0GpPcbtSaUh2g5n+sM7qtnR9Ce0P6D9SNsdsdsjtjsjtSOVlkxa0sJMVWhPV1lsVZNrT+3HSThKC01pPKb2jMcrG7fDbgf6bk/bndi4PcuHoztyYrmWzNeSS5ZRpqEvp7so2DTTWH5yEUZLckWcVawCecW60H8wrIWe3rvtSOP3COXuI4dMTN1xuNwoVMvbMmMW5/esXmD24HmOwmfV9HzcvvC7M3lpEZt6WsBTONT/mP/ug2DYmDKO8fpJ1Qw/WT2FXnX6dPgNeEe0/LeFK68AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"github blame button\"\n        title=\"github blame button\"\n        src=\"/static/1817e6c02600c095caf1f3babd0f4478/5a190/github-blame-button.png\"\n        srcset=\"/static/1817e6c02600c095caf1f3babd0f4478/772e8/github-blame-button.png 200w,\n/static/1817e6c02600c095caf1f3babd0f4478/e17e5/github-blame-button.png 400w,\n/static/1817e6c02600c095caf1f3babd0f4478/5a190/github-blame-button.png 800w,\n/static/1817e6c02600c095caf1f3babd0f4478/c1b63/github-blame-button.png 1200w,\n/static/1817e6c02600c095caf1f3babd0f4478/29c1d/github-blame-button.png 1375w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p class=\"markdown-para\">This shows the commit messages for every line in the source file. For the section of code that defined <code>FieldSelectorEnum</code>, the commit message was: <code>feat: [v5 breaking change] change sort and aggregation fields API #36708</code>. In Github the <code>#</code> before a number makes it link to either an issue or a PR, so I clicked on #36708 and it led to this <a href=\"https://github.com/gatsbyjs/gatsby/pull/36708\" class=\"markdown-link\">PR</a>. The description for this PR indicates that it implements changes from a discussion titled <a href=\"https://github.com/gatsbyjs/gatsby/discussions/36242\" class=\"markdown-link\">RFC: Change to sort and aggregation fields API #36242</a>. This discussion explains the syntax change from the triple underscore format to the object format for sorting and aggregation and provides some examples of old vs new syntax. This change was done to improve performance. The examples provided are:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"graphql\" data-index=\"17\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># OLD SYNTAX FOR SORT</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  allMarkdownRemark(</span><span class=\"mtk10 mtki\">sort</span><span class=\"mtk1\">: { </span><span class=\"mtk6\">fields</span><span class=\"mtk1\">: [</span><span class=\"mtk4\">frontmatter___date</span><span class=\"mtk1\">], </span><span class=\"mtk6\">order</span><span class=\"mtk1\">:</span><span class=\"mtk4\"> DESC</span><span class=\"mtk1\"> }) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    nodes {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk7\">...</span><span class=\"mtk1\">fields</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># NEW SYNTAX FOR SORT</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  allMarkdownRemark(</span><span class=\"mtk10 mtki\">sort</span><span class=\"mtk1\">: { </span><span class=\"mtk6\">frontmatter</span><span class=\"mtk1\">: { </span><span class=\"mtk6\">date</span><span class=\"mtk1\">:</span><span class=\"mtk4\"> DESC</span><span class=\"mtk1\"> } }) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    nodes {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk7\">...</span><span class=\"mtk1\">fields</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># OLD SYNTAX FOR AGGREGATION</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  allMarkdownRemark {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    distinct(</span><span class=\"mtk10 mtki\">field</span><span class=\"mtk1\">:</span><span class=\"mtk4\"> frontmatter___category</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># NEW SYNTAX FOR AGGREGATION</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  allMarkdownRemark {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    distinct(</span><span class=\"mtk10 mtki\">field</span><span class=\"mtk1\">: { </span><span class=\"mtk6\">frontmatter</span><span class=\"mtk1\">: { </span><span class=\"mtk6\">category</span><span class=\"mtk1\">:</span><span class=\"mtk4\"> SELECT</span><span class=\"mtk1\"> } })</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<p class=\"markdown-para\">For sorting, it makes sense that you would have to specify ASC or DESC, for example, but for distinct, there's nothing that really fits but the GraphQL forces \"something\" to go there so that's why <code>SELECT</code> is used.</p>\n<h2 class=\"markdown-subtitle\" id=\"conclusion\" style=\"position:relative;\"><a href=\"#conclusion\" aria-label=\"conclusion permalink\" class=\"markdown-header-link before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Conclusion</h2>\n<p class=\"markdown-para\">This post has covered how to write a GraphQL query for Gatsby v5 to extract distinct values for a given field. It has also covered options for sorting and limiting results to a particular directory where markdown files are located. Finally, it also covered a useful technique for getting answers to questions about open source projects when a web search doesn't turn up the answer.</p>\n<style class=\"grvsc-styles\">\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .monokai {\n    background-color: #272822;\n    color: #f8f8f2;\n  }\n  .monokai .mtki { font-style: italic; }\n  .monokai .mtk1 { color: #F8F8F2; }\n  .monokai .mtk7 { color: #F92672; }\n  .monokai .mtk6 { color: #E6DB74; }\n  .monokai .mtk10 { color: #FD971F; }\n  .monokai .mtk4 { color: #AE81FF; }\n  .monokai .mtk9 { color: #66D9EF; }\n  .monokai .mtk12 { color: #CFCFC2; }\n  .monokai .mtk3 { color: #75715E; }\n  .monokai .mtk5 { color: #A6E22E; }\n  .monokai .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));\n  }\n</style>","timeToRead":8,"tableOfContents":"<ul>\n<li>\n<p><a href=\"#example\">Example</a></p>\n</li>\n<li>\n<p><a href=\"#solution\">Solution</a></p>\n</li>\n<li>\n<p><a href=\"#finding-the-solution\">Finding The Solution</a></p>\n<ul>\n<li><a href=\"#ai-to-the-rescue\">AI To The Rescue?</a></li>\n<li><a href=\"#dig-into-the-source\">Dig Into The Source</a></li>\n<li><a href=\"#but-why\">But Why?</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#conclusion\">Conclusion</a></p>\n</li>\n</ul>","frontmatter":{"title":"Distinct GraphQL Query with Gatsby 5","date":"01 May 2023","description":"Learn the syntax for writing a distinct query in GraphQL when using Gatsby 5.","featuredImage":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#f89808","images":{"fallback":{"src":"/static/063ac4ae3a27ae1c9680916eeb95d205/fd980/gatsby5-distinct-greyson-joralemon-9IBqihqhuHc-unsplash.jpg","srcSet":"/static/063ac4ae3a27ae1c9680916eeb95d205/00be4/gatsby5-distinct-greyson-joralemon-9IBqihqhuHc-unsplash.jpg 225w,\n/static/063ac4ae3a27ae1c9680916eeb95d205/66ebe/gatsby5-distinct-greyson-joralemon-9IBqihqhuHc-unsplash.jpg 450w,\n/static/063ac4ae3a27ae1c9680916eeb95d205/fd980/gatsby5-distinct-greyson-joralemon-9IBqihqhuHc-unsplash.jpg 900w","sizes":"(min-width: 900px) 900px, 100vw"},"sources":[{"srcSet":"/static/063ac4ae3a27ae1c9680916eeb95d205/c5403/gatsby5-distinct-greyson-joralemon-9IBqihqhuHc-unsplash.webp 225w,\n/static/063ac4ae3a27ae1c9680916eeb95d205/edfe1/gatsby5-distinct-greyson-joralemon-9IBqihqhuHc-unsplash.webp 450w,\n/static/063ac4ae3a27ae1c9680916eeb95d205/b19f4/gatsby5-distinct-greyson-joralemon-9IBqihqhuHc-unsplash.webp 900w","type":"image/webp","sizes":"(min-width: 900px) 900px, 100vw"}]},"width":900,"height":675}}}},"fields":{"slug":"/blog/gatsby5-distinct-query/"}},"relatedP":{"edges":[{"node":{"id":"41a1eab5-7685-581e-9d15-1fb7583289ba","frontmatter":{"title":"Add Related Posts Feature to a Gatsby Blog","featuredImage":{"childImageSharp":{"gatsbyImageData":{"layout":"fixed","backgroundColor":"#281818","images":{"fallback":{"src":"/static/87cffbd7b199765cf9aab5dd5ab8a646/ad250/related-posts.png","srcSet":"/static/87cffbd7b199765cf9aab5dd5ab8a646/ad250/related-posts.png 300w,\n/static/87cffbd7b199765cf9aab5dd5ab8a646/b64d1/related-posts.png 600w","sizes":"300px"},"sources":[{"srcSet":"/static/87cffbd7b199765cf9aab5dd5ab8a646/5d6c3/related-posts.webp 300w,\n/static/87cffbd7b199765cf9aab5dd5ab8a646/68dbc/related-posts.webp 600w","type":"image/webp","sizes":"300px"}]},"width":300,"height":170}}}},"fields":{"slug":"/blog/gatsby-related-posts/"}}},{"node":{"id":"7397cada-13e5-52f5-95d5-24ed085f5816","frontmatter":{"title":"Get started with Gatsby and Unit Testing","featuredImage":{"childImageSharp":{"gatsbyImageData":{"layout":"fixed","backgroundColor":"#282818","images":{"fallback":{"src":"/static/ebcc5781393156bd5a5a12b3d788be64/26528/gatsby-unit-test-nina-mercado-5Y8NrzPya-w-unsplash.jpg","srcSet":"/static/ebcc5781393156bd5a5a12b3d788be64/26528/gatsby-unit-test-nina-mercado-5Y8NrzPya-w-unsplash.jpg 300w,\n/static/ebcc5781393156bd5a5a12b3d788be64/43429/gatsby-unit-test-nina-mercado-5Y8NrzPya-w-unsplash.jpg 600w","sizes":"300px"},"sources":[{"srcSet":"/static/ebcc5781393156bd5a5a12b3d788be64/5d6c3/gatsby-unit-test-nina-mercado-5Y8NrzPya-w-unsplash.webp 300w,\n/static/ebcc5781393156bd5a5a12b3d788be64/68dbc/gatsby-unit-test-nina-mercado-5Y8NrzPya-w-unsplash.webp 600w","type":"image/webp","sizes":"300px"}]},"width":300,"height":170}}}},"fields":{"slug":"/blog/gatsby-unit-testing/"}}},{"node":{"id":"fc54fd6b-0e6c-5f58-a0a9-53da3bb3936c","frontmatter":{"title":"Add a Language to gatsby-remark-vscode","featuredImage":{"childImageSharp":{"gatsbyImageData":{"layout":"fixed","backgroundColor":"#081818","images":{"fallback":{"src":"/static/16e4f57eb729e96adaf8861fa7f93c6f/26528/add-language-pankaj-patel-fvMeP4ml4bU-unsplash.jpg","srcSet":"/static/16e4f57eb729e96adaf8861fa7f93c6f/26528/add-language-pankaj-patel-fvMeP4ml4bU-unsplash.jpg 300w,\n/static/16e4f57eb729e96adaf8861fa7f93c6f/43429/add-language-pankaj-patel-fvMeP4ml4bU-unsplash.jpg 600w","sizes":"300px"},"sources":[{"srcSet":"/static/16e4f57eb729e96adaf8861fa7f93c6f/5d6c3/add-language-pankaj-patel-fvMeP4ml4bU-unsplash.webp 300w,\n/static/16e4f57eb729e96adaf8861fa7f93c6f/68dbc/add-language-pankaj-patel-fvMeP4ml4bU-unsplash.webp 600w","type":"image/webp","sizes":"300px"}]},"width":300,"height":170}}}},"fields":{"slug":"/blog/add-language-gatsby-remark-vscode/"}}}]}},"pageContext":{"slug":"/blog/gatsby5-distinct-query/","relatedPosts":["Get started with Gatsby and Unit Testing","Add Related Posts Feature to a Gatsby Blog","Add a Language to gatsby-remark-vscode"]}},"staticQueryHashes":["163244226"],"slicesMap":{}}