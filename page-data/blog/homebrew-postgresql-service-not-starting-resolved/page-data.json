{"componentChunkName":"component---src-templates-post-js","path":"/blog/homebrew-postgresql-service-not-starting-resolved/","result":{"data":{"markdownRemark":{"html":"<p class=\"markdown-para\">This post will cover how to troubleshoot when the postgresql service installed via Homebrew on a Mac isn't starting. If you work on a Mac, it's likely you use <a href=\"https://brew.sh/\" class=\"markdown-link\">Homebrew</a> to install packages. In addition to installing, you can also manage services using Homebrew's <a href=\"https://docs.brew.sh/Manpage#services-subcommand\" class=\"markdown-link\">services</a> subcommand, a wrapper for <code>launchctl</code>. A common usage of the services subcommand is to start and stop databases.</p>\n<h2 class=\"markdown-subtitle\" id=\"whats-running\" style=\"position:relative;\"><a href=\"#whats-running\" aria-label=\"whats running permalink\" class=\"markdown-header-link before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>What's Running</h2>\n<p class=\"markdown-para\">This all started when I wanted to follow along with a Rails tutorial that required scaffolding a new project with <a href=\"https://www.postgresql.org/\" class=\"markdown-link\">Postgresql</a> as the database. For production projects, I prefer to setup all databases in <a href=\"https://www.docker.com/\" class=\"markdown-link\">Docker</a> containers, but for a simple tutorial, it's fine to use a local service, which I had installed some time ago via <code>brew install postgresql</code>.</p>\n<p class=\"markdown-para\">However, I couldn't remember whether the database server was running. To get information about services that are currently being managed by Homebrew, use the <code>list</code> option of the <code>services</code> subcommand:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"\" data-index=\"0\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">brew services list</span></span></code></pre>\n<p class=\"markdown-para\">My output showed I had mysql, postgresql, and redis as managed services, but that postgres wasn't started:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"\" data-index=\"1\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">mysql      started dbaron ~/Library/LaunchAgents/homebrew.mxcl.mysql.plist</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">postgresql none</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">redis      started dbaron ~/Library/LaunchAgents/homebrew.mxcl.redis.plist</span></span></code></pre>\n<p class=\"markdown-para\">So the fix should be simple enough, just start it with the <code>start</code> option of the <code>services</code> subcommand:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"\" data-index=\"2\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">brew services start postgresql</span></span></code></pre>\n<p class=\"markdown-para\">The output of this command showed it was successful:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"\" data-index=\"3\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">==&gt; Successfully started `postgresql` (label: homebrew.mxcl.postgresql)</span></span></code></pre>\n<h2 class=\"markdown-subtitle\" id=\"the-problem\" style=\"position:relative;\"><a href=\"#the-problem\" aria-label=\"the problem permalink\" class=\"markdown-header-link before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>The Problem</h2>\n<p class=\"markdown-para\">But before pressing the <a href=\"https://www.staples.com/Staples-Easy-Button/product_606396\" class=\"markdown-link\">easy</a> button for finding such a quick fix, I wanted to check that a connection worked. PostgreSQL comes with <a href=\"https://www.postgresql.org/docs/current/app-psql.html\" class=\"markdown-link\">psql</a>, a command line tool to interact with the database. You can connect to the default <code>postgres</code> database as follows:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"\" data-index=\"4\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">psql -d postgres</span></span></code></pre>\n<p class=\"markdown-para\">Unfortunately, the output of this command showed the database was not running:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"\" data-index=\"5\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">psql: error: connection to server on socket &quot;/tmp/.s.PGSQL.5432&quot; failed: No such file or directory</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Is the server running locally and accepting connections on that socket?</span></span></code></pre>\n<p class=\"markdown-para\">A further check with <code>lsof</code> (list open files belonging to active processes) confirmed there was no process listening on port 5432, which is the default port used by postgresql. The <code>-nP</code> options indicate not to include host and port names in the Node Name column and <code>+c 15</code> increases the command width display, which otherwise defaults to 9:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"bash\" data-index=\"6\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">lsof -nP +c 15 </span><span class=\"mtk7\">|</span><span class=\"mtk1\"> grep LISTEN</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># no output for 5432</span></span></span></code></pre>\n<p class=\"markdown-para\">So much for the easy button.</p>\n<h2 class=\"markdown-subtitle\" id=\"debugging\" style=\"position:relative;\"><a href=\"#debugging\" aria-label=\"debugging permalink\" class=\"markdown-header-link before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Debugging</h2>\n<p class=\"markdown-para\">The <code>info</code> command can be used to get more detailed information about a specific service. Running it for <code>postgresql</code>:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"\" data-index=\"7\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">brew services info postgresql</span></span></code></pre>\n<p class=\"markdown-para\">The output shows that the <code>postgresql</code> service is loaded, but not running:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"\" data-index=\"8\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">postgresql (homebrew.mxcl.postgresql)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Running: ✘</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Loaded: ✓</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Schedulable: ✘</span></span></code></pre>\n<p class=\"markdown-para\">The <code>brew services list</code> command can be used again, but this time, instead of showing <code>none</code> for <code>postgresql</code>, it shows an error status and path to a plist file (because of the earlier attempt to start it which failed):</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"\" data-index=\"9\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">$ brew services list</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Name       Status     User   File</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">mysql      started    dbaron ~/Library/LaunchAgents/homebrew.mxcl.mysql.plist</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">postgresql error  256 dbaron ~/Library/LaunchAgents/homebrew.mxcl.postgresql.plist</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">redis      started    dbaron ~/Library/LaunchAgents/homebrew.mxcl.redis.plist</span></span></code></pre>\n<p class=\"markdown-para\">The <code>.plist</code> files contain service configuration information. Let's take a look at the configuration for the postgresql service:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"\" data-index=\"10\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">cat ~/Library/LaunchAgents/homebrew.mxcl.postgresql.plist</span></span></code></pre>\n<p class=\"markdown-para\">The output shows that it's an xml file:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"xml\" data-index=\"11\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">&lt;?</span><span class=\"mtk7\">xml</span><span class=\"mtk5\"> version</span><span class=\"mtk1\">=</span><span class=\"mtk6\">&quot;1.0&quot;</span><span class=\"mtk5\"> encoding</span><span class=\"mtk1\">=</span><span class=\"mtk6\">&quot;UTF-8&quot;</span><span class=\"mtk1\">?&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">&lt;!</span><span class=\"mtk7\">DOCTYPE</span><span class=\"mtk1\"> </span><span class=\"mtk10\">plist</span><span class=\"mtk1\"> PUBLIC &quot;-//Apple//DTD PLIST 1.0//EN&quot; &quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">&lt;</span><span class=\"mtk7\">plist</span><span class=\"mtk1\"> </span><span class=\"mtk5\">version</span><span class=\"mtk1\">=</span><span class=\"mtk6\">&quot;1.0&quot;</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  &lt;</span><span class=\"mtk7\">dict</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    &lt;</span><span class=\"mtk7\">key</span><span class=\"mtk1\">&gt;KeepAlive&lt;/</span><span class=\"mtk7\">key</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    &lt;</span><span class=\"mtk7\">true</span><span class=\"mtk1\"> /&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    &lt;</span><span class=\"mtk7\">key</span><span class=\"mtk1\">&gt;Label&lt;/</span><span class=\"mtk7\">key</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    &lt;</span><span class=\"mtk7\">string</span><span class=\"mtk1\">&gt;homebrew.mxcl.postgresql&lt;/</span><span class=\"mtk7\">string</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    &lt;</span><span class=\"mtk7\">key</span><span class=\"mtk1\">&gt;ProgramArguments&lt;/</span><span class=\"mtk7\">key</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    &lt;</span><span class=\"mtk7\">array</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      &lt;</span><span class=\"mtk7\">string</span><span class=\"mtk1\">&gt;/usr/local/opt/postgresql/bin/postgres&lt;/</span><span class=\"mtk7\">string</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      &lt;</span><span class=\"mtk7\">string</span><span class=\"mtk1\">&gt;-D&lt;/</span><span class=\"mtk7\">string</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      &lt;</span><span class=\"mtk7\">string</span><span class=\"mtk1\">&gt;/usr/local/var/postgres&lt;/</span><span class=\"mtk7\">string</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    &lt;/</span><span class=\"mtk7\">array</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    &lt;</span><span class=\"mtk7\">key</span><span class=\"mtk1\">&gt;RunAtLoad&lt;/</span><span class=\"mtk7\">key</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    &lt;</span><span class=\"mtk7\">true</span><span class=\"mtk1\"> /&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    &lt;</span><span class=\"mtk7\">key</span><span class=\"mtk1\">&gt;StandardErrorPath&lt;/</span><span class=\"mtk7\">key</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    &lt;</span><span class=\"mtk7\">string</span><span class=\"mtk1\">&gt;/usr/local/var/log/postgres.log&lt;/</span><span class=\"mtk7\">string</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    &lt;</span><span class=\"mtk7\">key</span><span class=\"mtk1\">&gt;StandardOutPath&lt;/</span><span class=\"mtk7\">key</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    &lt;</span><span class=\"mtk7\">string</span><span class=\"mtk1\">&gt;/usr/local/var/log/postgres.log&lt;/</span><span class=\"mtk7\">string</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    &lt;</span><span class=\"mtk7\">key</span><span class=\"mtk1\">&gt;WorkingDirectory&lt;/</span><span class=\"mtk7\">key</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    &lt;</span><span class=\"mtk7\">string</span><span class=\"mtk1\">&gt;/usr/local&lt;/</span><span class=\"mtk7\">string</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  &lt;/</span><span class=\"mtk7\">dict</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">&lt;/</span><span class=\"mtk7\">plist</span><span class=\"mtk1\">&gt;</span></span></span></code></pre>\n<p class=\"markdown-para\">Notice that one of the values is a path to an error file (actually its the same file used for both standard out and standard error) - <code>/usr/local/var/log/postgres.log</code>. Let's take a look at this file to see if it has any clues as to why postgresql isn't starting:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"\" data-index=\"12\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">$ cat /usr/local/var/log/postgres.log</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">2022-06-16 15:15:04.193 EDT [69330] FATAL:  database files are incompatible with server</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">2022-06-16 15:15:04.193 EDT [69330] DETAIL:  The data directory was initialized by PostgreSQL version 13, which is not compatible with this version 14.3.</span></span></code></pre>\n<p class=\"markdown-para\">Aha, a version incompatibility error! To confirm the version of the currently installed service:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"\" data-index=\"13\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">$ psql --version</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">psql (PostgreSQL) 14.3</span></span></code></pre>\n<h2 class=\"markdown-subtitle\" id=\"solution\" style=\"position:relative;\"><a href=\"#solution\" aria-label=\"solution permalink\" class=\"markdown-header-link before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Solution</h2>\n<p class=\"markdown-para\">When the Postgres data directory was first created, I must have been on older Postgres version 13, and at some point updated the brew formula to 14. This version mismatch makes postgresql fail to start. Fortunately, there's a homebrew <a href=\"https://github.com/Homebrew/homebrew-core/blob/master/cmd/postgresql-upgrade-database.rb\" class=\"markdown-link\">command</a> that can be run to migrate the data from a previous major version:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"\" data-index=\"14\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">brew postgresql-upgrade-database</span></span></code></pre>\n<p class=\"markdown-para\">There will be a lot of output from this command, but here are some highlights of what it does:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"\" data-index=\"15\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">brew install postgresql@13</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">...</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Upgrading postgresql data from 13 to 14..</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">...</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Moving postgresql data from /usr/local/var/postgres to /usr/local/var/postgres.old...</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">...</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Migrating and upgrading data...</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">...</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">==&gt; Upgraded postgresql data from 13 to 14!</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">==&gt; Your postgresql 13 data remains at /usr/local/var/postgres.old</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">==&gt; Successfully started `postgresql` (label: homebrew.mxcl.postgresql)</span></span></code></pre>\n<p class=\"markdown-para\">It installs the previous major version of postgresql (in my case, I was on 14 so previous major was 13), migrates, backs up the current data directory to <code>.old</code>, then migrates the data to the new major version. The idea being if something goes wrong with data migration, you can still access your old data with the previous major.</p>\n<p class=\"markdown-para\">Finally this command also starts up the current/latest version of the service. Let's confirm its started:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"\" data-index=\"16\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">$ brew services list</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Name       Status     User   File</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">mysql      started    dbaron ~/Library/LaunchAgents/homebrew.mxcl.mysql.plist</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">postgresql started    dbaron ~/Library/LaunchAgents/homebrew.mxcl.postgresql.plist</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">redis      started    dbaron ~/Library/LaunchAgents/homebrew.mxcl.redis.plist</span></span></code></pre>\n<p class=\"markdown-para\">And re-run the <code>lsof</code> command from earlier to confirm there's a postgres process listening on 5432:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"bash\" data-index=\"17\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">lsof -nP +c 15 </span><span class=\"mtk7\">|</span><span class=\"mtk1\"> grep LISTEN</span></span></span></code></pre>\n<p class=\"markdown-para\">Output includes postgres, so far so good:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"\" data-index=\"18\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">COMMAND          PID   USER   FD      TYPE             DEVICE  SIZE/OFF    NODE NAME</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">postgres        1788 dbaron    7u     IPv6 0x696b8fad0ce2d7bd       0t0    TCP [::1]:5432 (LISTEN)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">...</span></span></code></pre>\n<p class=\"markdown-para\">Last check is to ensure we can connect:</p>\n<pre class=\"grvsc-container gatsby-highlight monokai\" data-language=\"\" data-index=\"19\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">$ psql -d postgres</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">psql (14.2)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Type &quot;help&quot; for help.</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">postgres=#</span></span></code></pre>\n<p class=\"markdown-para\">This time the <code>psql</code> connection command goes to the <code>postgres</code> prompt, which means connection could be established, success!</p>\n<h2 class=\"markdown-subtitle\" id=\"conclusion\" style=\"position:relative;\"><a href=\"#conclusion\" aria-label=\"conclusion permalink\" class=\"markdown-header-link before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Conclusion</h2>\n<p class=\"markdown-para\">This post has walked through how to fix an issue with the postgresql service not starting on a Mac when managed by homebrew. In general when debugging homebrew services, use the <code>brew services list</code> command to get information about managed services and their plist files which contain configuration for the service. Then inspect the contents of the plist file to see if it specifies any log files. Then check the log file(s) for reason why service won't start and fix that.</p>\n<style class=\"grvsc-styles\">\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .monokai {\n    background-color: #272822;\n    color: #f8f8f2;\n  }\n  .monokai .mtk1 { color: #F8F8F2; }\n  .monokai .mtk7 { color: #F92672; }\n  .monokai .mtk3 { color: #75715E; }\n  .monokai .mtk5 { color: #A6E22E; }\n  .monokai .mtk6 { color: #E6DB74; }\n  .monokai .mtk10 { color: #FD971F; }\n  .monokai .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));\n  }\n</style>","timeToRead":5,"tableOfContents":"<ul>\n<li><a href=\"#whats-running\">What's Running</a></li>\n<li><a href=\"#the-problem\">The Problem</a></li>\n<li><a href=\"#debugging\">Debugging</a></li>\n<li><a href=\"#solution\">Solution</a></li>\n<li><a href=\"#conclusion\">Conclusion</a></li>\n</ul>","frontmatter":{"title":"Homebrew Postgresql Service not Starting Resolved","date":"01 Oct 2022","description":"Learn why your postgresql homebrew service won't start and how to fix it.","featuredImage":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#987858","images":{"fallback":{"src":"/static/09c9f0e696bef656672d612a338e22c6/b19ce/postgresql-homebrew-nam-anh-QJbyG6O0ick-unsplash.jpg","srcSet":"/static/09c9f0e696bef656672d612a338e22c6/da315/postgresql-homebrew-nam-anh-QJbyG6O0ick-unsplash.jpg 225w,\n/static/09c9f0e696bef656672d612a338e22c6/66f0b/postgresql-homebrew-nam-anh-QJbyG6O0ick-unsplash.jpg 450w,\n/static/09c9f0e696bef656672d612a338e22c6/b19ce/postgresql-homebrew-nam-anh-QJbyG6O0ick-unsplash.jpg 900w","sizes":"(min-width: 900px) 900px, 100vw"},"sources":[{"srcSet":"/static/09c9f0e696bef656672d612a338e22c6/a90ad/postgresql-homebrew-nam-anh-QJbyG6O0ick-unsplash.webp 225w,\n/static/09c9f0e696bef656672d612a338e22c6/f657c/postgresql-homebrew-nam-anh-QJbyG6O0ick-unsplash.webp 450w,\n/static/09c9f0e696bef656672d612a338e22c6/67124/postgresql-homebrew-nam-anh-QJbyG6O0ick-unsplash.webp 900w","type":"image/webp","sizes":"(min-width: 900px) 900px, 100vw"}]},"width":900,"height":507}}}},"fields":{"slug":"/blog/homebrew-postgresql-service-not-starting-resolved/"}},"relatedP":{"edges":[{"node":{"id":"d28e59ce-a5a4-5fb8-806f-c6d46d07ca4f","frontmatter":{"title":"How I Setup my Terminal","featuredImage":{"childImageSharp":{"gatsbyImageData":{"layout":"fixed","backgroundColor":"#d8d8d8","images":{"fallback":{"src":"/static/c2e1140c0912270d2a20800e2b8aa88b/26528/terminal-cookie-the-pom-gySMaocSdqs-unsplash.jpg","srcSet":"/static/c2e1140c0912270d2a20800e2b8aa88b/26528/terminal-cookie-the-pom-gySMaocSdqs-unsplash.jpg 300w,\n/static/c2e1140c0912270d2a20800e2b8aa88b/43429/terminal-cookie-the-pom-gySMaocSdqs-unsplash.jpg 600w","sizes":"300px"},"sources":[{"srcSet":"/static/c2e1140c0912270d2a20800e2b8aa88b/5d6c3/terminal-cookie-the-pom-gySMaocSdqs-unsplash.webp 300w,\n/static/c2e1140c0912270d2a20800e2b8aa88b/68dbc/terminal-cookie-the-pom-gySMaocSdqs-unsplash.webp 600w","type":"image/webp","sizes":"300px"}]},"width":300,"height":170}}}},"fields":{"slug":"/blog/how-i-setup-my-terminal/"}}},{"node":{"id":"3e795729-0818-5a18-97e1-fc7e0d67a176","frontmatter":{"title":"Automate Tabs & Commands in iTerm2","featuredImage":{"childImageSharp":{"gatsbyImageData":{"layout":"fixed","backgroundColor":"#d8c8b8","images":{"fallback":{"src":"/static/fb78290dc10d789b9a100d0d2c95c04f/26528/automation-2-jan-jakub-nanista-UHyrjKPsshk-unsplash.jpg","srcSet":"/static/fb78290dc10d789b9a100d0d2c95c04f/26528/automation-2-jan-jakub-nanista-UHyrjKPsshk-unsplash.jpg 300w,\n/static/fb78290dc10d789b9a100d0d2c95c04f/43429/automation-2-jan-jakub-nanista-UHyrjKPsshk-unsplash.jpg 600w","sizes":"300px"},"sources":[{"srcSet":"/static/fb78290dc10d789b9a100d0d2c95c04f/5d6c3/automation-2-jan-jakub-nanista-UHyrjKPsshk-unsplash.webp 300w,\n/static/fb78290dc10d789b9a100d0d2c95c04f/68dbc/automation-2-jan-jakub-nanista-UHyrjKPsshk-unsplash.webp 600w","type":"image/webp","sizes":"300px"}]},"width":300,"height":170}}}},"fields":{"slug":"/blog/iterm-automation/"}}},{"node":{"id":"bb0af7b8-9d5f-597f-90cb-a4da75c3c9a9","frontmatter":{"title":"Roll Your Own Search with Rails and Postgres: Search Engine","featuredImage":{"childImageSharp":{"gatsbyImageData":{"layout":"fixed","backgroundColor":"#d8c8a8","images":{"fallback":{"src":"/static/86310660995a38a9254ece85739c237f/26528/roll-search-3.jpg","srcSet":"/static/86310660995a38a9254ece85739c237f/26528/roll-search-3.jpg 300w,\n/static/86310660995a38a9254ece85739c237f/43429/roll-search-3.jpg 600w","sizes":"300px"},"sources":[{"srcSet":"/static/86310660995a38a9254ece85739c237f/5d6c3/roll-search-3.webp 300w,\n/static/86310660995a38a9254ece85739c237f/68dbc/roll-search-3.webp 600w","type":"image/webp","sizes":"300px"}]},"width":300,"height":170}}}},"fields":{"slug":"/blog/roll-your-own-search-service-for-gatsby-part3/"}}}]}},"pageContext":{"slug":"/blog/homebrew-postgresql-service-not-starting-resolved/","relatedPosts":["How I Setup my Terminal","Automate Tabs & Commands in iTerm2","Roll Your Own Search with Rails and Postgres: Search Engine"]}},"staticQueryHashes":["163244226"],"slicesMap":{}}